fa1e65e3f3f95b9ac9d01b958ca406f85cc8c0a6###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/http/OAuth2ErrorHandler.java###/OAuth2ErrorHandler.java###org.springframework.security.oauth2.client.http.OAuth2ErrorHandler###maybeThrowExceptionFromHeader:String String ###throwOAuth2Exception.valueOf(headerEntries);###ex###OAuth2Exception.valueOf(headerEntries)###77:4:77:49
bd290276e683899ccb8d77a3c477caa5c7c10b5b###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/TestDefaultAuthorizationRequest.java###/TestDefaultAuthorizationRequest.java###org.springframework.security.oauth2.provider.TestDefaultAuthorizationRequest###testScopeSortedOrder:###Assert.assertEquals(sortedScopeString,OAuth2Utils.formatParameterList(authorizationRequest.getScope()));###fromAR###OAuth2Utils.formatParameterList(authorizationRequest.getScope())###120:3:120:108
06c8e8dc3a068aef9d568de8c34b70c7d7fa44ef###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/FrameworkEndpointHandlerMapping.java###/FrameworkEndpointHandlerMapping.java###org.springframework.security.oauth2.provider.endpoint.FrameworkEndpointHandlerMapping###getMappingForMethod:Method Class<?> ###RequestMappingInfomapping=newRequestMappingInfo(patternsInfo,defaultMapping.getMethodsCondition(),defaultMapping.getParamsCondition(),defaultMapping.getHeadersCondition(),defaultMapping.getConsumesCondition(),defaultMapping.getProducesCondition(),defaultMapping.getCustomCondition());###paramsInfo###defaultMapping.getParamsCondition()###83:3:86:42
53c4095486d449b5d3aa22d4bf28afdf1c199d2a###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/approval/TestTokenServicesUserApprovalHandler.java###/TestTokenServicesUserApprovalHandler.java###org.springframework.security.oauth2.provider.approval.TestTokenServicesUserApprovalHandler###testBasicApproval:###OAuth2Requestrequest=newOAuth2Request(newHashMap<String,String>(),null,null,null,null,null,false,null,null,null);###parameters###newHashMap<String,String>()###51:3:51:131
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithTrickyQueryParams:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com?foo=b=&bar=f$",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com?foo=b=&bar=f$",null,null,Collections.singleton("code"))###198:3:201:39
5161576ac58ad8edd110282ebf0f4f2490e92440###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/token/TestTokenStoreBase.java###/TestTokenStoreBase.java###org.springframework.security.oauth2.provider.token.TestTokenStoreBase###testRetrieveAccessToken:###OAuth2AuthenticationexpectedAuthentication=newOAuth2Authentication(newDefaultAuthorizationRequest("id",null),newTestAuthentication("test2",false));###authorizationRequest###newDefaultAuthorizationRequest("id",null)###61:3:61:159
e171dad81640d775466a69ccab8ac8ed2a81fa6c###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/approval/TokenStoreUserApprovalHandler.java###/TokenStoreUserApprovalHandler.java###org.springframework.security.oauth2.provider.approval.TokenStoreUserApprovalHandler###checkForPreApproval:AuthorizationRequest Authentication ###builder.append("client_id="+authorizationRequest.getClientId());###clientId###authorizationRequest.getClientId()###95:4:95:70
0f43bb8c0de8be261479dc5d88926821f55468ca###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/common/exceptions/OAuth2ExceptionJackson2Serializer.java###/OAuth2ExceptionJackson2Serializer.java###org.springframework.security.oauth2.common.exceptions.OAuth2ExceptionJackson2Serializer###serialize:OAuth2Exception JsonGenerator SerializerProvider ###jgen.writeStringField("error_description",value.getMessage());###errorMessage###value.getMessage()###38:3:38:66
9e408e994b1547de2f3e187899e424fd70cb98c3###/spring-projects_spring-security-oauth/samples/oauth2/sparklr/src/test/java/org/springframework/security/oauth2/provider/TestResourceOwnerPasswordProvider.java###/TestResourceOwnerPasswordProvider.java###org.springframework.security.oauth2.provider.TestResourceOwnerPasswordProvider###testTokenNotGrantedIfSecretNotProvided:###assertTrue(values.get(0).contains("Basicrealm=\"sparklr2/client\""));###header###values.get(0)###135:4:135:74
3a7af198a4d6afdb487ce12b3792532ca612fcc6###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth/consumer/OAuthConsumerContextFilter.java###/OAuthConsumerContextFilter.java###org.springframework.security.oauth.consumer.OAuthConsumerContextFilter###doFilter:ServletRequest ServletResponse FilterChain ###token=getConsumerSupport().getAccessToken(token,request.getParameter(OAuthProviderParameter.oauth_verifier.toString()));###verifier###request.getParameter(OAuthProviderParameter.oauth_verifier.toString())###161:17:161:140
f4fc0b3796c1072a90af8c051b08fe6ca0812582###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth2/provider/OAuth2AuthorizationSuccessHandler.java###/OAuth2AuthorizationSuccessHandler.java###org.springframework.security.oauth2.provider.OAuth2AuthorizationSuccessHandler###onAuthenticationSuccess:HttpServletRequest HttpServletResponse Authentication ###OAuth2AccessTokenaccessToken=getTokenServices().createAccessToken((OAuth2Authentication)authentication);###oAuth2Auth###(OAuth2Authentication)authentication###37:7:37:115
b8a137bd9921323068c91f5c7336698170719875###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/DefaultTokenServices.java###/DefaultTokenServices.java###org.springframework.security.oauth2.provider.token.DefaultTokenServices###refreshAccessToken:String TokenRequest ###Authenticationuser=newPreAuthenticatedAuthenticationToken(authentication.getUserAuthentication(),"",authentication.getAuthorities());###userAuthentication###authentication.getUserAuthentication()###158:4:158:143
da4269eb9f4851c398444b554151a2eaf5c31782###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpointAuthenticationFilter.java###/TokenEndpointAuthenticationFilter.java###org.springframework.security.oauth2.provider.endpoint.TokenEndpointAuthenticationFilter###doFilter:ServletRequest ServletResponse FilterChain ###AuthorizationRequestauthorizationRequest=oAuth2RequestFactory.createAuthorizationRequest(getSingleValueMap(request));###map###getSingleValueMap(request)###142:5:142:125
05192c2d22634500d6707ad6e16ebe93c0700ac0###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithTrickyQueryParams:###assertEquals("http://anywhere.com?foo=b%20%3D&bar=f%20$&code=thecode",((RedirectView)result).getUrl());###url###((RedirectView)result).getUrl()###202:3:202:108
445474346d15a30b2acf4d593fcb6d9139c51751###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth2/consumer/OAuth2AccessTokenSupport.java###/OAuth2AccessTokenSupport.java###org.springframework.security.oauth2.consumer.OAuth2AccessTokenSupport###retrieveToken:MultiValueMap<String,String> OAuth2ProtectedResourceDetails ###returngetRestTemplate().execute(resource.getAccessTokenUri(),HttpMethod.POST,newOAuth2AuthTokenCallback(form,resource),newHttpMessageConverterExtractor<OAuth2AccessToken>(OAuth2AccessToken.class,(List)Arrays.asList(newOAuth2AccessTokenMessageConverter())));###accessTokenUri###resource.getAccessTokenUri()###80:7:81:193
bc4b1d26fab9c9182573b5aa2544b830f7d9589b###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/ResourceBeanDefinitionParser.java###/ResourceBeanDefinitionParser.java###org.springframework.security.oauth2.config.ResourceBeanDefinitionParser###getBeanClass:Element ###if("authorization_code".equals(element.getAttribute("type")))###type###element.getAttribute("type")###44:3:46:4
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithFragment:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com#bar",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com#bar",null,null,Collections.singleton("code"))###155:3:156:107
6f0abcf154fb4938678d2152e8c11b0b87b5baf0###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java###/AuthorizationServerSecurityConfigurer.java###org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer###init:HttpSecurity ###http.getSharedObject(AuthenticationManagerBuilder.class).userDetailsService(newClientDetailsUserDetailsService(clientDetailsService())).passwordEncoder(passwordEncoder());###clientDetailsUserDetailsService###newClientDetailsUserDetailsService(clientDetailsService())###132:4:134:42
a434e02b4b8363b28fc4edb5ec7cb1e27cd2d4b2###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth2/consumer/rememberme/DefaultOAuth2RememberMeServices.java###/DefaultOAuth2RememberMeServices.java###org.springframework.security.oauth2.consumer.rememberme.DefaultOAuth2RememberMeServices###loadRememberedTokens:HttpServletRequest HttpServletResponse ###returnnull;###rememberedTokens###null###16:5:16:17
9e408e994b1547de2f3e187899e424fd70cb98c3###/spring-projects_spring-security-oauth/samples/oauth2/sparklr/src/test/java/org/springframework/security/oauth2/provider/TestAuthorizationCodeProvider.java###/TestAuthorizationCodeProvider.java###org.springframework.security.oauth2.provider.TestAuthorizationCodeProvider###loginAndGrabCookie:###ResponseEntity<Void>result=serverRunning.postForStatus("/sparklr2/login.do",headers,formData);###location###"/sparklr2/login.do"###402:3:402:102
b0bb5d3d5960d985c937a632f9c1e55a536568d2###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/DefaultUserAuthenticationConverter.java###/DefaultUserAuthenticationConverter.java###org.springframework.security.oauth2.provider.token.DefaultUserAuthenticationConverter###extractAuthentication:Map<String,?> ###returnnewUsernamePasswordAuthenticationToken(map.get(USERNAME),"N/A",getAuthorities(map));###authorities###getAuthorities(map)###60:4:60:98
27dad92b9eb0deee7d55dd9b619ec3adc39531b8###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/filter/OAuth2ExceptionHandlerFilter.java###/OAuth2ExceptionHandlerFilter.java###org.springframework.security.oauth2.provider.filter.OAuth2ExceptionHandlerFilter###handleSecurityException:HttpServletRequest HttpServletResponse FilterChain RuntimeException ###response.setStatus(((OAuth2Exception)ase).getHttpErrorCode());###status###((OAuth2Exception)ase).getHttpErrorCode()###80:7:80:70
0f43bb8c0de8be261479dc5d88926821f55468ca###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/common/exceptions/OAuth2ExceptionJackson1Serializer.java###/OAuth2ExceptionJackson1Serializer.java###org.springframework.security.oauth2.common.exceptions.OAuth2ExceptionJackson1Serializer###serialize:OAuth2Exception JsonGenerator SerializerProvider ###jgen.writeStringField("error_description",value.getMessage());###errorMessage###value.getMessage()###34:3:34:66
24adf5e796ce5b99ea4e1ee1c638a22dffe0a891###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/RestTemplateBeanDefinitionParser.java###/RestTemplateBeanDefinitionParser.java###org.springframework.security.oauth2.config.RestTemplateBeanDefinitionParser###doParse:Element ParserContext BeanDefinitionBuilder ###BeanDefinitionHolderrequestHolder=ScopedProxyUtils.createScopedProxy(newBeanDefinitionHolder(request.getRawBeanDefinition(),parserContext.getReaderContext().generateBeanName(request.getRawBeanDefinition())),parserContext.getRegistry(),false);###requestDefinition###newBeanDefinitionHolder(request.getRawBeanDefinition(),parserContext.getReaderContext().generateBeanName(request.getRawBeanDefinition()))###48:3:50:95
d317d99d55d98122ac1895c92f775927ff430851###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/TestAuthorizationEndpoint.java###/TestAuthorizationEndpoint.java###org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint###testImplicit:###ModelAndViewresult=endpoint.authorize(model,"token",getAuthorizationRequest("foo","http://anywhere.com",null,null).getParameters(),sessionStatus,principal);###authorizationRequest###getAuthorizationRequest("foo","http://anywhere.com",null,null)###120:3:121:114
0bc26bcf4bd63ae0a58edabfd39ea9faeaf108e0###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/DefaultAuthorizationRequest.java###/DefaultAuthorizationRequest.java###org.springframework.security.oauth2.provider.DefaultAuthorizationRequest###DefaultAuthorizationRequest:Map<String,String> Map<String,String> String Collection<String> Collection<GrantedAuthority> Collection<String> boolean ###this.authorizationParameters.put(SCOPE,OAuth2Utils.formatParameterList(scope));###scopes###OAuth2Utils.formatParameterList(scope)###82:3:82:83
4bcfe798f4bbdfa4ee785b952fc60d023f9ce2d4###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/JdbcTokenStore.java###/JdbcTokenStore.java###org.springframework.security.oauth2.provider.token.store.JdbcTokenStore###getAccessToken:OAuth2Authentication ###if(accessToken!=null&&!key.equals(authenticationKeyGenerator.extractKey(readAuthentication(accessToken.getValue()))))###oldAuthentication###readAuthentication(accessToken.getValue())###132:3:138:4
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithMoreTrickyEncodedQueryParams:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere?t=a%3Db%26ep%3Dtest%2540test.me",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere?t=a%3Db%26ep%3Dtest%2540test.me",null,null,Collections.singleton("code"))###226:3:229:39
76b6b2889463f5e3b7abdaa27c47fcbd6aad2ce0###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/password/TestResourceOwnerPasswordTokenGranter.java###/TestResourceOwnerPasswordTokenGranter.java###org.springframework.security.oauth2.provider.password.TestResourceOwnerPasswordTokenGranter###TestResourceOwnerPasswordTokenGranter:###parameters.put("client_id","client");###clientId###"client"###74:3:74:41
055a99ee981b92805fea9ad097ae3e06b4dfe09f###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/config/annotation/AuthorizationServerConfigurationTests.java###/AuthorizationServerConfigurationTests.java###org.springframework.security.oauth2.config.annotation.AuthorizationServerConfigurationTests.AuthorizationServerVanilla###run:###assertTrue(clientDetailsService.loadClientByClientId("my-trusted-client").getAdditionalInformation().containsKey("foo"));###information###clientDetailsService.loadClientByClientId("my-trusted-client").getAdditionalInformation()###164:4:165:27
e8b45d7ec1604dcc479ccd6399f49a05a1521ee8###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configuration/OAuth2AuthorizationServerConfigurerAdapter.java###/OAuth2AuthorizationServerConfigurerAdapter.java###org.springframework.security.oauth2.config.annotation.web.configuration.OAuth2AuthorizationServerConfigurerAdapter###configure:HttpSecurity ###configure(http.authorizeRequests().antMatchers("/oauth/token").fullyAuthenticated().and().requestMatchers().antMatchers("/oauth/token").and().apply(newOAuth2AuthorizationServerConfigurer()));###configurer###newOAuth2AuthorizationServerConfigurer()###50:3:60:5
fa967f0113b6001334d7fa1b9fad152c773dd40d###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/WhitelabelErrorEndpoint.java###/WhitelabelErrorEndpoint.java###org.springframework.security.oauth2.provider.endpoint.WhitelabelErrorEndpoint###handleError:HttpServletRequest ###model.put("error",request.getAttribute("error"));###error###request.getAttribute("error")###22:3:22:53
e171dad81640d775466a69ccab8ac8ed2a81fa6c###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/approval/ApprovalStoreUserApprovalHandler.java###/ApprovalStoreUserApprovalHandler.java###org.springframework.security.oauth2.provider.approval.ApprovalStoreUserApprovalHandler###checkForPreApproval:AuthorizationRequest Authentication ###builder.append("client_id="+authorizationRequest.getClientId());###clientId###authorizationRequest.getClientId()###93:4:93:70
81a173cdc7d827e5595cae3d380130f1ac7ae1f0###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/OAuth2RestTemplate.java###/OAuth2RestTemplate.java###org.springframework.security.oauth2.client.OAuth2RestTemplate###doExecute:URI HttpMethod RequestCallback ResponseExtractor<T> ###throwe;###rethrow###e###130:5:130:13
7c24bacd218eefcd7e8ad4651e846ae4075b6855###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/token/AbstractTestDefaultTokenServices.java###/AbstractTestDefaultTokenServices.java###org.springframework.security.oauth2.provider.token.AbstractTestDefaultTokenServices.testRefreshedTokenIsEnhanced.setTokenEnhancer.new TokenEnhancer###enhance:OAuth2AccessToken OAuth2Authentication ###returnnewDefaultOAuth2AccessToken(accessToken).setValue("I'mEnhanced");###result###newDefaultOAuth2AccessToken(accessToken)###91:5:92:32
3b41fe3630f73172d0e4f50da5fd131dcf687842###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/KeyStoreKeyFactory.java###/KeyStoreKeyFactory.java###org.springframework.security.oauth2.provider.token.store.KeyStoreKeyFactory###getKeyPair:String char[] ###store.load(resource.getInputStream(),this.password);###inputStream###resource.getInputStream()###57:7:57:60
00c1679be0b495bc1b0412a5da54e824335d4f33###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/DefaultTokenServices.java###/DefaultTokenServices.java###org.springframework.security.oauth2.provider.token.DefaultTokenServices###refreshAccessToken:String Set<String> ###OAuth2Authenticationauthentication=createRefreshedAuthentication(tokenStore.readAuthenticationForRefreshToken(refreshToken),scope);###authentication###tokenStore.readAuthenticationForRefreshToken(refreshToken)###127:3:128:72
82dd66b3d75124ad1cfe9671b6aa12816a1bdd32###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/provider/auth/DefaultClientAuthenticationHandler.java###/DefaultClientAuthenticationHandler.java###org.springframework.security.oauth2.client.provider.auth.DefaultClientAuthenticationHandler###authenticateTokenRequest:OAuth2ProtectedResourceDetails MultiValueMap<String,String> ClientHttpRequest ###request.getHeaders().add("Authorization",String.format("Basic%s",newString(Base64.encode(String.format("%s:%s",resource.getClientId(),resource.getClientSecret()).getBytes("UTF-8")),"UTF-8")));###clientSecret###resource.getClientSecret()###32:6:37:71
b478e803197d84a8054217365e1fa60e4606acba###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java###/AuthorizationServerSecurityConfigurer.java###org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer###init:HttpSecurity ###http.getSharedObject(AuthenticationManagerBuilder.class).userDetailsService(clientDetailsUserDetailsService).passwordEncoder(passwordEncoder());###builder###http.getSharedObject(AuthenticationManagerBuilder.class)###140:4:142:42
426b38ac804ca64a3d6a0ab7983758cf888332e6###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/TestAuthorizationEndpoint.java###/TestAuthorizationEndpoint.java###org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint###testImplicitPreApproved:###assertTrue("Wrongview:"+result,((RedirectView)result.getView()).getUrl().startsWith("http://anywhere.com"));###url###((RedirectView)result.getView()).getUrl()###130:3:131:41
8bd2ec40a15da7b293687ae83a032ac7d2edd83f###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/InMemoryTokenStore.java###/InMemoryTokenStore.java###org.springframework.security.oauth2.provider.token.InMemoryTokenStore###storeAccessToken:OAuth2AccessToken OAuth2Authentication ###this.expiryQueue.put(newTokenExpiry(token.getValue(),token.getExpiration()));###expiry###newTokenExpiry(token.getValue(),token.getExpiration())###148:4:148:83
b0bb5d3d5960d985c937a632f9c1e55a536568d2###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/DefaultUserAuthenticationConverter.java###/DefaultUserAuthenticationConverter.java###org.springframework.security.oauth2.provider.token.DefaultUserAuthenticationConverter###extractAuthentication:Map<String,?> ###returnnewUsernamePasswordAuthenticationToken(map.get(USERNAME),"N/A",getAuthorities(map));###principal###map.get(USERNAME)###60:4:60:98
a336fc2a2060f53971b0d23039749f922398116b###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpoint.java###/AuthorizationEndpoint.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint###handleException:Exception ServletWebRequest ###returnnewModelAndView(newRedirectView(redirect,false,true,false));###redirectView###newRedirectView(redirect,false,true,false)###609:4:609:76
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithTrickyState:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com","=?s",null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com","=?s",null,Collections.singleton("code"))###176:3:177:105
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithMultipleQueryParams:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com?foo=bar&bar=foo",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com?foo=bar&bar=foo",null,null,Collections.singleton("code"))###186:3:189:39
6de2d85f7233fd041bacd9500ae34fe7382ac934###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java###/TokenEndpoint.java###org.springframework.security.oauth2.provider.endpoint.TokenEndpoint###getAccessToken:Principal String Map<String,String> ###request.put("client_id",client.getName());###clientId###client.getName()###71:3:71:46
d8cb5c4dab0c7f296da1111dd150616510e5ae7e###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/DefaultTokenServices.java###/DefaultTokenServices.java###org.springframework.security.oauth2.provider.token.DefaultTokenServices###createRefreshToken:OAuth2Authentication ###ExpiringOAuth2RefreshTokenrefreshToken=newDefaultExpiringOAuth2RefreshToken(UUID.randomUUID().toString(),newDate(System.currentTimeMillis()+(validitySeconds*1000L)));###value###UUID.randomUUID().toString()###262:3:263:71
5161576ac58ad8edd110282ebf0f4f2490e92440###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/token/TestTokenStoreBase.java###/TestTokenStoreBase.java###org.springframework.security.oauth2.provider.token.TestTokenStoreBase###testGetAccessTokenForDeletedUser:###OAuth2AuthenticationexpectedAuthentication=newOAuth2Authentication(newDefaultAuthorizationRequest("id",null),newTestAuthentication("test",false));###authorizationRequest###newDefaultAuthorizationRequest("id",null)###134:3:134:158
43f15946f4d04a422575cc827519acd3ab857f08###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/filter/OAuth2ClientContextFilter.java###/OAuth2ClientContextFilter.java###org.springframework.security.oauth2.client.filter.OAuth2ClientContextFilter###doFilter:ServletRequest ServletResponse FilterChain ###accessTokenRequest.setPreservedState(statePersistenceServices.loadPreservedState(stateKey,request,response));###preservedState###statePersistenceServices.loadPreservedState(stateKey,request,response)###100:6:101:19
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithTrickyEncodedQueryParams:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com/path?foo=b%20%3D&bar=f%20$",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com/path?foo=b%20%3D&bar=f%20$",null,null,Collections.singleton("code"))###214:3:217:39
bd290276e683899ccb8d77a3c477caa5c7c10b5b###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/approval/DefaultUserApprovalHandler.java###/DefaultUserApprovalHandler.java###org.springframework.security.oauth2.provider.approval.DefaultUserApprovalHandler###isApproved:AuthorizationRequest Authentication ###Stringflag=authorizationRequest.getApprovalParameters().get(approvalParameter);###approvalParameters###authorizationRequest.getApprovalParameters()###53:3:53:85
01ab27ef2f863a4e09e58596260d61619e887c78###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/FrameworkEndpointHandlerMapping.java###/FrameworkEndpointHandlerMapping.java###org.springframework.security.oauth2.provider.endpoint.FrameworkEndpointHandlerMapping###getPath:String ###returndefaultPath;###result###defaultPath###63:3:63:22
3b41fe3630f73172d0e4f50da5fd131dcf687842###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth/config/ConsumerDetailsFactoryBean.java###/ConsumerDetailsFactoryBean.java###org.springframework.security.oauth.config.ConsumerDetailsFactoryBean###getObject:###Certificatecert=CertificateFactory.getInstance("X.509").generateCertificate(resourceLoader.getResource(secret).getInputStream());###inputStream###resourceLoader.getResource(secret).getInputStream()###85:5:85:137
5161576ac58ad8edd110282ebf0f4f2490e92440###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/JdbcTokenStore.java###/JdbcTokenStore.java###org.springframework.security.oauth2.provider.token.JdbcTokenStore###getAccessToken:OAuth2Authentication ###accessToken=jdbcTemplate.queryForObject(selectAccessTokenFromAuthenticationSql,newRowMapper<OAuth2AccessToken>(){publicOAuth2AccessTokenmapRow(ResultSetrs,introwNum)throwsSQLException{returndeserializeAccessToken(rs.getBytes(2));}},authenticationKeyGenerator.extractKey(authentication));###key###authenticationKeyGenerator.extractKey(authentication)###104:4:109:64
1ffd25fa25fad0133ade3123017faa998d4bab1a###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth2/config/OAuth2ClientBeanDefinitionParser.java###/OAuth2ClientBeanDefinitionParser.java###org.springframework.security.oauth2.config.OAuth2ClientBeanDefinitionParser###parse:Element ParserContext ###consumerFilterBean.addPropertyValue("objectDefinitionSource",newDefaultFilterInvocationSecurityMetadataSource(matcher,invocationDefinitionMap));###source###newDefaultFilterInvocationSecurityMetadataSource(matcher,invocationDefinitionMap)###166:7:166:154
1ffd25fa25fad0133ade3123017faa998d4bab1a###/spring-projects_spring-security-oauth/spring-security-oauth/src/main/java/org/springframework/security/oauth/config/OAuthConsumerBeanDefinitionParser.java###/OAuthConsumerBeanDefinitionParser.java###org.springframework.security.oauth.config.OAuthConsumerBeanDefinitionParser###parse:Element ParserContext ###consumerAccessFilterBean.addPropertyValue("objectDefinitionSource",newDefaultFilterInvocationSecurityMetadataSource(matcher,invocationDefinitionMap));###source###newDefaultFilterInvocationSecurityMetadataSource(matcher,invocationDefinitionMap)###166:7:166:160
617675708b5ddac0b76f78eaaeec677990099190###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/filter/OAuth2ClientContextFilter.java###/OAuth2ClientContextFilter.java###org.springframework.security.oauth2.client.filter.OAuth2ClientContextFilter###calculateCurrentUri:HttpServletRequest ###Stringquery=uri.getQuery().replace("%20","+");###query###uri.getQuery()###124:3:124:53
a336fc2a2060f53971b0d23039749f922398116b###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpoint.java###/AuthorizationEndpoint.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint###getImplicitGrantResponse:AuthorizationRequest ###returnnewModelAndView(newRedirectView(appendAccessToken(authorizationRequest,accessToken),false,true,false));###redirectView###newRedirectView(appendAccessToken(authorizationRequest,accessToken),false,true,false)###350:4:351:14
43f15946f4d04a422575cc827519acd3ab857f08###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/filter/OAuth2ClientContextFilter.java###/OAuth2ClientContextFilter.java###org.springframework.security.oauth2.client.filter.OAuth2ClientContextFilter###redirectUser:OAuth2ProtectedResourceDetails UserRedirectRequiredException HttpServletRequest HttpServletResponse ###statePersistenceServices.preserveState(e.getStateKey(),e.getStateToPreserve(),request,response);###stateToPreserve###e.getStateToPreserve()###188:4:188:103
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testAuthorizationCodeWithQueryParams:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com?foo=bar",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com?foo=bar",null,null,Collections.singleton("code"))###165:3:167:111
697c29a2055f1f73631b6c35754ad99176266606###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpoint.java###/AuthorizationEndpoint.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint###handleException:Exception ServletWebRequest ###DefaultAuthorizationRequestauthorizationRequest=newDefaultAuthorizationRequest(getAuthorizationRequestForError(webRequest));###errorRequest###getAuthorizationRequestForError(webRequest)###439:3:440:50
4082ec7ae3d39198a47b5c803ccb20dacefb0b09###/spring-projects_spring-security-oauth/spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpointTests.java###/AuthorizationEndpointTests.java###org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpointTests###testApprovalDenied:###model.put("authorizationRequest",getAuthorizationRequest("foo","http://anywhere.com",null,null,Collections.singleton("code")));###request###getAuthorizationRequest("foo","http://anywhere.com",null,null,Collections.singleton("code"))###518:3:519:103
958a42f3c6cc11224ad0a2033c9e687e4797e170###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/grant/code/AuthorizationCodeAccessTokenProvider.java###/AuthorizationCodeAccessTokenProvider.java###org.springframework.security.oauth2.client.token.grant.code.AuthorizationCodeAccessTokenProvider###getParametersForTokenRequest:AuthorizationCodeResourceDetails AccessTokenRequest ###redirectUri=String.valueOf(request.getPreservedState());###preservedState###request.getPreservedState()###85:4:85:62
9ec3c6bb9a8fcd20eeb2770ac20847c1e9ff53ef###/spring-projects_spring-security-oauth/samples/oauth2/sparklr/src/test/java/org/springframework/security/oauth2/provider/ServerRunning.java###/ServerRunning.java###org.springframework.security.oauth2.provider.ServerRunning.UriBuilder###build:###params.get(key)###value###params.get(key)###335:27:335:42
5161576ac58ad8edd110282ebf0f4f2490e92440###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/InMemoryTokenStore.java###/InMemoryTokenStore.java###org.springframework.security.oauth2.provider.token.InMemoryTokenStore###getAccessToken:OAuth2Authentication ###OAuth2AccessTokenaccessToken=authenticationToAccessTokenStore.get(authenticationKeyGenerator.extractKey(authentication));###key###authenticationKeyGenerator.extractKey(authentication)###115:3:116:34
17cc516302193ae39bc943fdf2af61fad017c233###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/grant/code/AuthorizationCodeAccessTokenProvider.java###/AuthorizationCodeAccessTokenProvider.java###org.springframework.security.oauth2.client.token.grant.code.AuthorizationCodeAccessTokenProvider###getRedirectForAuthorization:AuthorizationCodeResourceDetails AccessTokenRequest ###redirectUri=request.getUserAuthorizationRedirectUri();###userRedirectUri###request.getUserAuthorizationRedirectUri()###96:4:96:60
0648802d321d7e97e946b1f7fba2e55d4fc49401###/spring-projects_spring-security-oauth/samples/oauth2/sparklr/src/test/java/org/springframework/security/oauth2/provider/TestAuthorizationCodeProvider.java###/TestAuthorizationCodeProvider.java###org.springframework.security.oauth2.provider.TestAuthorizationCodeProvider###getAccessToken:String String String String HttpStatus ###assertTrue("Missingno-store:"+map.getHeaders(),map.getHeaders().get("Cache-Control").contains("no-store"));###responseHeaders###map.getHeaders()###239:3:239:115
465306e699c7d3aab619bfb8e4881967a08b7b2a###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/filter/OAuth2ClientContextFilter.java###/OAuth2ClientContextFilter.java###org.springframework.security.oauth2.client.filter.OAuth2ClientContextFilter###doFilter:ServletRequest ServletResponse FilterChain ###accessTokenRequest.setPreservedState(statePersistenceServices.loadPreservedState(request.getParameter("state"),request,response));###stateKey###request.getParameter("state")###102:5:103:58
e171dad81640d775466a69ccab8ac8ed2a81fa6c###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/approval/TokenStoreUserApprovalHandler.java###/TokenStoreUserApprovalHandler.java###org.springframework.security.oauth2.provider.approval.TokenStoreUserApprovalHandler###checkForPreApproval:AuthorizationRequest Authentication ###builder.append(",scope="+authorizationRequest.getScope());###scopes###authorizationRequest.getScope()###96:4:96:65
c0961fd84bcf895cf00e8e03daf131bd326cd3d7###/spring-projects_spring-security-oauth/samples/oauth2/sparklr/src/main/java/org/springframework/security/oauth/examples/sparklr/mvc/AdminController.java###/AdminController.java###org.springframework.security.oauth.examples.sparklr.mvc.AdminController###enhance:Collection<OAuth2AccessToken> ###StringclientId=tokenStore.readAuthentication(token).getOAuth2Request().getClientId();###authentication###tokenStore.readAuthentication(token)###80:4:80:92
dab2d7b4b9754658d60041bb0f91426e362c7507###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/OAuth2ClientBeanDefinitionParser.java###/OAuth2ClientBeanDefinitionParser.java###org.springframework.security.oauth2.config.OAuth2ClientBeanDefinitionParser###parse:Element ParserContext ###providers.add(BeanDefinitionBuilder.genericBeanDefinition(AuthorizationCodeAccessTokenProvider.class).getBeanDefinition());###authCodeProvider###BeanDefinitionBuilder.genericBeanDefinition(AuthorizationCodeAccessTokenProvider.class)###75:7:75:130
3a76715509e82e5b2fe97cfc5e4abf4aaba02fa1###/spring-projects_spring-security-oauth/tests/annotation/common/src/main/java/sparklr/common/AbstractResourceOwnerPasswordProviderTests.java###/AbstractResourceOwnerPasswordProviderTests.java###sparklr.common.AbstractResourceOwnerPasswordProviderTests###testTokenEndpointunauthenticated:###assertEquals(HttpStatus.UNAUTHORIZED,http.getRestTemplate().exchange(http.getUrl("/oauth/token"),HttpMethod.GET,newHttpEntity<Void>((Void)null),String.class).getStatusCode());###result###http.getRestTemplate().exchange(http.getUrl("/oauth/token"),HttpMethod.GET,newHttpEntity<Void>((Void)null),String.class)###170:3:173:72
ed129204348d6884192d5b0ead645f3e30cd18c0###/spring-projects_spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/authentication/OAuth2AuthenticationProcessingFilter.java###/OAuth2AuthenticationProcessingFilter.java###org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter###doFilter:ServletRequest ServletResponse FilterChain ###AuthenticationauthResult=authenticationManager.authenticate(newPreAuthenticatedAuthenticationToken(tokenValue,""));###authentication###newPreAuthenticatedAuthenticationToken(tokenValue,"")###91:5:92:24
