49d1fe7e83be8c4cfd4b274d38b507eb538a45f3###/Graylog2_graylog2-server/graylog-storage-elasticsearch7/src/main/java/org/graylog/storage/elasticsearch7/views/searchtypes/pivot/ESPivot.java###/ESPivot.java###org.graylog.storage.elasticsearch7.views.searchtypes.pivot.ESPivot###doExtractResult:SearchJob Query Pivot SearchResponse Aggregations ESGeneratedQueryContext ###finalStringcolumnsAggName=queryContext.contextMap().get(pivot.id()+"-columns").toString();###columnsKey###pivot.id()+"-columns"###256:25:256:121
e678969bf447d070bc4bf8ed96bf9f30b87ee301###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/filters/ExtractorFilter.java###/ExtractorFilter.java###org.graylog2.filters.ExtractorFilter###filter:Message ###LOG.error("Couldnotapplyextractor\""+extractor.getTitle()+"\"(id="+extractor.getId()+")"+"tomessage"+msg.getId(),e);###error###"Couldnotapplyextractor\""+extractor.getTitle()+"\"(id="+extractor.getId()+")"+"tomessage"+msg.getId()###80:17:81:59
3a4efd17f0c5bf18c700c5677ee33b0fc73c7d66###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/shared/messageq/sqs/SqsMessageQueueWriter.java###/SqsMessageQueueWriter.java###org.graylog2.shared.messageq.sqs.SqsMessageQueueWriter###write:List<RawMessageEvent> ###finalTimer.Contextignored=writeTimer.time()###writeTime###writeTimer.time()###108:18:108:65
74a8485149d0511940b19bfb5fa177f4b482a3af###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/contentpacks/facades/DashboardV1FacadeTest.java###/DashboardV1FacadeTest.java###org.graylog2.contentpacks.facades.DashboardV1FacadeTest###setUp:###searchDbService=newViewFacadeTest.TestSearchDBService(mongodb.mongoConnection(),newMongoJackObjectMapperProvider(objectMapper));###mongoConnection###mongodb.mongoConnection()###137:9:138:66
b10d44963262210d2bd0b06b43002649927f1515###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/lookup/adapters/dsvhttp/HTTPFileRetriever.java###/HTTPFileRetriever.java###org.graylog2.lookup.adapters.dsvhttp.HTTPFileRetriever###fetchFile:String boolean ###finalResponseresponse=request.execute()###response###request.execute()###76:14:76:57
4409bd1522ba46718115de57e036226751718df4###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/plugin/utilities/date/NaturalDateParser.java###/NaturalDateParser.java###org.graylog2.plugin.utilities.date.NaturalDateParser###parse:String Date ###finalList<Date>dates=groups.get(0).getDates();###group###groups.get(0)###64:13:64:63
8b952cb3ffb74522a70af1f4f40c2c315b7606e7###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog/testing/completebackend/GraylogBackend.java###/GraylogBackend.java###org.graylog.testing.completebackend.GraylogBackend###createStartedBackend:int[] ElasticsearchInstanceFactory ###returnnewGraylogBackend(esFuture.get(),mongoDB,node);###esInstance###esFuture.get()###72:13:72:70
1ed7b263c8b7b6e1d3831b7d02e9c0553322a3b0###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/plugins/views/search/rest/ViewsResource.java###/ViewsResource.java###org.graylog.plugins.views.search.rest.ViewsResource###setDefault:String ###dbService.saveDefault(loadView(id));###savedView###loadView(id)###182:9:182:45
bd25d37951acd30916447bed0d76325f9ff3bdf2###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/users/UserServiceImplTest.java###/UserServiceImplTest.java###org.graylog2.users.UserServiceImplTest###testGetPermissionsForUser:###when(grantPermissionResolver.resolvePermissionsForPrincipal(grnRegistry.newGRN(GRNTypes.USER,"user"))).thenReturn(ImmutableSet.of(newWildcardPermission("perm:from:grant"),ownerShipPermission));###userGRN###grnRegistry.newGRN(GRNTypes.USER,"user")###235:9:238:47
94befb961927c2487d156fdbb80094feff2830a0###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/shared/buffers/JournallingMessageHandler.java###/JournallingMessageHandler.java###org.graylog2.shared.buffers.JournallingMessageHandler###onEvent:RawMessageEvent long boolean ###finalList<RawMessageEvent>entries=Lists.newArrayList(transform(batch,newFilter()));###metricsFilter###newFilter()###95:13:95:102
a921e767c29fb4d9ca3607af741d7b8f2d675508###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/rest/resources/streams/StreamResource.java###/StreamResource.java###org.graylog2.rest.resources.streams.StreamResource###create:CreateStreamRequest UserContext ###if(!stream.getIndexSet().getConfig().isWritable())###indexSet###stream.getIndexSet()###170:9:172:10
a2f3528f32c470ec1761b15943e52ad467c135d4###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/security/shares/EntitySharesService.java###/EntitySharesService.java###org.graylog.security.shares.EntitySharesService###updateEntityShares:GRN EntityShareRequest User ###finalEntityShareResponse.BuilderresponseBuilder=EntityShareResponse.builder().entity(ownedEntity.toString()).sharingUser(sharingUserGRN).availableGrantees(granteeService.getAvailableGrantees(sharingUser)).availableCapabilities(getAvailableCapabilities()).missingPermissionsOnDependencies(checkMissingPermissionsOnDependencies(ownedEntity,sharingUserGRN,ImmutableSet.of(),request));###availableGrantees###granteeService.getAvailableGrantees(sharingUser)###131:9:137:18
d8c1c8b392ccbb74d123c61bc9f968f1341c6fec###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/shared/initializers/JerseyService.java###/JerseyService.java###org.graylog2.shared.initializers.JerseyService###openAPISetup:String[] ResourceConfig ###openAPI.components(newComponents().addSecuritySchemes("basicAuth",newSecurityScheme().name("basicAuth").type(SecurityScheme.Type.HTTP).scheme("basic")));###components###newComponents().addSecuritySchemes("basicAuth",newSecurityScheme().name("basicAuth").type(SecurityScheme.Type.HTTP).scheme("basic"))###321:9:325:44
2f793886a66a455d89dfaeca0bc2dc1f7fc3e158###/Graylog2_graylog2-server/graylog-storage-elasticsearch7/src/main/java/org/graylog/storage/elasticsearch7/views/searchtypes/pivot/ESPivot.java###/ESPivot.java###org.graylog.storage.elasticsearch7.views.searchtypes.pivot.ESPivot###extractEffectiveTimeRange:SearchResponse Query Pivot ###returnAbsoluteRange.create(isAllMessagesTimeRange(pivotRange)&&from!=0?newDateTime(from.longValue(),DateTimeZone.UTC):query.effectiveTimeRange(pivot).getFrom(),isAllMessagesTimeRange(pivotRange)&&to!=0?newDateTime(to.longValue(),DateTimeZone.UTC):query.effectiveTimeRange(pivot).getTo());###pivotRange###query.effectiveTimeRange(pivot)###197:9:204:11
4dffd6fd181d5e33ea5f1b067758faec4d4a8ef6###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/plugins/views/search/rest/ViewsResource.java###/ViewsResource.java###org.graylog.plugins.views.search.rest.ViewsResource###setDefault:String ###dbService.saveDefault(loadView(id));###savedView###loadView(id)###198:9:198:45
4903df205d6731634fefe435ed471ab5092465a3###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/plugin/periodical/Periodical.java###/Periodical.java###org.graylog2.plugin.periodical.Periodical###run:###getLogger().error("Uncaughtexceptioninperiodical",e);###logger###getLogger()###94:13:94:70
49d1fe7e83be8c4cfd4b274d38b507eb538a45f3###/Graylog2_graylog2-server/graylog-storage-elasticsearch6/src/main/java/org/graylog/storage/elasticsearch6/views/searchtypes/pivot/ESPivot.java###/ESPivot.java###org.graylog.storage.elasticsearch6.views.searchtypes.pivot.ESPivot###doExtractResult:SearchJob Query Pivot SearchResult MetricAggregation ESGeneratedQueryContext ###finalStringcolumnsAggName=queryContext.contextMap().get(pivot.id()+"-columns").toString();###columnsKey###pivot.id()+"-columns"###223:25:223:121
8fe07ab2dd32dac759a0c1ef6243454afa2011a0###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/rest/resources/system/indexer/IndexSetsResource.java###/IndexSetsResource.java###org.graylog2.rest.resources.system.indexer.IndexSetsResource###update:String IndexSetUpdateRequest ###finalIndexSetConfigsavedObject=indexSetService.save(updateRequest.toIndexSetConfig(id,oldConfig));###indexSetConfig###updateRequest.toIndexSetConfig(id,oldConfig)###264:9:264:112
2f793886a66a455d89dfaeca0bc2dc1f7fc3e158###/Graylog2_graylog2-server/graylog-storage-elasticsearch6/src/main/java/org/graylog/storage/elasticsearch6/views/searchtypes/pivot/ESPivot.java###/ESPivot.java###org.graylog.storage.elasticsearch6.views.searchtypes.pivot.ESPivot###extractEffectiveTimeRange:SearchResult Query Pivot ###returnAbsoluteRange.create(isAllMessagesTimeRange(pivotRange)&&from!=null?newDateTime(from.longValue(),DateTimeZone.UTC):query.effectiveTimeRange(pivot).getFrom(),isAllMessagesTimeRange(pivotRange)&&to!=null?newDateTime(to.longValue(),DateTimeZone.UTC):query.effectiveTimeRange(pivot).getTo());###pivotRange###query.effectiveTimeRange(pivot)###192:9:199:11
ae427f1c7be8dc1f5835155057212ca18c47ee29###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/security/authservice/ldap/UnboundLDAPConnector.java###/UnboundLDAPConnector.java###org.graylog.security.authservice.ldap.UnboundLDAPConnector###createLDAPUser:UnboundLDAPConfig LDAPEntry ###returnLDAPUser.builder().base64UniqueId(ldapEntry.base64UniqueId()).username(ldapEntry.nonBlankAttribute(config.userNameAttribute())).fullName(ldapEntry.nonBlankAttribute(config.userFullNameAttribute())).email(ldapEntry.firstAttributeValue("mail").orElse(ldapEntry.firstAttributeValue("rfc822Mailbox").orElse(""))).entry(ldapEntry).build();###username###ldapEntry.nonBlankAttribute(config.userNameAttribute())###292:9:298:26
dd13876f41e6b1826475ef01c53d28b27b1d1ba9###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/plugins/pipelineprocessor/processors/PipelineInterpreter.java###/PipelineInterpreter.java###org.graylog.plugins.pipelineprocessor.processors.PipelineInterpreter###evaluateRuleCondition:Rule Message String Pipeline EvaluationContext List<Rule> InterpreterListener ###booleanmatched=rule.when().evaluateBool(context);###logicalExpression###rule.when()###399:9:399:61
d7049a78cdf1cdbcc300ba4dc9dcdc9c0d1cec00###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/plugins/views/search/rest/ViewsResource.java###/ViewsResource.java###org.graylog.plugins.views.search.rest.ViewsResource###setDefault:String ###dbService.saveDefault(loadView(id));###savedView###loadView(id)###193:9:193:45
e678969bf447d070bc4bf8ed96bf9f30b87ee301###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/plugin/inputs/Extractor.java###/Extractor.java###org.graylog2.plugin.inputs.Extractor###runConverters:Message ###LOG.error("Couldnotapplyconverter["+converter.getType()+"]ofextractor["+getId()+"].",e);###error###"Couldnotapplyconverter["+converter.getType()+"]ofextractor["+getId()+"]."###284:21:284:125
74a8485149d0511940b19bfb5fa177f4b482a3af###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/contentpacks/facades/ViewFacadeTest.java###/ViewFacadeTest.java###org.graylog2.contentpacks.facades.ViewFacadeTest###setUp:###searchDbService=newTestSearchDBService(mongodb.mongoConnection(),newMongoJackObjectMapperProvider(objectMapper));###mapper###newMongoJackObjectMapperProvider(objectMapper)###142:9:143:66
0781a85194156128a150980ee0287d9903a79a8a###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/plugins/views/search/validation/FieldTypeValidationImpl.java###/FieldTypeValidationImpl.java###org.graylog.plugins.views.search.validation.FieldTypeValidationImpl###validateFieldValueType:ParsedTerm String ###returnOptional.of(ValidationMessage.builder(ValidationType.INVALID_VALUE_TYPE).errorMessage(String.format(Locale.ROOT,"Typeof%sis%s,cannotusevalue%s",t.getRealFieldName(),detectedFieldType,t.value())).build());###builder###ValidationMessage.builder(ValidationType.INVALID_VALUE_TYPE).errorMessage(String.format(Locale.ROOT,"Typeof%sis%s,cannotusevalue%s",t.getRealFieldName(),detectedFieldType,t.value()))###66:13:68:31
847784dbf31dfb86762642b938bfca5680edb71e###/Graylog2_graylog2-server/full-backend-tests/src/test/java/org/graylog/testing/utils/WaitUtils.java###/WaitUtils.java###org.graylog.testing.utils.WaitUtils###waitFor:Producer<Boolean> String ###predicate.call()###result###predicate.call()###32:17:32:33
bfab844eeea6d3fad14464c17caeef5c30c92764###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/rest/resources/users/UsersResource.java###/UsersResource.java###org.graylog2.rest.resources.users.UsersResource###changePassword:String ChangePasswordRequest ###if(!getSubject().isPermitted(RestPermissions.USERS_PASSWORDCHANGE+":"+user.getName()))###username###user.getName()###473:9:475:10
65e7c1411b5b267bacd866cd73711dfd20959aca###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog/testing/containermatrix/ContainerMatrixTestEngine.java###/ContainerMatrixTestEngine.java###org.graylog.testing.containermatrix.ContainerMatrixTestEngine###testAgainstRunningESMongoDB:###return!isBlank(System.getenv("GRAYLOG_TEST_WITH_RUNNING_ES_AND_MONGODB"));###value###System.getenv("GRAYLOG_TEST_WITH_RUNNING_ES_AND_MONGODB")###140:9:140:84
4d8558b44c2c0e2fa4317e66dfa86386d58c8be4###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/shared/buffers/JournallingMessageHandler.java###/JournallingMessageHandler.java###org.graylog2.shared.buffers.JournallingMessageHandler###onEvent:RawMessageEvent long boolean ###finalList<RawMessageEvent>entries=Lists.newArrayList(transform(batch,newFilter()));###metricsFilter###newFilter()###92:13:92:102
c2147143d40da1d2c275de844707da524769f12b###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/plugins/views/search/rest/ViewsResource.java###/ViewsResource.java###org.graylog.plugins.views.search.rest.ViewsResource###create:ViewDTO UserContext ###finalViewDTOsavedDto=dbService.saveWithOwner(dto.toBuilder().owner(userContext.getUsername()).build(),userContext.getUser());###user###userContext.getUser()###152:9:152:139
a2f3528f32c470ec1761b15943e52ad467c135d4###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/security/shares/EntitySharesService.java###/EntitySharesService.java###org.graylog.security.shares.EntitySharesService###prepareShare:GRN EntityShareRequest User Subject ###returnEntityShareResponse.builder().entity(ownedEntity.toString()).sharingUser(sharingUserGRN).availableGrantees(granteeService.getAvailableGrantees(sharingUser)).availableCapabilities(getAvailableCapabilities()).activeShares(activeShares).selectedGranteeCapabilities(getSelectedGranteeCapabilities(activeShares,request)).missingPermissionsOnDependencies(checkMissingPermissionsOnDependencies(ownedEntity,sharingUserGRN,activeShares,request)).validationResult(validateRequest(ownedEntity,request,sharingUserGRN)).build();###availableGrantees###granteeService.getAvailableGrantees(sharingUser)###99:9:108:26
74a8485149d0511940b19bfb5fa177f4b482a3af###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/contentpacks/facades/ViewFacadeTest.java###/ViewFacadeTest.java###org.graylog2.contentpacks.facades.ViewFacadeTest###setUp:###searchDbService=newTestSearchDBService(mongodb.mongoConnection(),newMongoJackObjectMapperProvider(objectMapper));###mongoConnection###mongodb.mongoConnection()###142:9:143:66
b17650501296dc0ba941e9113af6069e797534f5###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/indexer/indices/IndicesIT.java###/IndicesIT.java###org.graylog2.indexer.indices.IndicesIT###createOverwritesIndexTemplate:###indices.create("index_template_test",indexSet);###indexName###"index_template_test"###258:9:258:57
9bb4e40624e45902c6d1d62933a5eb8511176403###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/indexer/rotation/strategies/TimeBasedRotationStrategy.java###/TimeBasedRotationStrategy.java###org.graylog2.indexer.rotation.strategies.TimeBasedRotationStrategy###shouldRotate:String IndexSet ###finalPeriodrotationPeriod=config.rotationPeriod().normalizedStandard();###rotationPeriod###config.rotationPeriod()###158:9:158:84
537dee150442078341d31cf868b45b00913458f9###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog2/security/realm/BearerTokenRealm.java###/BearerTokenRealm.java###org.graylog2.security.realm.BearerTokenRealm###toAuthenticationInfo:AuthServiceResult ###returnnewSimpleAccount(result.userProfileId(),null,NAME+"/"+result.backendType());###realmName###NAME+"/"+result.backendType()###91:9:91:99
49d1fe7e83be8c4cfd4b274d38b507eb538a45f3###/Graylog2_graylog2-server/graylog-storage-elasticsearch6/src/main/java/org/graylog/storage/elasticsearch6/views/searchtypes/pivot/ESPivot.java###/ESPivot.java###org.graylog.storage.elasticsearch6.views.searchtypes.pivot.ESPivot###doExtractResult:SearchJob Query Pivot SearchResult MetricAggregation ESGeneratedQueryContext ###finalStringrowsAggName=queryContext.contextMap().get(pivot.id()+"-rows").toString();###rowKey###pivot.id()+"-rows"###209:9:209:99
685d599321071ba7dfc2ea7edd87f965429ba1b9###/Graylog2_graylog2-server/graylog2-server/src/main/java/org/graylog/failure/FailureSubmissionService.java###/FailureSubmissionService.java###org.graylog.failure.FailureSubmissionService###submitProcessingFailure:Message String String ###finalProcessingFailureprocessingFailure=newProcessingFailure(failedMessage.getMessageId(),errorType,error,failedMessage.getTimestamp(),failedMessage,needsAcknowledgement);###failedMessageId###failedMessage.getMessageId()###91:13:91:194
74a8485149d0511940b19bfb5fa177f4b482a3af###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/contentpacks/facades/DashboardV1FacadeTest.java###/DashboardV1FacadeTest.java###org.graylog2.contentpacks.facades.DashboardV1FacadeTest###setUp:###searchDbService=newViewFacadeTest.TestSearchDBService(mongodb.mongoConnection(),newMongoJackObjectMapperProvider(objectMapper));###mapper###newMongoJackObjectMapperProvider(objectMapper)###137:9:138:66
c2147143d40da1d2c275de844707da524769f12b###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/security/realm/LdapUserAuthenticatorTest.java###/LdapUserAuthenticatorTest.java###org.graylog2.security.realm.LdapUserAuthenticatorTest###testDoGetAuthenticationInfo:###doReturn(mock(User.class)).when(authenticator).syncFromLdapEntry(any(LdapEntry.class),any(LdapSettings.class),anyString());###user###mock(User.class)###157:9:159:95
f8cf3daeb53a6d86cd24bf9946c64d85ca070750###/Graylog2_graylog2-server/graylog2-server/src/test/java/org/graylog2/lookup/adapters/CSVFileDataAdapterTest.java###/CSVFileDataAdapterTest.java###org.graylog2.lookup.adapters.CSVFileDataAdapterTest###CSVFileDataAdapterTest:###this.csvFile=Paths.get(resource.toURI());###csvFilePath###Paths.get(resource.toURI())###36:9:36:52
49d1fe7e83be8c4cfd4b274d38b507eb538a45f3###/Graylog2_graylog2-server/graylog-storage-elasticsearch7/src/main/java/org/graylog/storage/elasticsearch7/views/searchtypes/pivot/ESPivot.java###/ESPivot.java###org.graylog.storage.elasticsearch7.views.searchtypes.pivot.ESPivot###doExtractResult:SearchJob Query Pivot SearchResponse Aggregations ESGeneratedQueryContext ###finalStringrowsAggName=queryContext.contextMap().get(pivot.id()+"-rows").toString();###rowKey###pivot.id()+"-rows"###242:9:242:99
