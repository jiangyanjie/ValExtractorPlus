0ddec86444bbdd94221032a3128f7dbe79934b93###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/PulsarService.java###/PulsarService.java###org.apache.pulsar.broker.PulsarService###closeAsync:###asyncCloseFutures.add(this.brokerService.closeAsync());###brokerCloseFuture###this.brokerService.closeAsync()###449:17:449:72
a6e66dd38bbb9edc552fe6877d0d600bd6d5506b###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/transaction/buffer/TransactionBufferClientTest.java###/TransactionBufferClientTest.java###org.apache.pulsar.broker.transaction.buffer.TransactionBufferClientTest###testTransactionBufferHandlerSemaphore:###tbClient.commitTxnOnSubscription(topic+"_commit_sub","test",1L,1L,-1L).get();###commitTopic###topic+"_commit_sub"###339:9:339:92
0aca5f9153afc7804a3ae9b169346a06ee9811d9###/apache_pulsar/pulsar-client-admin/src/main/java/org/apache/pulsar/client/admin/internal/TopicsImpl.java###/TopicsImpl.java###org.apache.pulsar.client.admin.internal.TopicsImpl###getStatsAsync:String boolean boolean ###asyncGetRequest(path,newInvocationCallback<TopicStats>(){@Overridepublicvoidcompleted(TopicStatsresponse){future.complete(response);}@Overridepublicvoidfailed(Throwablethrowable){future.completeExceptionally(getApiException(throwable.getCause()));}});###persistentCB###newInvocationCallback<TopicStats>(){@Overridepublicvoidcompleted(TopicStatsresponse){future.complete(response);}@Overridepublicvoidfailed(Throwablethrowable){future.completeExceptionally(getApiException(throwable.getCause()));}}###710:9:722:20
a6e66dd38bbb9edc552fe6877d0d600bd6d5506b###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/transaction/buffer/TransactionBufferClientTest.java###/TransactionBufferClientTest.java###org.apache.pulsar.broker.transaction.buffer.TransactionBufferClientTest###testTransactionBufferLookUp:###tbClient.commitTxnOnSubscription(topic+"_commit_sub","test",1L,1L,-1L).get();###commitTopic###topic+"_commit_sub"###320:9:320:92
4d3fdae532f2e55392daaa92c9ffabbd4db8c278###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java###/ConsumerImpl.java###org.apache.pulsar.client.impl.ConsumerImpl###closeAsync:###booleanignoreException=!cnx.ctx().channel().isActive();###ctx###cnx.ctx()###929:17:929:75
7dcc2ae2eb80404cbd90cc0884839683c9b748ec###/apache_pulsar/pulsar-sql/presto-pulsar/src/main/java/org/apache/pulsar/sql/presto/PulsarSplitManager.java###/PulsarSplitManager.java###org.apache.pulsar.sql.presto.PulsarSplitManager###getSplitsPartitionedTopic:int TopicName PulsarTableHandle SchemaInfo TupleDomain<ColumnHandle> OffloadPolicies ###ManagedLedgerFactorymanagedLedgerFactory=PulsarConnectorCache.getConnectorCache(pulsarConnectorConfig).getManagedLedgerFactory();###pulsarConnectorCache###PulsarConnectorCache.getConnectorCache(pulsarConnectorConfig)###163:9:164:44
bdc62ecac2a96b5ff657b5e70c306df81e3fe93d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryReleaseConnectionThrottle:###if((topicPublishRateLimiterOnMessage!=null&&topicPublishRateLimiterOnMessage.getAvailablePermits()<=0)||(topicPublishRateLimiterOnByte!=null&&topicPublishRateLimiterOnByte.getAvailablePermits()<=0))###currentTopicPublishRateLimiterOnByte###topicPublishRateLimiterOnByte###68:9:71:10
a6e66dd38bbb9edc552fe6877d0d600bd6d5506b###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleEndTxnOnPartition:CommandEndTxnOnPartition ###optionalTopic.get().endTxn(txnID,txnAction,command.getTxnidLeastBitsOfLowWatermark()).whenComplete((ignored,throwable)->{if(throwable!=null){log.error("HandleendTxnOnPartition{}failed.",topic,throwable);ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,BrokerServiceException.getClientErrorCode(throwable),throwable.getMessage()));return;}ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,txnID.getLeastSigBits(),txnID.getMostSigBits()));});###lowWaterMark###command.getTxnidLeastBitsOfLowWatermark()###2017:17:2028:28
ded806fd52f6e2f182fa02052cbd82c2a6755098###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryReleaseConnectionThrottle:###if((topicPublishRateLimiterOnMessage!=null&&topicPublishRateLimiterOnMessage.getAvailablePermits()<=0)||(topicPublishRateLimiterOnByte!=null&&topicPublishRateLimiterOnByte.getAvailablePermits()<=0))###currentTopicPublishRateLimiterOnByte###topicPublishRateLimiterOnByte###67:9:70:10
37e3180f06188c4d34cd347d46d66bcde3516445###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleEndTxnOnPartition:CommandEndTxnOnPartition ###service.getTopics().get(TopicName.get(topic).toString()).whenComplete((optionalTopic,t)->{if(!optionalTopic.isPresent()){ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,ServerError.TopicNotFound,"Topic"+topic+"isnotfound."));return;}optionalTopic.get().endTxn(txnID,txnAction,command.getTxnidLeastBitsOfLowWatermark()).whenComplete((ignored,throwable)->{if(throwable!=null){log.error("HandleendTxnOnPartition{}failed.",topic,throwable);ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,BrokerServiceException.getClientErrorCode(throwable),throwable.getMessage()));return;}ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,txnID.getLeastSigBits(),txnID.getMostSigBits()));});});###topicFuture###service.getTopics().get(TopicName.get(topic).toString())###1874:9:1893:12
36c3bc3178a2e7b5d05b8eb0148242379896c63a###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/TransactionMetadataStoreService.java###/TransactionMetadataStoreService.java###org.apache.pulsar.broker.TransactionMetadataStoreService###addTransactionMetadataStore:TransactionCoordinatorID ###transactionMetadataStoreProvider.openStore(tcId,pulsarService.getManagedLedgerFactory(),v,timeoutTrackerFactory.newTracker(tcId)).whenComplete((store,ex)->{if(ex!=null){LOG.error("Addtransactionmetadatastorewithid{}error",tcId.getId(),ex);}else{stores.put(tcId,store);LOG.info("Addednewtransactionmetastore{}",tcId);}});###timeoutTracker###timeoutTrackerFactory.newTracker(tcId)###140:25:149:36
80f42e20099abac4002e8f84bbdcaba7aa57a8bd###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentTopic.java###/PersistentTopic.java###org.apache.pulsar.broker.service.persistent.PersistentTopic###getInternalStats:boolean ###brokerService.getPulsar().getBookKeeperClient().getLedgerMetadata(ledgerId).thenAccept(metadata->{LedgerInfoschemaLedgerInfo=newLedgerInfo();schemaLedgerInfo.ledgerId=metadata.getLedgerId();schemaLedgerInfo.entries=metadata.getLastEntryId()+1;schemaLedgerInfo.size=metadata.getLength();if(includeLedgerMetadata){info.metadata=metadata.toSafeString();}stats.schemaLedgers.add(schemaLedgerInfo);completableFuture.complete(null);}).exceptionally(e->{completableFuture.completeExceptionally(e);returnnull;});###metadataFuture###brokerService.getPulsar().getBookKeeperClient().getLedgerMetadata(ledgerId)###1943:29:1958:32
ca64c67acac41c34edf15ffa6ca8b5beac6f99ea###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/protocol/ProtocolHandlerUtils.java###/ProtocolHandlerUtils.java###org.apache.pulsar.broker.protocol.ProtocolHandlerUtils###load:ProtocolHandlerMetadata String ###NarClassLoaderncl=NarClassLoader.getFromArchive(metadata.getArchivePath().toAbsolutePath().toFile(),Collections.emptySet(),ProtocolHandler.class.getClassLoader(),narExtractionDirectory);###narFile###metadata.getArchivePath().toAbsolutePath().toFile()###120:9:123:77
9af857781fc3d357834eaa13acf45005f8186875###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/client/api/RawReader.java###/RawReader.java###org.apache.pulsar.client.api.RawReader###create:PulsarClient String String ###r.seekAsync(MessageId.earliest)###finalR###r###37:49:37:80
76045bdb78e4645a78831d9b9a3312f17d6454d1###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConnectionPool.java###/ConnectionPool.java###org.apache.pulsar.client.impl.ConnectionPool###ConnectionPool:ClientConfigurationData EventLoopGroup Supplier<ClientCnx> ###this.dnsResolver=newDnsNameResolverBuilder(eventLoopGroup.next()).traceEnabled(true).channelType(EventLoopUtil.getDatagramChannelClass(eventLoopGroup)).build();###dnsNameResolverBuilder###newDnsNameResolverBuilder(eventLoopGroup.next()).traceEnabled(true).channelType(EventLoopUtil.getDatagramChannelClass(eventLoopGroup))###102:9:103:93
555042a45d9692148c302fbdedbb47f1f2572a48###/apache_pulsar/pulsar-transaction/coordinator/src/main/java/org/apache/pulsar/transaction/coordinator/impl/MLTransactionMetadataStoreProvider.java###/MLTransactionMetadataStoreProvider.java###org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider###openStore:TransactionCoordinatorID ManagedLedgerFactory ManagedLedgerConfig TransactionTimeoutTracker TransactionRecoverTracker ###transactionMetadataStore=newMLTransactionMetadataStore(transactionCoordinatorId,newMLTransactionLogImpl(transactionCoordinatorId,managedLedgerFactory,managedLedgerConfig),timeoutTracker,recoverTracker);###txnLog###newMLTransactionLogImpl(transactionCoordinatorId,managedLedgerFactory,managedLedgerConfig)###49:13:52:113
c6beb35c428831cc53dfa10605d30f57d8743f02###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/systopic/TopicPoliciesSystemTopicClient.java###/TopicPoliciesSystemTopicClient.java###org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient.TopicPolicyWriter###writeAsync:PulsarEvent ###returnproducer.newMessage().key(getEventKey(event)).value(event).sendAsync();###builder###producer.newMessage().key(getEventKey(event)).value(event)###89:13:89:91
ca64c67acac41c34edf15ffa6ca8b5beac6f99ea###/apache_pulsar/pulsar-proxy/src/main/java/org/apache/pulsar/proxy/extensions/ProxyExtensionsUtils.java###/ProxyExtensionsUtils.java###org.apache.pulsar.proxy.extensions.ProxyExtensionsUtils###load:ProxyExtensionMetadata String ###NarClassLoaderncl=NarClassLoader.getFromArchive(metadata.getArchivePath().toAbsolutePath().toFile(),Collections.emptySet(),ProxyExtension.class.getClassLoader(),narExtractionDirectory);###narFile###metadata.getArchivePath().toAbsolutePath().toFile()###120:9:123:76
4b86c26ef90b518eee15504a9d7452a3a122159f###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/TransactionsBase.java###/TransactionsBase.java###org.apache.pulsar.broker.admin.impl.TransactionsBase###internalGetCoordinatorStats:AsyncResponse boolean Integer ###asyncResponse.resume(pulsar().getTransactionMetadataStoreService().getStores().get(TransactionCoordinatorID.get(coordinatorId)).getCoordinatorStats());###transactionMetadataStore###pulsar().getTransactionMetadataStoreService().getStores().get(TransactionCoordinatorID.get(coordinatorId))###63:17:64:98
152d1e69d16b510521003a33ea877ae33f0ce8e5###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/PulsarService.java###/PulsarService.java###org.apache.pulsar.broker.PulsarService###close:###throw(PulsarServerException)e.getCause();###cause###e.getCause()###312:17:312:60
e017b108fc9f1fea085465ba1bbbbb625e6370f6###/apache_pulsar/pulsar-common/src/main/java/org/apache/pulsar/common/protocol/Commands.java###/Commands.java###org.apache.pulsar.common.protocol.Commands###newGetLastMessageIdResponse:long long long int int ###cmd.setGetLastMessageIdResponse().setRequestId(requestId).setLastMessageId().setLedgerId(ledgerId).setEntryId(entryId).setPartition(partitionIdx).setBatchIndex(batchIndex);###response###cmd.setGetLastMessageIdResponse().setRequestId(requestId)###1056:9:1062:40
da27b9eac613e65621822b18c0ec40cebcfe55b0###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/persistent/PersistentSubscriptionTest.java###/PersistentSubscriptionTest.java###org.apache.pulsar.broker.service.persistent.PersistentSubscriptionTest###setup:###doReturn(mock(PulsarResources.class)).when(pulsarMock).getPulsarResources();###pulsarResources###mock(PulsarResources.class)###123:9:123:85
d055ebd1186ffae2d2af1382e05b21c60e9f9574###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/BrokerServiceAutoTopicCreationTest.java###/BrokerServiceAutoTopicCreationTest.java###org.apache.pulsar.broker.service.BrokerServiceAutoTopicCreationTest###testAutoCreationNamespaceDisallowOverridesBroker:###pulsar.getAdminClient().namespaces().setAutoTopicCreation(topicName.getNamespace(),AutoTopicCreationOverride.builder().allowAutoTopicCreation(false).build());###autoTopicCreationOverride###AutoTopicCreationOverride.builder().allowAutoTopicCreation(false).build()###188:9:191:35
de6bdaf27d858f17f736602c435c2643efb3c6a6###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/PulsarService.java###/PulsarService.java###org.apache.pulsar.broker.PulsarService###closeAsync:###asyncCloseFutures.add(this.brokerService.closeAsync());###brokerCloseFuture###this.brokerService.closeAsync()###450:17:450:72
d055ebd1186ffae2d2af1382e05b21c60e9f9574###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/BrokerServiceAutoSubscriptionCreationTest.java###/BrokerServiceAutoSubscriptionCreationTest.java###org.apache.pulsar.broker.service.BrokerServiceAutoSubscriptionCreationTest###testAutoSubscriptionCreationNamespaceDisallowOverridesBroker:###pulsar.getAdminClient().namespaces().setAutoSubscriptionCreation(topicName.getNamespace(),AutoSubscriptionCreationOverride.builder().allowAutoSubscriptionCreation(false).build());###autoSubscriptionCreationOverride###AutoSubscriptionCreationOverride.builder().allowAutoSubscriptionCreation(false).build()###120:9:123:35
d055ebd1186ffae2d2af1382e05b21c60e9f9574###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/BrokerServiceAutoTopicCreationTest.java###/BrokerServiceAutoTopicCreationTest.java###org.apache.pulsar.broker.service.BrokerServiceAutoTopicCreationTest###testAutoCreationNamespaceOverrideAllowsPartitionedTopics:###pulsar.getAdminClient().namespaces().setAutoTopicCreation(topicName.getNamespace(),AutoTopicCreationOverride.builder().allowAutoTopicCreation(true).topicType(TopicType.PARTITIONED.toString()).defaultNumPartitions(4).build());###autoTopicCreationOverride###AutoTopicCreationOverride.builder().allowAutoTopicCreation(true).topicType(TopicType.PARTITIONED.toString()).defaultNumPartitions(4).build()###208:9:213:35
490b2be8f3c2c9594ce459e073a6491fe96069a5###/apache_pulsar/pulsar-zookeeper-utils/src/test/java/org/apache/pulsar/zookeeper/ZkIsolatedBookieEnsemblePlacementPolicyTest.java###/ZkIsolatedBookieEnsemblePlacementPolicyTest.java###org.apache.pulsar.zookeeper.ZkIsolatedBookieEnsemblePlacementPolicyTest###testBookieInfoChange:###ZkUtils.createFullPathOptimistic(localZkc,ZkBookieRackAffinityMapping.BOOKIE_INFO_ROOT_PATH,jsonMapper.writeValueAsBytes(bookieMapping),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);###data###jsonMapper.writeValueAsBytes(bookieMapping)###230:9:231:114
9af857781fc3d357834eaa13acf45005f8186875###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java###/PulsarClientImpl.java###org.apache.pulsar.client.impl.PulsarClientImpl###doCreateReaderAsync:ReaderConfigurationData<T> Schema<T> ###readerFuture.complete(reader);###finalReader###reader###569:17:569:47
ac37d802e2d3f84878aba466e89afc54fd462fb3###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/namespace/NamespaceServiceTest.java###/NamespaceServiceTest.java###org.apache.pulsar.broker.namespace.NamespaceServiceTest###testSplitBundleWithHighestThroughput:###Stringbundle=bundles.findBundle(TopicName.get(topic+"0")).getBundleRange();###targetNamespaceBundle###bundles.findBundle(TopicName.get(topic+"0"))###615:9:615:89
d64f2916e0feee1b09459b4db6094db1143067a1###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/Consumer.java###/Consumer.java###org.apache.pulsar.broker.service.Consumer###sendMessages:List<Entry> EntryBatchSizes EntryBatchIndexesAcks int long long RedeliveryTracker ###incrementUnackedMessages(totalMessages);###unackedMessages###totalMessages###270:9:270:49
1fc7e3bac8bc6dcd9f66260a0020f9ce5a4fbf78###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###newMessageAndIntercept:long long long int int ByteBuf long[] String ###getBrokerService().getInterceptor().onPulsarCommand(command,this);###brokerInterceptor###getBrokerService().getInterceptor()###2367:13:2367:80
71002c7afb03b419b6d2d8ca7eef89c4479e4e55###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentTopic.java###/PersistentTopic.java###org.apache.pulsar.broker.service.persistent.PersistentTopic.getDurableSubscription.asyncOpenCursor.new OpenCursorCallback###openCursorComplete:ManagedCursor Object ###subscriptionFuture.complete(subscription);###finalSubscription###subscription###834:17:834:59
9975fe440042241be0900e548bc7c1d152853871###/apache_pulsar/pulsar-zookeeper-utils/src/main/java/org/apache/pulsar/zookeeper/ZkBookieRackAffinityMapping.java###/ZkBookieRackAffinityMapping.java###org.apache.pulsar.zookeeper.ZkBookieRackAffinityMapping###updateRacksWithHost:BookiesRackConfiguration ###BookieSocketAddressbsa=getBookieAddressResolver().resolve(bookieId);###addressResolver###getBookieAddressResolver()###97:25:97:96
7dcc2ae2eb80404cbd90cc0884839683c9b748ec###/apache_pulsar/tests/integration/src/test/java/org/apache/pulsar/tests/integration/presto/TestPrestoQueryTieredStorage.java###/TestPrestoQueryTieredStorage.java###org.apache.pulsar.tests.integration.presto.TestPrestoQueryTieredStorage###setupPresto:###pulsarCluster.startPrestoWorker(OFFLOAD_DRIVER,getOffloadProperties(BUCKET,null,ENDPOINT));###offloadProperties###getOffloadProperties(BUCKET,null,ENDPOINT)###84:9:84:103
c6beb35c428831cc53dfa10605d30f57d8743f02###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/systopic/TopicPoliciesSystemTopicClient.java###/TopicPoliciesSystemTopicClient.java###org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient.TopicPolicyWriter###write:PulsarEvent ###returnproducer.newMessage().key(getEventKey(event)).value(event).send();###builder###producer.newMessage().key(getEventKey(event)).value(event)###84:13:84:86
555042a45d9692148c302fbdedbb47f1f2572a48###/apache_pulsar/pulsar-transaction/coordinator/src/test/java/org/apache/pulsar/transaction/coordinator/MLTransactionMetadataStoreTest.java###/MLTransactionMetadataStoreTest.java###org.apache.pulsar.transaction.coordinator.MLTransactionMetadataStoreTest###testInitTransactionReader:###MLTransactionMetadataStoretransactionMetadataStoreTest=newMLTransactionMetadataStore(transactionCoordinatorID,newMLTransactionLogImpl(transactionCoordinatorID,factory,newManagedLedgerConfig()),newTransactionTimeoutTrackerImpl(),newTransactionRecoverTrackerImpl());###txnLog2###newMLTransactionLogImpl(transactionCoordinatorID,factory,newManagedLedgerConfig())###223:17:226:143
c5d7a84c8e5c27e48022df8c7082496840cd3be9###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/transaction/TransactionBuilderImpl.java###/TransactionBuilderImpl.java###org.apache.pulsar.client.impl.transaction.TransactionBuilderImpl###build:###future.complete(newTransactionImpl(client,txnTimeout,txnID.getLeastSigBits(),txnID.getMostSigBits()));###transaction###newTransactionImpl(client,txnTimeout,txnID.getLeastSigBits(),txnID.getMostSigBits())###70:21:71:79
e375892af639194b48450389369129fc68be91b6###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/namespace/NamespaceService.java###/NamespaceService.java###org.apache.pulsar.broker.namespace.NamespaceService###isServiceUnitActive:TopicName ###returnownershipCache.getOwnedBundle(getBundle(topicName)).isActive();###ownedBundle###ownershipCache.getOwnedBundle(getBundle(topicName))###994:13:994:83
bf62bd90a2cdfb927387682c2529f2f1d9a063d2###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/resourcegroup/ResourceQuotaCalculatorImpl.java###/ResourceQuotaCalculatorImpl.java###org.apache.pulsar.broker.resourcegroup.ResourceQuotaCalculatorImpl###computeLocalQuota:long long long[] ###return(long)calculatedQuota;###longCalculatedQuota###(long)calculatedQuota###63:9:63:39
0c6e809c1ba0d667dd1a0ef87f49eb5a38b631f6###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentDispatcherMultipleConsumers.java###/PersistentDispatcherMultipleConsumers.java###org.apache.pulsar.broker.service.persistent.PersistentDispatcherMultipleConsumers###readMoreEntries:###cursor.asyncReadEntriesOrWait(messagesToRead,serviceConfig.getDispatcherMaxReadSizeBytes(),this,ReadType.Normal);###bytesToRead###serviceConfig.getDispatcherMaxReadSizeBytes()###354:17:355:42
aaa22f96f4413cf4d02059f93bcfbf88f0547b80###/apache_pulsar/pulsar-io/debezium/core/src/main/java/org/apache/pulsar/io/debezium/DebeziumSource.java###/DebeziumSource.java###org.apache.pulsar.io.debezium.DebeziumSource###open:Map<String,Object> SourceContext ###config.put(DatabaseHistory.CONFIGURATION_FIELD_PREFIX_STRING+"pulsar.client.builder",SerDeUtils.serialize(sourceContext.getPulsarClientBuilder()));###pulsarClientBuilder###SerDeUtils.serialize(sourceContext.getPulsarClientBuilder())###99:9:100:79
c6beb35c428831cc53dfa10605d30f57d8743f02###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/systopic/TopicPoliciesSystemTopicClient.java###/TopicPoliciesSystemTopicClient.java###org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient.TopicPolicyWriter###delete:PulsarEvent ###returnproducer.newMessage().key(getEventKey(event)).value(null).send();###builder###producer.newMessage().key(getEventKey(event)).value(null)###95:13:95:85
0aca5f9153afc7804a3ae9b169346a06ee9811d9###/apache_pulsar/pulsar-client-admin/src/main/java/org/apache/pulsar/client/admin/internal/TopicsImpl.java###/TopicsImpl.java###org.apache.pulsar.client.admin.internal.TopicsImpl###getPartitionedStatsAsync:String boolean boolean boolean ###asyncGetRequest(path,newInvocationCallback<PartitionedTopicStats>(){@Overridepublicvoidcompleted(PartitionedTopicStatsresponse){if(!perPartition){response.getPartitions().clear();}future.complete(response);}@Overridepublicvoidfailed(Throwablethrowable){future.completeExceptionally(getApiException(throwable.getCause()));}});###persistentCB###newInvocationCallback<PartitionedTopicStats>(){@Overridepublicvoidcompleted(PartitionedTopicStatsresponse){if(!perPartition){response.getPartitions().clear();}future.complete(response);}@Overridepublicvoidfailed(Throwablethrowable){future.completeExceptionally(getApiException(throwable.getCause()));}}###832:9:847:20
ca64c67acac41c34edf15ffa6ca8b5beac6f99ea###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/intercept/BrokerInterceptorUtils.java###/BrokerInterceptorUtils.java###org.apache.pulsar.broker.intercept.BrokerInterceptorUtils###load:BrokerInterceptorMetadata String ###NarClassLoaderncl=NarClassLoader.getFromArchive(metadata.getArchivePath().toAbsolutePath().toFile(),Collections.emptySet(),BrokerInterceptor.class.getClassLoader(),narExtractionDirectory);###narFile###metadata.getArchivePath().toAbsolutePath().toFile()###120:9:123:83
38539b351869b829c99a2b96354ce852f137015d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/namespace/NamespaceService.java###/NamespaceService.java###org.apache.pulsar.broker.namespace.NamespaceService###searchForCandidateBroker:NamespaceBundle CompletableFuture<Optional<LookupResult>> LookupOptions ###lookupFuture.complete(Optional.of(newLookupResult(ownerInfo,listener.getBrokerServiceUrl().toString(),urlTls==null?null:urlTls.toString())));###url###listener.getBrokerServiceUrl()###539:33:541:94
e4291454da5c291ea70f380008cddf4a3561b817###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/BacklogQuotaManager.java###/BacklogQuotaManager.java###org.apache.pulsar.broker.service.BacklogQuotaManager###dropBacklogForTimeLimit:PersistentTopic BacklogQuota boolean ###slowestConsumer.resetCursor(mLedger.getNextValidPosition(PositionImpl.get(ledgerInfo.getLedgerId(),ledgerInfo.getEntries()-1)));###nextPosition###mLedger.getNextValidPosition(PositionImpl.get(ledgerInfo.getLedgerId(),ledgerInfo.getEntries()-1))###248:21:249:103
25c3ae3c575469e5ad115f71b54291a1b680dff5###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/BacklogQuotaManager.java###/BacklogQuotaManager.java###org.apache.pulsar.broker.service.BacklogQuotaManager###dropBacklogForTimeLimit:PersistentTopic BacklogQuota boolean ###slowestConsumer.resetCursor(mLedger.getNextValidPosition(PositionImpl.get(ledgerInfo.getLedgerId(),ledgerInfo.getEntries()-1)));###nextPosition###mLedger.getNextValidPosition(PositionImpl.get(ledgerInfo.getLedgerId(),ledgerInfo.getEntries()-1))###251:21:252:103
bad71201189aaacfe39e737d4bc0c6baeebb5759###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentTopic.java###/PersistentTopic.java###org.apache.pulsar.broker.service.persistent.PersistentTopic###initializeDispatchRateLimiterIfNeeded:Optional<Policies> ###if(!subscribeRateLimiter.isPresent()&&SubscribeRateLimiter.isDispatchRateNeeded(brokerService,policies,topic))###isDispatchRateNeeded###SubscribeRateLimiter.isDispatchRateNeeded(brokerService,policies,topic)###370:13:373:14
dc48d29dc5d37793b0b2e6da28e7ba9b79bd4e49###/apache_pulsar/pulsar-io/elastic-search/src/test/java/org/apache/pulsar/io/elasticsearch/testcontainers/ChaosContainer.java###/ChaosContainer.java###org.apache.pulsar.io.elasticsearch.testcontainers.ChaosContainer###ChaosContainer:String String ###log.info("pumba>{}",o.getUtf8String());###string###o.getUtf8String()###41:7:41:48
b9a250dd0c80845da703bfbd0286044251187131###/apache_pulsar/pulsar-broker-common/src/main/java/org/apache/pulsar/broker/authentication/AuthenticationProviderToken.java###/AuthenticationProviderToken.java###org.apache.pulsar.broker.authentication.AuthenticationProviderToken###getValidationKey:ServiceConfiguration ###if(conf.getProperty(confTokenPublicKeySettingName)!=null&&StringUtils.isNotBlank((String)conf.getProperty(confTokenPublicKeySettingName)))###tokenPublicKey###(String)conf.getProperty(confTokenPublicKeySettingName)###261:16:268:10
9af857781fc3d357834eaa13acf45005f8186875###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConsumerBuilderImpl.java###/ConsumerBuilderImpl.java###org.apache.pulsar.client.impl.ConsumerBuilderImpl###subscribeAsync:###conf.setDeadLetterPolicy(DeadLetterPolicy.builder().maxRedeliverCount(RetryMessageUtil.MAX_RECONSUMETIMES).retryLetterTopic(retryLetterTopic).deadLetterTopic(deadLetterTopic).build());###dlpBuilder###DeadLetterPolicy.builder().maxRedeliverCount(RetryMessageUtil.MAX_RECONSUMETIMES).retryLetterTopic(retryLetterTopic)###127:17:131:51
fdbc5b2330ff1c99c899c7bcda89e6fb4c36aab2###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/lookup/TopicLookupBase.java###/TopicLookupBase.java###org.apache.pulsar.broker.lookup.TopicLookupBase###internalLookupTopicAsync:TopicName boolean AsyncResponse ###redirect=newURI(String.format("%s%s%s?authoritative=%s",redirectUrl,lookupPath,topicName.getLookupName(),newAuthoritative));###path###String.format("%s%s%s?authoritative=%s",redirectUrl,lookupPath,topicName.getLookupName(),newAuthoritative)###100:21:101:75
42241107dcf1f74a27a02297bc47901b3684b3cf###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/schema/SchemaTest.java###/SchemaTest.java###org.apache.pulsar.schema.SchemaTest###testMultiTopicSetSchemaProvider:###admin.schemas().createSchema(fqtnTwo,Schema.AVRO(SchemaDefinition.<Schemas.PersonTwo>builder().withAlwaysAllowNull(false).withSupportSchemaVersioning(true).withPojo(Schemas.PersonTwo.class).build()).getSchemaInfo());###personTwoSchema###Schema.AVRO(SchemaDefinition.<Schemas.PersonTwo>builder().withAlwaysAllowNull(false).withSupportSchemaVersioning(true).withPojo(Schemas.PersonTwo.class).build())###134:9:137:85
d055ebd1186ffae2d2af1382e05b21c60e9f9574###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/BrokerServiceAutoSubscriptionCreationTest.java###/BrokerServiceAutoSubscriptionCreationTest.java###org.apache.pulsar.broker.service.BrokerServiceAutoSubscriptionCreationTest###testAutoSubscriptionCreationNamespaceAllowOverridesBroker:###pulsar.getAdminClient().namespaces().setAutoSubscriptionCreation(topicName.getNamespace(),AutoSubscriptionCreationOverride.builder().allowAutoSubscriptionCreation(true).build());###autoSubscriptionCreationOverride###AutoSubscriptionCreationOverride.builder().allowAutoSubscriptionCreation(true).build()###101:9:104:35
7dcc2ae2eb80404cbd90cc0884839683c9b748ec###/apache_pulsar/pulsar-sql/presto-pulsar/src/main/java/org/apache/pulsar/sql/presto/PulsarSplitManager.java###/PulsarSplitManager.java###org.apache.pulsar.sql.presto.PulsarSplitManager###getSplitsNonPartitionedTopic:int TopicName PulsarTableHandle SchemaInfo TupleDomain<ColumnHandle> OffloadPolicies ###ManagedLedgerFactorymanagedLedgerFactory=PulsarConnectorCache.getConnectorCache(pulsarConnectorConfig).getManagedLedgerFactory();###pulsarConnectorCache###PulsarConnectorCache.getConnectorCache(pulsarConnectorConfig)###234:9:235:44
ee904063abc8ec90c3c536b28a47a59975175cd4###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/admin/AdminTest.java###/AdminTest.java###org.apache.pulsar.broker.admin.AdminTest###internalConfiguration:###InternalConfigurationDataexpectedData=newInternalConfigurationData(pulsar.getConfiguration().getZookeeperServers(),pulsar.getConfiguration().getConfigurationStoreServers(),newClientConfiguration().getZkLedgersRootPath(),pulsar.getMetadataServiceUri(),pulsar.getWorkerConfig().map(wc->wc.getStateStorageServiceUrl()).orElse(null));###conf###pulsar.getConfiguration()###185:9:190:94
bdc62ecac2a96b5ff657b5e70c306df81e3fe93d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryReleaseConnectionThrottle:###if((topicPublishRateLimiterOnMessage!=null&&topicPublishRateLimiterOnMessage.getAvailablePermits()<=0)||(topicPublishRateLimiterOnByte!=null&&topicPublishRateLimiterOnByte.getAvailablePermits()<=0))###currentTopicPublishRateLimiterOnMessage###topicPublishRateLimiterOnMessage###68:9:71:10
36c3bc3178a2e7b5d05b8eb0148242379896c63a###/apache_pulsar/pulsar-transaction/coordinator/src/main/java/org/apache/pulsar/transaction/coordinator/impl/MLTransactionMetadataStore.java###/MLTransactionMetadataStore.java###org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStore.MLTransactionMetadataStore.start.new Thread.replayAsync.new TransactionLogReplayCallback###handleMetadataEntry:Position TransactionMetadataEntry ###sequenceId.set(transactionMetadataEntry.getTxnidLeastBits());###txnSequenceId###transactionMetadataEntry.getTxnidLeastBits()###102:33:102:94
666ad3b13cbbf35c329fb3fd433f117d6d893e0a###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConsumerBase.java###/ConsumerBase.java###org.apache.pulsar.client.impl.ConsumerBase###increaseIncomingMessageSize:Message<?> ###INCOMING_MESSAGES_SIZE_UPDATER.addAndGet(this,message.size());###messageSize###message.size()###974:9:974:72
7792facfbff68e04273cc0aa32c3d25ea5f2d1d9###/apache_pulsar/pulsar-io/debezium/core/src/main/java/org/apache/pulsar/io/debezium/DebeziumSource.java###/DebeziumSource.java###org.apache.pulsar.io.debezium.DebeziumSource###open:Map<String,Object> SourceContext ###config.put(DatabaseHistory.CONFIGURATION_FIELD_PREFIX_STRING+"pulsar.client.builder",SerDeUtils.serialize(sourceContext.getPulsarClientBuilder()));###pulsarClientBuilder###SerDeUtils.serialize(sourceContext.getPulsarClientBuilder())###100:9:101:79
3d0ce3ac19abb4810a3fa410d292a49a9420d21d###/apache_pulsar/testmocks/src/main/java/org/apache/zookeeper/MockZooKeeper.java###/MockZooKeeper.java###org.apache.zookeeper.MockZooKeeper###setData:String byte[] int StatCallback Object ###intcurrentVersion=tree.get(path).getRight();###mockZNode###tree.get(path)###770:13:770:60
d2d5fb6e95e7c08db6d9d68ae168698d96a17807###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleGetOrCreateSchema:CommandGetOrCreateSchema ###commandSender.sendGetOrCreateSchemaErrorResponse(requestId,errorCode,ex.getMessage());###message###ex.getMessage()###1730:21:1730:109
0c6e809c1ba0d667dd1a0ef87f49eb5a38b631f6###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentDispatcherSingleActiveConsumer.java###/PersistentDispatcherSingleActiveConsumer.java###org.apache.pulsar.broker.service.persistent.PersistentDispatcherSingleActiveConsumer###readMoreEntries:Consumer ###cursor.asyncReadEntriesOrWait(messagesToRead,serviceConfig.getDispatcherMaxReadSizeBytes(),this,consumer);###bytesToRead###serviceConfig.getDispatcherMaxReadSizeBytes()###482:17:482:126
ca64c67acac41c34edf15ffa6ca8b5beac6f99ea###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/plugin/EntryFilterProvider.java###/EntryFilterProvider.java###org.apache.pulsar.broker.service.plugin.EntryFilterProvider###load:EntryFilterMetaData String ###NarClassLoaderncl=NarClassLoader.getFromArchive(metadata.getArchivePath().toAbsolutePath().toFile(),Collections.emptySet(),EntryFilter.class.getClassLoader(),narExtractionDirectory);###narFile###metadata.getArchivePath().toAbsolutePath().toFile()###124:9:127:77
1ff1fcdd7462586e7974485258166d1a990521fa###/apache_pulsar/pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java###/SinkConfigUtils.java###org.apache.pulsar.functions.utils.SinkConfigUtils###validateUpdate:SinkConfig SinkConfig ###mergedConfig.getInputSpecs().put(topicName,consumerConfig);###finalMergedConfig###mergedConfig###591:17:591:77
24f759c677bfe7cbb2228cab8a38f2ebd0893945###/apache_pulsar/pulsar-discovery-service/src/test/java/org/apache/pulsar/discovery/service/DiscoveryServiceTest.java###/DiscoveryServiceTest.java###org.apache.pulsar.discovery.service.DiscoveryServiceTest###testBrokerDiscoveryRoundRobin:###Stringcurrent=service.getDiscoveryProvider().nextBroker().getPulsarServiceUrl();###discoveryProvider###service.getDiscoveryProvider()###94:13:94:96
0c9fdd1f6fbda2061121f308293fb51223f474c3###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ClientCnx.java###/ClientCnx.java###org.apache.pulsar.client.impl.ClientCnx###handleSendReceipt:CommandSendReceipt ###producers.get(producerId).ackReceived(this,sequenceId,highestSequenceId,ledgerId,entryId);###producer###producers.get(producerId)###391:9:391:103
a6e66dd38bbb9edc552fe6877d0d600bd6d5506b###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/transaction/buffer/TransactionBufferClientTest.java###/TransactionBufferClientTest.java###org.apache.pulsar.broker.transaction.buffer.TransactionBufferClientTest###testTransactionBufferHandlerSemaphore:###tbClient.abortTxnOnSubscription(topic+"_abort_sub","test",1L,1L,-1L).get();###abortTopic###topic+"_abort_sub"###337:9:337:90
7001f64aab6335b5192b408dba1e85602dd5ea6b###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/Consumer.java###/Consumer.java###org.apache.pulsar.broker.service.Consumer###removePendingAcks:PositionImpl ###if(((addAndGetUnAckedMsgs(ackOwnedConsumer,-totalAckedMsgs)<=(maxUnackedMessages/2))&&ackOwnedConsumer.blockedConsumerOnUnackedMsgs)&&ackOwnedConsumer.shouldBlockConsumerOnUnackMsgs())###unAckedMsgs###addAndGetUnAckedMsgs(ackOwnedConsumer,-totalAckedMsgs)###694:13:699:14
e4b4627890b7deee6d3ea2b6f2e121f12586b2dd###/apache_pulsar/pulsar-io/kafka/src/main/java/org/apache/pulsar/io/kafka/AvroSchemaCache.java###/AvroSchemaCache.java###org.apache.pulsar.io.kafka.AvroSchemaCache###getBytes:ByteBuffer ###byte[]avroEncodedData=newbyte[buffer.remaining()];###remaining###buffer.remaining()###103:9:103:63
d1a6393cc3ee79718a924eec9071471537926e13###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/util/ExecutorProvider.java###/ExecutorProvider.java###org.apache.pulsar.client.util.ExecutorProvider###ExecutorProvider:int ThreadFactory ###executors.add(Executors.newSingleThreadScheduledExecutor(threadFactory));###executor###Executors.newSingleThreadScheduledExecutor(threadFactory)###48:13:48:86
5f9fd688feb2b4cb8fca3dbc86b923af088d7d86###/apache_pulsar/pulsar-io/debezium/core/src/main/java/org/apache/pulsar/io/debezium/DebeziumSource.java###/DebeziumSource.java###org.apache.pulsar.io.debezium.DebeziumSource###open:Map<String,Object> SourceContext ###config.put(DatabaseHistory.CONFIGURATION_FIELD_PREFIX_STRING+"pulsar.client.builder",SerDeUtils.serialize(sourceContext.getPulsarClientBuilder()));###pulsarClientBuilder###SerDeUtils.serialize(sourceContext.getPulsarClientBuilder())###101:9:102:79
c6beb35c428831cc53dfa10605d30f57d8743f02###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/systopic/TopicPoliciesSystemTopicClient.java###/TopicPoliciesSystemTopicClient.java###org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient.TopicPolicyWriter###deleteAsync:PulsarEvent ###returnproducer.newMessage().key(getEventKey(event)).value(null).sendAsync();###builder###producer.newMessage().key(getEventKey(event)).value(null)###101:13:101:90
72962742aecf953fffabfdcfacbdcbb70a1ebba2###/apache_pulsar/managed-ledger/src/test/java/org/apache/bookkeeper/mledger/impl/ManagedLedgerTest.java###/ManagedLedgerTest.java###org.apache.bookkeeper.mledger.impl.ManagedLedgerTest###asyncAddEntryWithoutError:###ledger.asyncAddEntry(bytes,newAddEntryCallback(){@OverridepublicvoidaddComplete(Positionposition,ByteBufentryData,Objectctx){assertNull(ctx);assertEquals(copyBytesFromByteBuf(entryData),bytes);try{entryData.array();}catch(Exceptione){assertTrue(einstanceofReadOnlyBufferException);}counter.countDown();}@OverridepublicvoidaddFailed(ManagedLedgerExceptionexception,Objectctx){fail(exception.getMessage());}},null);###callback###newAddEntryCallback(){@OverridepublicvoidaddComplete(Positionposition,ByteBufentryData,Objectctx){assertNull(ctx);assertEquals(copyBytesFromByteBuf(entryData),bytes);try{entryData.array();}catch(Exceptione){assertTrue(einstanceofReadOnlyBufferException);}counter.countDown();}@OverridepublicvoidaddFailed(ManagedLedgerExceptionexception,Objectctx){fail(exception.getMessage());}}###561:9:582:18
ded806fd52f6e2f182fa02052cbd82c2a6755098###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryAcquire:int long ###return(topicPublishRateLimiterOnMessage==null||topicPublishRateLimiterOnMessage.tryAcquire(numbers))&&(topicPublishRateLimiterOnByte==null||topicPublishRateLimiterOnByte.tryAcquire(bytes));###currentTopicPublishRateLimiterOnMessage###topicPublishRateLimiterOnMessage###108:9:109:111
9af857781fc3d357834eaa13acf45005f8186875###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java###/ConsumerImpl.java###org.apache.pulsar.client.impl.ConsumerImpl###ConsumerImpl:PulsarClientImpl String ConsumerConfigurationData<T> ExecutorService int boolean CompletableFuture<Consumer<T>> MessageId long Schema<T> ConsumerInterceptors<T> boolean ###this.deadLetterPolicy=DeadLetterPolicy.builder().maxRedeliverCount(conf.getDeadLetterPolicy().getMaxRedeliverCount()).deadLetterTopic(conf.getDeadLetterPolicy().getDeadLetterTopic()).build();###dlpBuilder###DeadLetterPolicy.builder().maxRedeliverCount(conf.getDeadLetterPolicy().getMaxRedeliverCount())###320:17:323:34
7f7eb9dcc32af158a808ec82a960c6f20ac1b90b###/apache_pulsar/managed-ledger/src/main/java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java###/ManagedLedgerImpl.java###org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl###getPreviousPosition:PositionImpl ###returnPositionImpl.get(headMap.firstEntry().getKey(),-1);###firstEntry###headMap.firstEntry()###3222:9:3222:68
bfae8f6d32c099740342767e77a777469ef6bd5f###/apache_pulsar/managed-ledger/src/main/java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java###/ManagedCursorImpl.java###org.apache.bookkeeper.mledger.impl.ManagedCursorImpl###persistPositionToLedger:LedgerHandle MarkDeleteEntry VoidCallback ###lh.asyncAddEntry(pi.toByteArray(),(rc,lh1,entryId,ctx)->{if(rc==BKException.Code.OK){if(log.isDebugEnabled()){log.debug("[{}]Updatedcursor{}position{}inmeta-ledger{}",ledger.getName(),name,position,lh1.getId());}if(shouldCloseLedger(lh1)){if(log.isDebugEnabled()){log.debug("[{}]Needtocreatenewmetadataledgerforconsumer{}",ledger.getName(),name);}startCreatingNewMetadataLedger();}mbean.persistToLedger(true);callback.operationComplete();}else{log.warn("[{}]Errorupdatingcursor{}position{}inmeta-ledger{}:{}",ledger.getName(),name,position,lh1.getId(),BKException.getMessage(rc));STATE_UPDATER.compareAndSet(ManagedCursorImpl.this,State.Open,State.NoLedger);mbean.persistToLedger(false);persistPositionMetaStore(-1,position,mdEntry.properties,newMetaStoreCallback<Void>(){@OverridepublicvoidoperationComplete(Voidresult,Statstat){if(log.isDebugEnabled()){log.debug("[{}][{}]Updatedcursorinmetastoreafterpreviousfailureinledgeratposition{}",ledger.getName(),name,position);}mbean.persistToZookeeper(true);callback.operationComplete();}@OverridepublicvoidoperationFailed(MetaStoreExceptione){log.warn("[{}][{}]Failedtoupdatecursorinmetastoreafterpreviousfailureinledger:{}",ledger.getName(),name,e.getMessage());mbean.persistToZookeeper(false);callback.operationFailed(createManagedLedgerException(rc));}},true);}},null);###data###pi.toByteArray()###2602:9:2648:18
42241107dcf1f74a27a02297bc47901b3684b3cf###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/schema/SchemaTest.java###/SchemaTest.java###org.apache.pulsar.schema.SchemaTest###testMultiTopicSetSchemaProvider:###Schemas.PersonTwopersonConsume=consumer.receive().getValue();###message###consumer.receive()###161:9:161:73
0469dfe2c7804bd9ca9ea34e95d83b2196216cf9###/apache_pulsar/pulsar-functions/runtime/src/test/java/org/apache/pulsar/functions/runtime/process/ProcessRuntimeTest.java###/ProcessRuntimeTest.java###org.apache.pulsar.functions.runtime.process.ProcessRuntimeTest###verifyJavaInstance:InstanceConfig Path ###assertEquals(args.size(),39);###totalArgCount###39###279:13:279:43
b5d219add8857a51be0a88fac6f957d0144d949c###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/RackAwareTest.java###/RackAwareTest.java###org.apache.pulsar.broker.service.RackAwareTest###testPlacement:###admin.bookies().updateBookieRackInfo(bookie,"default",bi);###group###"default"###105:13:105:73
ea628541950a2cd02746ef0cfce02528b7824fed###/apache_pulsar/pulsar-client-admin/src/main/java/org/apache/pulsar/client/admin/internal/TopicsImpl.java###/TopicsImpl.java###org.apache.pulsar.client.admin.internal.TopicsImpl###getIndividualMsgsFromBatch:String String byte[] Map<String,String> MessageMetadata ###ret.add(newMessageImpl<>(topic,batchMsgId,properties,singleMessagePayload,Schema.BYTES,msgMetadataBuilder));###message###newMessageImpl<>(topic,batchMsgId,properties,singleMessagePayload,Schema.BYTES,msgMetadataBuilder)###1573:17:1574:60
490b2be8f3c2c9594ce459e073a6491fe96069a5###/apache_pulsar/pulsar-zookeeper-utils/src/test/java/org/apache/pulsar/zookeeper/ZkBookieRackAffinityMappingTest.java###/ZkBookieRackAffinityMappingTest.java###org.apache.pulsar.zookeeper.ZkBookieRackAffinityMappingTest###testBookieInfoChange:###localZkc.setData(ZkBookieRackAffinityMapping.BOOKIE_INFO_ROOT_PATH,jsonMapper.writeValueAsBytes(bookieMapping),-1);###data###jsonMapper.writeValueAsBytes(bookieMapping)###174:9:175:21
ded806fd52f6e2f182fa02052cbd82c2a6755098###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryReleaseConnectionThrottle:###if((topicPublishRateLimiterOnMessage!=null&&topicPublishRateLimiterOnMessage.getAvailablePermits()<=0)||(topicPublishRateLimiterOnByte!=null&&topicPublishRateLimiterOnByte.getAvailablePermits()<=0))###currentTopicPublishRateLimiterOnMessage###topicPublishRateLimiterOnMessage###67:9:70:10
c6beb35c428831cc53dfa10605d30f57d8743f02###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/SystemTopicBasedTopicPoliciesService.java###/SystemTopicBasedTopicPoliciesService.java###org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService###refreshTopicPoliciesCache:Message<PulsarEvent> ###policiesCache.remove(TopicName.get(TopicName.get(msg.getKey()).getPartitionedTopicName()));###topicName###TopicName.get(TopicName.get(msg.getKey()).getPartitionedTopicName())###377:13:377:104
a50fe878773a76ca974d1af6ea8b994a5df7f81a###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/transaction/buffer/TransactionBufferClientTest.java###/TransactionBufferClientTest.java###org.apache.pulsar.broker.transaction.buffer.TransactionBufferClientTest###afterSetup:###pulsarClient.newConsumer().topic(partitionedTopicName.getPartitionedTopicName()).subscriptionName("test").subscribe();###subName###"test"###93:9:95:55
c1c0ef50ac58568a00c61d7862dd7ac1f0b70438###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java###/PulsarClientImpl.java###org.apache.pulsar.client.impl.PulsarClientImpl###closeAsync:###FutureUtil.waitForAll(futures).thenRun(()->newThread(()->{try{shutdown();closeFuture.complete(null);state.set(State.Closed);}catch(PulsarClientExceptione){closeFuture.completeExceptionally(e);}},"pulsar-client-shutdown-thread").start()).exceptionally(exception->{closeFuture.completeExceptionally(exception);returnnull;});###combinedFuture###FutureUtil.waitForAll(futures)###720:9:732:12
c14d079fa992d308e5ae04f7e7d0b9ada4f28cac###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleAddSubscriptionToTxn:CommandAddSubscriptionToTxn ###service.pulsar().getTransactionMetadataStoreService().addAckedPartitionToTxn(txnID,MLTransactionMetadataStore.subscriptionToTxnSubscription(command.getSubscriptionsList())).whenComplete(((v,ex)->{if(ex==null){if(log.isDebugEnabled()){log.debug("Sendresponsesuccessforaddpublishedpartitiontotxnrequest{}",requestId);}ctx.writeAndFlush(Commands.newAddSubscriptionToTxnResponse(requestId,txnID.getLeastSigBits(),txnID.getMostSigBits()));log.info("handleaddpartitiontotxnfinish.");}else{if(log.isDebugEnabled()){log.debug("Sendresponseerrorforaddpublishedpartitiontotxnrequest{}",requestId,ex);}ctx.writeAndFlush(Commands.newAddSubscriptionToTxnResponse(requestId,txnID.getMostSigBits(),BrokerServiceException.getClientErrorCode(ex),ex.getMessage()));}}));###transactionMetadataStoreService###service.pulsar().getTransactionMetadataStoreService()###2201:9:2221:21
d81b5f8b8e6cb17f307ec830accaf9dd95d7643b###/apache_pulsar/pulsar-common/src/main/java/org/apache/pulsar/common/protocol/schema/SchemaInfoUtil.java###/SchemaInfoUtil.java###org.apache.pulsar.common.protocol.schema.SchemaInfoUtil###newSchemaInfo:Schema ###si.setProperties(newTreeMap<>());###properties###newTreeMap<>()###54:13:54:47
36a45ee89639bf66a12de23e415d80451deaa4e0###/apache_pulsar/testmocks/src/main/java/org/apache/zookeeper/MockZooKeeper.java###/MockZooKeeper.java###org.apache.zookeeper.MockZooKeeper###setData:String byte[] int StatCallback Object ###intcurrentVersion=tree.get(path).getRight();###mockZNode###tree.get(path)###752:13:752:60
80171a733ab4799f912a8935f03c19554b9ca3b1###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/BacklogQuotaManager.java###/BacklogQuotaManager.java###org.apache.pulsar.broker.service.BacklogQuotaManager###BacklogQuotaManager:PulsarService ###this.defaultQuota=BacklogQuotaImpl.builder().limitSize(pulsar.getConfiguration().getBacklogQuotaDefaultLimitGB()*BacklogQuotaImpl.BYTES_IN_GIGABYTE).limitTime(pulsar.getConfiguration().getBacklogQuotaDefaultLimitSecond()).retentionPolicy(pulsar.getConfiguration().getBacklogQuotaDefaultRetentionPolicy()).build();###backlogQuotaGB###pulsar.getConfiguration().getBacklogQuotaDefaultLimitGB()###56:9:61:26
ed935a75e9309cf7f52507095153947ccec8f82c###/apache_pulsar/pulsar-common/src/main/java/org/apache/pulsar/common/protocol/schema/SchemaHash.java###/SchemaHash.java###org.apache.pulsar.common.protocol.schema.SchemaHash###of:Schema ###returnof(Optional.ofNullable(schema).map(Schema::getSchemaInfo).map(SchemaInfo::getSchema).orElse(newbyte[0]));###schemaInfo###Optional.ofNullable(schema).map(Schema::getSchemaInfo)###44:9:46:76
b21e548dff0bfd98cc8a65bf9598674430d3a8b0###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ProducerImpl.java###/ProducerImpl.java###org.apache.pulsar.client.impl.ProducerImpl###run:Timeout ###PulsarClientExceptionte=newPulsarClientException.TimeoutException(format("Theproducer%scannotsendmessagetothetopic%swithingiventimeout",producerName,topic),firstMsg.sequenceId);###msg###format("Theproducer%scannotsendmessagetothetopic%swithingiventimeout",producerName,topic)###1929:21:1931:72
58c281811b01dfc2bcf1906865964badbee4a952###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/namespace/NamespaceService.java###/NamespaceService.java###org.apache.pulsar.broker.namespace.NamespaceService###isServiceUnitActive:TopicName ###returnownershipCache.getOwnedBundle(getBundle(topicName)).isActive();###ownedBundle###ownershipCache.getOwnedBundle(getBundle(topicName))###983:13:983:83
561f8cf9ed473625441df5b678cbdb29d241268b###/apache_pulsar/pulsar-testclient/src/main/java/org/apache/pulsar/testclient/PerformanceTransaction.java###/PerformanceTransaction.java###org.apache.pulsar.testclient.PerformanceTransaction###main:String[] ###PulsarClientclient=PulsarClient.builder().enableTransaction(!arguments.isDisableTransaction).serviceUrl(arguments.serviceURL).connectionsPerBroker(arguments.maxConnections).statsInterval(0,TimeUnit.SECONDS).ioThreads(arguments.ioThreads).build();###clientBuilder###PulsarClient.builder().enableTransaction(!arguments.isDisableTransaction).serviceUrl(arguments.serviceURL).connectionsPerBroker(arguments.maxConnections).statsInterval(0,TimeUnit.SECONDS).ioThreads(arguments.ioThreads)###273:9:279:34
a6e66dd38bbb9edc552fe6877d0d600bd6d5506b###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/transaction/buffer/TransactionBufferClientTest.java###/TransactionBufferClientTest.java###org.apache.pulsar.broker.transaction.buffer.TransactionBufferClientTest###testTransactionBufferLookUp:###tbClient.abortTxnOnSubscription(topic+"_abort_sub","test",1L,1L,-1L).get();###abortTopic###topic+"_abort_sub"###319:9:319:90
fe7cf676e59e08b34b388fce3a190133d390d61c###/apache_pulsar/pulsar-client/src/test/java/org/apache/pulsar/client/impl/MessageImplTest.java###/MessageImplTest.java###org.apache.pulsar.client.impl.MessageImplTest###testMessageBrokerAndEntryMetadataTimestampMissed:###brokerMetadata=newBrokerEntryMetadata().setBrokerTimestamp(System.currentTimeMillis()).setIndex(MOCK_BATCH_SIZE-1);###brokerEntryTimestamp###System.currentTimeMillis()###466:13:468:52
341ac715aa7a9184988064c6089d89a35df5c07f###/apache_pulsar/pulsar-proxy/src/main/java/org/apache/pulsar/proxy/server/ProxyServiceStarter.java###/ProxyServiceStarter.java###org.apache.pulsar.proxy.server.ProxyServiceStarter###addWebServerHandlers:WebServer ProxyConfiguration ProxyService BrokerDiscoveryProvider ###WebSocketServicewebSocketService=newWebSocketService(createClusterData(config),PulsarConfigurationLoader.convertFrom(config));###serviceConfiguration###PulsarConfigurationLoader.convertFrom(config)###235:13:235:144
0994254c24be4aec8fef810bcdbf62e06453fe53###/apache_pulsar/pulsar-transaction/coordinator/src/test/java/org/apache/pulsar/transaction/coordinator/MLTransactionMetadataStoreTest.java###/MLTransactionMetadataStoreTest.java###org.apache.pulsar.transaction.coordinator.MLTransactionMetadataStoreTest###testRecoverWhenDeleteFromCursor:###MLTransactionLogImplmlTransactionLog=newMLTransactionLogImpl(transactionCoordinatorID,factory,newManagedLedgerConfig());###managedLedgerConfig###newManagedLedgerConfig()###354:9:355:44
fe90b2c52a0d0ee0519c5fe8ae0e07373a010367###/apache_pulsar/pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/FunctionsStatsGenerator.java###/FunctionsStatsGenerator.java###org.apache.pulsar.functions.worker.FunctionsStatsGenerator###generate:PulsarWorkerService SimpleTextOutputStream ###out.write(functionRuntime.getPrometheusMetrics());###prometheusMetrics###functionRuntime.getPrometheusMetrics()###71:29:71:79
24e79d0f386861196210693e39d3a77c060a15ee###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java###/PersistentTopicsBase.java###org.apache.pulsar.broker.admin.impl.PersistentTopicsBase###internalRemoveSubscriptionDispatchRate:###op.get().setSubscriptionDispatchRate(null);###topicPolicies###op.get()###4181:17:4181:60
38539b351869b829c99a2b96354ce852f137015d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/namespace/NamespaceService.java###/NamespaceService.java###org.apache.pulsar.broker.namespace.NamespaceService###createLookupResult:String boolean String ###lookupFuture.complete(newLookupResult(lookupData.getWebServiceUrl(),lookupData.getWebServiceUrlTls(),listener.getBrokerServiceUrl().toString(),urlTls==null?null:urlTls.toString(),authoritativeRedirect));###url###listener.getBrokerServiceUrl()###600:29:602:104
602137fa1b87bf3fdb7a99f7fc096d77c0fe40f4###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/io/PulsarFunctionE2ETest.java###/PulsarFunctionE2ETest.java###org.apache.pulsar.io.PulsarFunctionE2ETest###testPulsarSinkDLQ:###producer.newMessage().property(propertyKey,propertyValue).value("fail"+i).sendAsync();###messageBody###"fail"+i###774:13:774:102
ebad71aed7991e4494f81cf1980408f5bbff980a###/apache_pulsar/pulsar-io/kafka-connect-adaptor/src/test/java/org/apache/pulsar/io/kafka/connect/KafkaConnectSinkTest.java###/KafkaConnectSinkTest.java###org.apache.pulsar.io.kafka.connect.KafkaConnectSinkTest###bytesRecordSchemaTest:###recordSchemaTest("val".getBytes(StandardCharsets.US_ASCII),Schema.BYTES,"val","BYTES");###in###"val".getBytes(StandardCharsets.US_ASCII)###292:9:292:99
0994254c24be4aec8fef810bcdbf62e06453fe53###/apache_pulsar/pulsar-transaction/coordinator/src/test/java/org/apache/pulsar/transaction/coordinator/MLTransactionMetadataStoreTest.java###/MLTransactionMetadataStoreTest.java###org.apache.pulsar.transaction.coordinator.MLTransactionMetadataStoreTest###testDeleteLog:###MLTransactionLogImplmlTransactionLog=newMLTransactionLogImpl(transactionCoordinatorID,factory,newManagedLedgerConfig());###managedLedgerConfig###newManagedLedgerConfig()###291:9:292:44
dd32435399d8bef89206a00f0c52ed565af46cf5###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/client/api/BrokerServiceLookupTest.java###/BrokerServiceLookupTest.java###org.apache.pulsar.client.api.BrokerServiceLookupTest###testDiscoveryLookupAuthorizationFailure:###doReturn(newZKMetadataStore(mockZooKeeper)).when(discoveryService).createLocalMetadataStore();###localMetadatastore###newZKMetadataStore(mockZooKeeper)###757:9:757:104
a64014627bcdce0a1584b592ee942435e119a2a7###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/transaction/pendingack/impl/PendingAckHandleImpl.java###/PendingAckHandleImpl.java###org.apache.pulsar.broker.transaction.pendingack.impl.PendingAckHandleImpl###individualAckAbortCommon:TxnID HashMap<PositionImpl,PositionImpl> ###thisBitSet.flip(0,individualAckPositions.get(entry.getValue()).right);###batchSize###individualAckPositions.get(entry.getValue()).right###677:17:677:88
74b5d505554ea75c81cd004c3e5b61af094848bf###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/UnAckedTopicMessageTracker.java###/UnAckedTopicMessageTracker.java###org.apache.pulsar.client.impl.UnAckedTopicMessageTracker###removeTopicMessages:String ###MessageIdmessageId=iterator.next();###entry###iterator.next()###42:17:42:55
9ecd613c0fdaf7f5306fc7f633a4d12218a7a4d2###/apache_pulsar/pulsar-broker-common/src/main/java/org/apache/pulsar/broker/web/plugin/servlet/AdditionalServlets.java###/AdditionalServlets.java###org.apache.pulsar.broker.web.plugin.servlet.AdditionalServlets###load:PulsarConfiguration ###servletWithClassLoader=AdditionalServletUtils.load(definition,conf.getProperties().getProperty(NAR_EXTRACTION_DIRECTORY));###narExtractionDirectory###conf.getProperties().getProperty(NAR_EXTRACTION_DIRECTORY)###94:17:95:85
720b1d52cf2a530514de67b6a7ab33d3d377de54###/apache_pulsar/pulsar-functions/instance/src/main/java/org/apache/pulsar/functions/instance/ContextImpl.java###/ContextImpl.java###org.apache.pulsar.functions.instance.ContextImpl###ContextImpl:InstanceConfig Logger PulsarClient SecretsProvider FunctionCollectorRegistry String[] Function.FunctionDetails.ComponentType ComponentStatsManager StateManager PulsarAdmin ###this.producerBuilder.maxPendingMessages(config.getFunctionDetails().getSink().getProducerSpec().getMaxPendingMessages());###producerSpec###config.getFunctionDetails().getSink().getProducerSpec()###148:17:148:138
33436f6628af96c3d5e6cec7b91d90be9041efbd###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentTopic.java###/PersistentTopic.java###org.apache.pulsar.broker.service.persistent.PersistentTopic###initializeDispatchRateLimiterIfNeeded:Optional<Policies> ###if(!subscribeRateLimiter.isPresent()&&SubscribeRateLimiter.isDispatchRateNeeded(brokerService,policies,topic))###isDispatchRateNeeded###SubscribeRateLimiter.isDispatchRateNeeded(brokerService,policies,topic)###369:13:372:14
8f1f5ba4fd8ecbab1f975623605400f5088c6e32###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/nonpersistent/NonPersistentTopic.java###/NonPersistentTopic.java###org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic###checkGC:###log.debug("[{}]Didnotdeletebusytopic:{}",topic,e.getCause().getMessage());###throwable###e.getCause()###849:41:850:76
c3e65ea55af813571722d082126ecb295cac4355###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/PulsarService.java###/PulsarService.java###org.apache.pulsar.broker.PulsarService###closeAsync:###asyncCloseFutures.add(this.brokerService.closeAsync());###brokerCloseFuture###this.brokerService.closeAsync()###429:17:429:72
ca64c67acac41c34edf15ffa6ca8b5beac6f99ea###/apache_pulsar/pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/service/WorkerServiceLoader.java###/WorkerServiceLoader.java###org.apache.pulsar.functions.worker.service.WorkerServiceLoader###load:WorkerServiceMetadata String ###NarClassLoaderncl=NarClassLoader.getFromArchive(metadata.getArchivePath().toAbsolutePath().toFile(),Collections.emptySet(),WorkerService.class.getClassLoader(),narExtractionDirectory);###narFile###metadata.getArchivePath().toAbsolutePath().toFile()###75:9:78:75
a47faa4de5f23f256173decee928a5c8d39db006###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleNewTxn:CommandNewTxn ###service.pulsar().getTransactionMetadataStoreService().newTransaction(tcId,command.getTxnTtlSeconds()).whenComplete(((txnID,ex)->{if(ex==null){if(log.isDebugEnabled()){log.debug("Sendresponse{}fornewtxnrequest{}",tcId.getId(),requestId);}ctx.writeAndFlush(Commands.newTxnResponse(requestId,txnID.getLeastSigBits(),txnID.getMostSigBits()));}else{if(log.isDebugEnabled()){log.debug("Sendresponseerrorfornewtxnrequest{}",requestId,ex);}ctx.writeAndFlush(Commands.newTxnResponse(requestId,tcId.getId(),BrokerServiceException.getClientErrorCode(ex),ex.getMessage()));}}));###transactionMetadataStoreService###service.pulsar().getTransactionMetadataStoreService()###1792:9:1807:17
0a2c89596824370454bce9716bab3e27fe4f3f99###/apache_pulsar/pulsar-metadata/src/main/java/org/apache/pulsar/metadata/cache/impl/MetadataCacheImpl.java###/MetadataCacheImpl.java###org.apache.pulsar.metadata.cache.impl.MetadataCacheImpl###readValueFromStore:String ###returnFutureUtils.value(Optional.of(newCacheGetResult<>(obj,optRes.get().getStat())));###res###optRes.get()###106:25:107:104
2439eda30fe08978f4254d3698972374155852b0###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleEndTxnOnPartition:CommandEndTxnOnPartition ###optionalTopic.get().endTxn(txnID,txnAction,command.getTxnidLeastBitsOfLowWatermark()).whenComplete((ignored,throwable)->{if(throwable!=null){log.error("HandleendTxnOnPartition{}failed.",topic,throwable);ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,BrokerServiceException.getClientErrorCode(throwable),throwable.getMessage()));return;}ctx.writeAndFlush(Commands.newEndTxnOnPartitionResponse(requestId,txnID.getLeastSigBits(),txnID.getMostSigBits()));});###lowWaterMark###command.getTxnidLeastBitsOfLowWatermark()###2000:17:2011:28
00f8e570b896218569ac29c9e04132031bc0360e###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/SystemTopicBasedTopicPoliciesService.java###/SystemTopicBasedTopicPoliciesService.java###org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService###refreshTopicPoliciesCache:Message<PulsarEvent> ###policiesCache.put(TopicName.get(event.getDomain(),event.getTenant(),event.getNamespace(),event.getTopic()),event.getPolicies());###topicName###TopicName.get(event.getDomain(),event.getTenant(),event.getNamespace(),event.getTopic())###305:13:308:15
887d74f902211e39a38257b9f3099d2acd777418###/apache_pulsar/pulsar-proxy/src/main/java/org/apache/pulsar/proxy/server/ProxyServiceStarter.java###/ProxyServiceStarter.java###org.apache.pulsar.proxy.server.ProxyServiceStarter###addWebServerHandlers:WebServer ProxyConfiguration ProxyService BrokerDiscoveryProvider ###WebSocketServicewebSocketService=newWebSocketService(createClusterData(config),PulsarConfigurationLoader.convertFrom(config));###serviceConfiguration###PulsarConfigurationLoader.convertFrom(config)###236:13:236:144
dd32435399d8bef89206a00f0c52ed565af46cf5###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/client/api/BrokerServiceLookupTest.java###/BrokerServiceLookupTest.java###org.apache.pulsar.client.api.BrokerServiceLookupTest###testDiscoveryLookupAuthorizationFailure:###doReturn(newZKMetadataStore(mockZooKeeperGlobal)).when(discoveryService).createConfigurationMetadataStore();###configMetadatastore###newZKMetadataStore(mockZooKeeperGlobal)###758:9:758:118
b923af16f629bf298ee2e8fec44864a2c8a2615b###/apache_pulsar/pulsar-functions/instance/src/main/java/org/apache/pulsar/functions/instance/ContextImpl.java###/ContextImpl.java###org.apache.pulsar.functions.instance.ContextImpl###ContextImpl:InstanceConfig Logger PulsarClient SecretsProvider FunctionCollectorRegistry String[] Function.FunctionDetails.ComponentType ComponentStatsManager StateManager PulsarAdmin ClientBuilder ###this.producerBuilder.maxPendingMessages(config.getFunctionDetails().getSink().getProducerSpec().getMaxPendingMessages());###producerSpec###config.getFunctionDetails().getSink().getProducerSpec()###151:17:151:138
ce6fdabf8ed1b79ade470e068efd7f26d54f8983###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/transaction/buffer/TransactionBufferClientTest.java###/TransactionBufferClientTest.java###org.apache.pulsar.broker.transaction.buffer.TransactionBufferClientTest###testTransactionBufferClientTimeout:###when(mockClient.getConnection(anyString())).thenReturn(newCompletableFuture<>());###completableFuture###newCompletableFuture<>()###228:9:228:91
bdc62ecac2a96b5ff657b5e70c306df81e3fe93d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryAcquire:int long ###return(topicPublishRateLimiterOnMessage==null||topicPublishRateLimiterOnMessage.tryAcquire(numbers))&&(topicPublishRateLimiterOnByte==null||topicPublishRateLimiterOnByte.tryAcquire(bytes));###currentTopicPublishRateLimiterOnByte###topicPublishRateLimiterOnByte###109:9:110:108
bdc62ecac2a96b5ff657b5e70c306df81e3fe93d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryAcquire:int long ###return(topicPublishRateLimiterOnMessage==null||topicPublishRateLimiterOnMessage.tryAcquire(numbers))&&(topicPublishRateLimiterOnByte==null||topicPublishRateLimiterOnByte.tryAcquire(bytes));###currentTopicPublishRateLimiterOnMessage###topicPublishRateLimiterOnMessage###109:9:110:108
490b2be8f3c2c9594ce459e073a6491fe96069a5###/apache_pulsar/pulsar-zookeeper-utils/src/test/java/org/apache/pulsar/zookeeper/ZkIsolatedBookieEnsemblePlacementPolicyTest.java###/ZkIsolatedBookieEnsemblePlacementPolicyTest.java###org.apache.pulsar.zookeeper.ZkIsolatedBookieEnsemblePlacementPolicyTest###testBookieInfoChange:###localZkc.setData(ZkBookieRackAffinityMapping.BOOKIE_INFO_ROOT_PATH,jsonMapper.writeValueAsBytes(bookieMapping),-1);###data2###jsonMapper.writeValueAsBytes(bookieMapping)###259:9:260:21
7058d771b4403f7e6d0036cc71691c562c745131###/apache_pulsar/pulsar-metadata/src/test/java/org/apache/pulsar/metadata/CounterTest.java###/CounterTest.java###org.apache.pulsar.metadata.CounterTest###testCounterDoesNotAutoReset:String Supplier<String> ###MetadataStoreExtendedstore1=MetadataStoreExtended.create(urlSupplier.get(),MetadataStoreConfig.builder().build());###metadataUrl###urlSupplier.get()###62:9:63:56
38539b351869b829c99a2b96354ce852f137015d###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/namespace/NamespaceService.java###/NamespaceService.java###org.apache.pulsar.broker.namespace.NamespaceService###findBrokerServiceUrl:NamespaceBundle LookupOptions ###future.complete(Optional.of(newLookupResult(nsData.get(),listener.getBrokerServiceUrl().toString(),urlTls==null?null:urlTls.toString())));###url###listener.getBrokerServiceUrl()###419:29:421:82
47c7cd9afedefa6831e75198ec806731e5c1c8e2###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java###/PersistentTopicsBase.java###org.apache.pulsar.broker.admin.impl.PersistentTopicsBase###internalRemoveDispatchRate:###op.get().setDispatchRate(null);###topicPolicies###op.get()###4132:17:4132:48
0a2c89596824370454bce9716bab3e27fe4f3f99###/apache_pulsar/pulsar-metadata/src/main/java/org/apache/pulsar/metadata/cache/impl/MetadataCacheImpl.java###/MetadataCacheImpl.java###org.apache.pulsar.metadata.cache.impl.MetadataCacheImpl###readModifyUpdateOrCreate:String Function<Optional<T>,T> ###expectedVersion=optEntry.get().getStat().getVersion();###entry###optEntry.get()###152:25:152:81
490b2be8f3c2c9594ce459e073a6491fe96069a5###/apache_pulsar/pulsar-zookeeper-utils/src/test/java/org/apache/pulsar/zookeeper/ZkIsolatedBookieEnsemblePlacementPolicyTest.java###/ZkIsolatedBookieEnsemblePlacementPolicyTest.java###org.apache.pulsar.zookeeper.ZkIsolatedBookieEnsemblePlacementPolicyTest###testBasic:###localZkc.setData(ZkBookieRackAffinityMapping.BOOKIE_INFO_ROOT_PATH,jsonMapper.writeValueAsBytes(bookieMapping),-1);###data###jsonMapper.writeValueAsBytes(bookieMapping)###144:9:145:21
68b0ca4abd001fcfef267b6dc18da26a2bbd19ed###/apache_pulsar/pulsar-client-admin/src/main/java/org/apache/pulsar/client/admin/internal/TopicsImpl.java###/TopicsImpl.java###org.apache.pulsar.client.admin.internal.TopicsImpl###getIndividualMsgsFromBatch:String String byte[] Map<String,String> MessageMetadata ###ret.add(newMessageImpl<>(topic,batchMsgId,properties,singleMessagePayload,Schema.BYTES,msgMetadataBuilder));###message###newMessageImpl<>(topic,batchMsgId,properties,singleMessagePayload,Schema.BYTES,msgMetadataBuilder)###1535:17:1536:60
d2d5fb6e95e7c08db6d9d68ae168698d96a17807###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleProducer:CommandProducer ###commandSender.sendErrorResponse(requestId,BrokerServiceException.getClientErrorCode(exception),exception.getMessage());###message###exception.getMessage()###1170:33:1172:65
d055ebd1186ffae2d2af1382e05b21c60e9f9574###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/service/BrokerServiceAutoTopicCreationTest.java###/BrokerServiceAutoTopicCreationTest.java###org.apache.pulsar.broker.service.BrokerServiceAutoTopicCreationTest###testAutoCreationNamespaceAllowOverridesBroker:###pulsar.getAdminClient().namespaces().setAutoTopicCreation(topicName.getNamespace(),AutoTopicCreationOverride.builder().allowAutoTopicCreation(true).topicType(TopicType.NON_PARTITIONED.toString()).build());###autoTopicCreationOverride###AutoTopicCreationOverride.builder().allowAutoTopicCreation(true).topicType(TopicType.NON_PARTITIONED.toString()).build()###171:9:175:35
daed6a0b3ac94e77a3d7d4212ee297b9046317a2###/apache_pulsar/pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/FunctionsStatsGenerator.java###/FunctionsStatsGenerator.java###org.apache.pulsar.functions.worker.FunctionsStatsGenerator###generate:PulsarWorkerService SimpleTextOutputStream ###out.write(functionRuntime.getPrometheusMetrics());###prometheusMetrics###functionRuntime.getPrometheusMetrics()###70:29:70:79
2439eda30fe08978f4254d3698972374155852b0###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleEndTxnOnSubscription:CommandEndTxnOnSubscription ###CompletableFuture<Void>completableFuture=subscription.endTxn(txnidMostBits,txnidLeastBits,txnAction,command.getTxnidLeastBitsOfLowWatermark());###lowWaterMark###command.getTxnidLeastBitsOfLowWatermark()###2063:17:2065:76
3289ff9a57dc0381791f5cda5e68351a9f79c1df###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentTopic.java###/PersistentTopic.java###org.apache.pulsar.broker.service.persistent.PersistentTopic###getInternalStats:boolean ###brokerService.getPulsar().getBookKeeperClient().getLedgerMetadata(ledgerId).thenAccept(metadata->{LedgerInfoschemaLedgerInfo=newLedgerInfo();schemaLedgerInfo.ledgerId=metadata.getLedgerId();schemaLedgerInfo.entries=metadata.getLastEntryId()+1;schemaLedgerInfo.size=metadata.getLength();if(includeLedgerMetadata){info.metadata=metadata.toSafeString();}stats.schemaLedgers.add(schemaLedgerInfo);completableFuture.complete(null);}).exceptionally(e->{completableFuture.completeExceptionally(e);returnnull;});###metadataFuture###brokerService.getPulsar().getBookKeeperClient().getLedgerMetadata(ledgerId)###1787:29:1802:32
ca64c67acac41c34edf15ffa6ca8b5beac6f99ea###/apache_pulsar/pulsar-broker-common/src/main/java/org/apache/pulsar/broker/web/plugin/servlet/AdditionalServletUtils.java###/AdditionalServletUtils.java###org.apache.pulsar.broker.web.plugin.servlet.AdditionalServletUtils###load:AdditionalServletMetadata String ###NarClassLoaderncl=NarClassLoader.getFromArchive(metadata.getArchivePath().toAbsolutePath().toFile(),Collections.emptySet(),AdditionalServlet.class.getClassLoader(),narExtractionDirectory);###narFile###metadata.getArchivePath().toAbsolutePath().toFile()###121:9:124:83
0994254c24be4aec8fef810bcdbf62e06453fe53###/apache_pulsar/pulsar-transaction/coordinator/src/test/java/org/apache/pulsar/transaction/coordinator/MLTransactionMetadataStoreTest.java###/MLTransactionMetadataStoreTest.java###org.apache.pulsar.transaction.coordinator.MLTransactionMetadataStoreTest###testManageLedgerWriteFailState:###MLTransactionLogImplmlTransactionLog=newMLTransactionLogImpl(transactionCoordinatorID,factory,newManagedLedgerConfig());###managedLedgerConfig###newManagedLedgerConfig()###390:9:391:44
602137fa1b87bf3fdb7a99f7fc096d77c0fe40f4###/apache_pulsar/pulsar-client-admin/src/main/java/org/apache/pulsar/client/admin/internal/PackagesImpl.java###/PackagesImpl.java###org.apache.pulsar.client.admin.internal.PackagesImpl###download:String String ###throw(PulsarAdminException)e.getCause();###cause###e.getCause()###163:13:163:55
c643a8a7fb3cd82da6777fd413dea4a7b5c84c4f###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/io/PulsarFunctionE2ETest.java###/PulsarFunctionE2ETest.java###org.apache.pulsar.io.PulsarFunctionE2ETest###testPulsarSinkDLQ:###producer.newMessage().property(propertyKey,propertyValue).value("fail"+i).sendAsync();###messageBody###"fail"+i###702:13:702:102
74b5d505554ea75c81cd004c3e5b61af094848bf###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/UnAckedMessageTracker.java###/UnAckedMessageTracker.java###org.apache.pulsar.client.impl.UnAckedMessageTracker###removeMessagesTill:MessageId ###MessageIdmessageId=iterator.next();###entry###iterator.next()###233:17:233:55
403b57a8bc56e1715b08d974847c82242729bb34###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/admin/AdminApiTest.java###/AdminApiTest.java###org.apache.pulsar.broker.admin.AdminApiTest###partitionedTopics:String ###assertEquals(admin.topics().getPartitionedTopicList("prop-xyz/ns1"),Lists.newArrayList());###namespace###"prop-xyz/ns1"###874:9:874:100
a6e66dd38bbb9edc552fe6877d0d600bd6d5506b###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java###/ServerCnx.java###org.apache.pulsar.broker.service.ServerCnx###handleEndTxnOnSubscription:CommandEndTxnOnSubscription ###CompletableFuture<Void>completableFuture=subscription.endTxn(txnidMostBits,txnidLeastBits,txnAction,command.getTxnidLeastBitsOfLowWatermark());###lowWaterMark###command.getTxnidLeastBitsOfLowWatermark()###2080:17:2082:76
0738a0823c827144329a168fc9ed08af3a1e174c###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java###/PersistentTopicsBase.java###org.apache.pulsar.broker.admin.impl.PersistentTopicsBase###internalRemoveCompactionThreshold:###op.get().setCompactionThreshold(null);###topicPolicies###op.get()###4261:17:4261:55
903494b932b03b91c1f9e98b5b9c1c14c4e9773b###/apache_pulsar/pulsar-metadata/src/main/java/org/apache/pulsar/metadata/impl/ZKMetadataStore.java###/ZKMetadataStore.java###org.apache.pulsar.metadata.impl.ZKMetadataStore###storePut:String byte[] Optional<Long> EnumSet<CreateOption> ###ZkUtils.asyncCreateFullPathOptimistic(zkc,path,value,ZooDefs.Ids.OPEN_ACL_UNSAFE,getCreateMode(options),(rc,path1,ctx,name)->{executor.execute(()->{Codecode=Code.get(rc);if(code==Code.OK){future.complete(newStat(name,0,0,0));}elseif(code==Code.NODEEXISTS){future.completeExceptionally(getException(Code.BADVERSION,path));}else{future.completeExceptionally(getException(code,path));}});},null);###createMode###getCreateMode(options)###209:17:222:34
d3c44ba8d1b0fad7518077708f6211dd10925878###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/broker/stats/ConsumerStatsTest.java###/ConsumerStatsTest.java###org.apache.pulsar.broker.stats.ConsumerStatsTest###testConsumerStatsOutput:###Stringfield=node.fieldNames().next();###itr###node.fieldNames()###212:13:212:53
0994254c24be4aec8fef810bcdbf62e06453fe53###/apache_pulsar/pulsar-transaction/coordinator/src/test/java/org/apache/pulsar/transaction/coordinator/MLTransactionMetadataStoreTest.java###/MLTransactionMetadataStoreTest.java###org.apache.pulsar.transaction.coordinator.MLTransactionMetadataStoreTest###testTransactionOperation:###MLTransactionLogImplmlTransactionLog=newMLTransactionLogImpl(transactionCoordinatorID,factory,newManagedLedgerConfig());###managedLedgerConfig###newManagedLedgerConfig()###68:9:69:44
fdbc5b2330ff1c99c899c7bcda89e6fb4c36aab2###/apache_pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/HttpLookupService.java###/HttpLookupService.java###org.apache.pulsar.client.impl.HttpLookupService###getBroker:TopicName ###returnhttpClient.get(basePath+topicName.getLookupName(),LookupData.class).thenCompose(lookupData->{URIuri=null;try{if(useTls){uri=newURI(lookupData.getBrokerUrlTls());}else{StringserviceUrl=lookupData.getBrokerUrl();if(serviceUrl==null){serviceUrl=lookupData.getNativeUrl();}uri=newURI(serviceUrl);}InetSocketAddressbrokerAddress=InetSocketAddress.createUnresolved(uri.getHost(),uri.getPort());returnCompletableFuture.completedFuture(Pair.of(brokerAddress,brokerAddress));}catch(Exceptione){log.warn("[{}]LookupFailedduetoinvalidurl{},{}",topicName,uri,e.getMessage());returnFutureUtil.failedFuture(e);}});###path###basePath+topicName.getLookupName()###84:9:105:12
c6beb35c428831cc53dfa10605d30f57d8743f02###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/SystemTopicBasedTopicPoliciesService.java###/SystemTopicBasedTopicPoliciesService.java###org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService###getPulsarEvent:TopicName ActionType TopicPolicies ###returnPulsarEvent.builder().actionType(actionType).eventType(EventType.TOPIC_POLICY).topicPoliciesEvent(TopicPoliciesEvent.builder().domain(topicName.getDomain().toString()).tenant(topicName.getTenant()).namespace(topicName.getNamespaceObject().getLocalName()).topic(TopicName.get(topicName.getPartitionedTopicName()).getLocalName()).policies(policies).build()).build();###builder###PulsarEvent.builder()###133:9:144:26
021409b6e1d3c910afe8e05d51a536cee647cb90###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/BacklogQuotaManager.java###/BacklogQuotaManager.java###org.apache.pulsar.broker.service.BacklogQuotaManager###dropBacklogForTimeLimit:PersistentTopic BacklogQuota boolean ###slowestConsumer.resetCursor(mLedger.getNextValidPosition(PositionImpl.get(ledgerInfo.getLedgerId(),ledgerInfo.getEntries()-1)));###nextPosition###mLedger.getNextValidPosition(PositionImpl.get(ledgerInfo.getLedgerId(),ledgerInfo.getEntries()-1))###211:21:212:103
f844c74b9c1e0e90cb72971078c9f187601385bb###/apache_pulsar/pulsar-broker/src/test/java/org/apache/pulsar/compaction/CompactedTopicTest.java###/CompactedTopicTest.java###org.apache.pulsar.compaction.CompactedTopicTest###testLastMessageIdForCompactedLedger:###Assert.assertEquals(msg,reader.readNext().getValue());###received###reader.readNext()###416:9:416:64
72f77853a43fd439235b9594099494b1b3e12464###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java###/PersistentTopicsBase.java###org.apache.pulsar.broker.admin.impl.PersistentTopicsBase###generateResponseWithEntry:Entry ###responseBuilder.header("X-Pulsar-batch-size",metadataAndPayload.readableBytes()-metadata.getSerializedSize());###totalSize###metadataAndPayload.readableBytes()###2526:13:2527:53
7eff07c53e5cf730b7e383dddb7e4d2c8b53bc0d###/apache_pulsar/tests/integration/src/test/java/org/apache/pulsar/tests/integration/utils/DockerUtils.java###/DockerUtils.java###org.apache.pulsar.tests.integration.utils.DockerUtils###dumpContainerLogDirToTarget:DockerClient String String ###Fileoutput=newFile(getTargetDirectory(containerId),entry.getName().replace("/","-"));###targetDirectory###getTargetDirectory(containerId)###155:21:155:112
ded806fd52f6e2f182fa02052cbd82c2a6755098###/apache_pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/PrecisPublishLimiter.java###/PrecisPublishLimiter.java###org.apache.pulsar.broker.service.PrecisPublishLimiter###tryAcquire:int long ###return(topicPublishRateLimiterOnMessage==null||topicPublishRateLimiterOnMessage.tryAcquire(numbers))&&(topicPublishRateLimiterOnByte==null||topicPublishRateLimiterOnByte.tryAcquire(bytes));###currentTopicPublishRateLimiterOnByte###topicPublishRateLimiterOnByte###108:9:109:111
