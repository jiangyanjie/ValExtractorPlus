08023c624af2411d71a1a0883cc2e6108285dd80###/alibaba_Alink/core/src/main/java/com/alibaba/alink/pipeline/MapTransformer.java###/MapTransformer.java###com.alibaba.alink.pipeline.MapTransformer###getLocalPredictor:TableSchema ###returnnewLocalPredictor(this.mapperBuilder.apply(inputSchema,this.getParams()));###mapper###this.mapperBuilder.apply(inputSchema,this.getParams())###44:3:44:86
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/tree/predictors/TreeModelMapper.java###/TreeModelMapper.java###com.alibaba.alink.operator.common.tree.predictors.TreeModelMapper###initRowPredict:###stringIndexerModelPredictor=newMultiStringIndexerModelMapper(modelSchema,getDataSchema(),newParams().set(HasSelectedCols.SELECTED_COLS,categoricalColNames).set(MultiStringIndexerPredictParams.HANDLE_INVALID,HasHandleInvalid.HandleInvalid.SKIP));###dataSchema###getDataSchema()###51:4:57:6
f734d3958d03d67b8eaf4269a1a4a1e8c96145b2###/alibaba_Alink/connectors/connector-hive/hive-bridge/src/main/java/org/apache/flink/connectors/hive/HiveBatchAndStreamTableSink.java###/HiveBatchAndStreamTableSink.java###org.apache.flink.connectors.hive.HiveBatchAndStreamTableSink###getOutputFormat:###Tabletable=client.getTable(identifier.getDatabaseName(),identifier.getObjectName());###tableName###identifier.getObjectName()###134:4:134:92
850111ccebb0b01ccc1d134c5436e5817a9c5894###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/stream/StreamOperator.java###/StreamOperator.java###com.alibaba.alink.operator.stream.StreamOperator###getTableName:###tableName=getOutputTable().toString();###outputTable###getOutputTable()###257:4:257:44
fcc1564099f8214cb02c246344d7fbe3196fcc01###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/dl/DLEnvConfig.java###/DLEnvConfig.java###com.alibaba.alink.common.dl.DLEnvConfig###getDefaultPythonEnv:Version ###FilePathpluginFilePath=ResourcePluginFactory.getResourcePluginPath(getRegisterKey(version));###registerKey###getRegisterKey(version)###76:3:76:98
c77c61e2cb537122a8549eade4420d6038bdd1ad###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/evaluation/BinaryMetricsSummary.java###/BinaryMetricsSummary.java###com.alibaba.alink.operator.common.evaluation.BinaryMetricsSummary###extractMatrixThreCurve:long[] long[] long ###liftChart[i]=newEvaluationCurvePoint(1.0*(curTrue+curFalse)/total,curTrue,threshold[i]);###pr###1.0*(curTrue+curFalse)/total###224:13:224:112
e025a64924a25cf016e62364a15f3c1c9ad6be61###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/io/filesystem/FilePath.java###/FilePath.java###com.alibaba.alink.common.io.filesystem.FilePath###init:###Stringschema=path.toUri().getScheme();###uri###path.toUri()###152:3:152:44
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/pipeline/ModelExporterUtils.java###/ModelExporterUtils.java###com.alibaba.alink.pipeline.ModelExporterUtils###loadStagesFromPipelineModel:List<Row> TableSchema ###finalint[]cursor=newint[]{pipelineModel.size()-1};###size###pipelineModel.size()###797:3:797:61
850111ccebb0b01ccc1d134c5436e5817a9c5894###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/BatchOperator.java###/BatchOperator.java###com.alibaba.alink.operator.batch.BatchOperator###getTableName:###tableName=getOutputTable().toString();###outputTable###getOutputTable()###335:4:335:44
f734d3958d03d67b8eaf4269a1a4a1e8c96145b2###/alibaba_Alink/connectors/connector-hive/hive-bridge/src/main/java/org/apache/flink/connectors/hive/HiveBatchAndStreamTableSink.java###/HiveBatchAndStreamTableSink.java###org.apache.flink.connectors.hive.HiveBatchAndStreamTableSink###consume:DataStream<RowData> boolean DataStructureConverter ###Tabletable=client.getTable(identifier.getDatabaseName(),identifier.getObjectName());###dbName###identifier.getDatabaseName()###200:4:200:92
c77c61e2cb537122a8549eade4420d6038bdd1ad###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/evaluation/BinaryMetricsSummary.java###/BinaryMetricsSummary.java###com.alibaba.alink.operator.common.evaluation.BinaryMetricsSummary###extractMatrixThreCurve:long[] long[] long ###recallPrecisionCurve[i]=newEvaluationCurvePoint(tpr,curTrue+curTrue==0?1.0:1.0*curTrue/(curTrue+curFalse),threshold[i]);###precision###curTrue+curTrue==0?1.0:1.0*curTrue/(curTrue+curFalse)###223:13:223:152
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/test/java/com/alibaba/alink/common/linalg/BLASTest.java###/BLASTest.java###com.alibaba.alink.common.linalg.BLASTest###testAxpy:###BLAS.axpy(1.0,spv1,v);###v2###spv1###51:9:51:33
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/tree/predictors/TreeModelMapper.java###/TreeModelMapper.java###com.alibaba.alink.operator.common.tree.predictors.TreeModelMapper###initRowPredict:###stringIndexerModelPredictor=newMultiStringIndexerModelMapper(modelSchema,getDataSchema(),newParams().set(HasSelectedCols.SELECTED_COLS,categoricalColNames).set(MultiStringIndexerPredictParams.HANDLE_INVALID,HasHandleInvalid.HandleInvalid.SKIP));###stringIndexerModelPredictorParams###newParams().set(HasSelectedCols.SELECTED_COLS,categoricalColNames).set(MultiStringIndexerPredictParams.HANDLE_INVALID,HasHandleInvalid.HandleInvalid.SKIP)###51:4:57:6
f734d3958d03d67b8eaf4269a1a4a1e8c96145b2###/alibaba_Alink/connectors/connector-hive/hive-bridge/src/main/java/org/apache/flink/connectors/hive/HiveBatchAndStreamTableSink.java###/HiveBatchAndStreamTableSink.java###org.apache.flink.connectors.hive.HiveBatchAndStreamTableSink###consume:DataStream<RowData> boolean DataStructureConverter ###Tabletable=client.getTable(identifier.getDatabaseName(),identifier.getObjectName());###tableName###identifier.getObjectName()###200:4:200:92
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/dataproc/StringIndexerTrainBatchOp.java###/StringIndexerTrainBatchOp.java###com.alibaba.alink.operator.batch.dataproc.StringIndexerTrainBatchOp###linkFrom:BatchOperator<?>[] ###DataSet<Tuple3<Integer,String,Long>>indexedToken=StringIndexerUtil.indexTokens(inputRows,getStringOrderType(),0L,true);###orderType###getStringOrderType()###58:9:59:86
a281666713d5aa518ddc712d4e48839ca80c4397###/alibaba_Alink/connectors/connector-hive/src/main/java/com/alibaba/alink/common/io/HiveDB.java###/HiveDB.java###com.alibaba.alink.common.io.HiveDB###sinkStream:String Table Params Long ###tableSink.setStaticPartition(getStaticPartitionSpec(parameter.get(HiveSinkParams.PARTITION)));###staticPartitionSpec###getStaticPartitionSpec(parameter.get(HiveSinkParams.PARTITION))###451:13:451:107
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/tree/predictors/TreeModelMapper.java###/TreeModelMapper.java###com.alibaba.alink.operator.common.tree.predictors.TreeModelMapper###initRowPredict:###stringIndexerModelNumericalTypeCastMapper=newNumericalTypeCastMapper(getDataSchema(),newParams().set(NumericalTypeCastParams.SELECTED_COLS,categoricalColNames).set(NumericalTypeCastParams.TARGET_TYPE,NumericalTypeCastParams.TargetType.valueOf("INT")));###stringIndexerModelNumericalTypeCastMapperParams###newParams().set(NumericalTypeCastParams.SELECTED_COLS,categoricalColNames).set(NumericalTypeCastParams.TARGET_TYPE,NumericalTypeCastParams.TargetType.valueOf("INT"))###61:4:65:6
f84909794b4863b389ff3917c9fd8ccf6953f485###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/classification/NaiveBayesTextTrainBatchOp.java###/NaiveBayesTextTrainBatchOp.java###com.alibaba.alink.operator.batch.classification.NaiveBayesTextTrainBatchOp###linkFrom:BatchOperator<?>[] ###DataSet<Row>probs=trainData.groupBy(newSelectLabel()).reduceGroup(newReduceItem()).withBroadcastSet(vectorSize,"vectorSize").mapPartition(newGenerateModel(smoothing,modelType,vectorColName,labelType)).withBroadcastSet(vectorSize,"vectorSize").setParallelism(1);###labelFeatureInfo###trainData.groupBy(newSelectLabel()).reduceGroup(newReduceItem()).withBroadcastSet(vectorSize,"vectorSize")###94:3:100:24
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/dataproc/MultiStringIndexerTrainBatchOp.java###/MultiStringIndexerTrainBatchOp.java###com.alibaba.alink.operator.batch.dataproc.MultiStringIndexerTrainBatchOp###linkFrom:BatchOperator<?>[] ###DataSet<Tuple3<Integer,String,Long>>indexedToken=StringIndexerUtil.indexTokens(inputRows,getStringOrderType(),0L,true);###orderType###getStringOrderType()###57:9:58:86
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/tree/predictors/TreeModelMapper.java###/TreeModelMapper.java###com.alibaba.alink.operator.common.tree.predictors.TreeModelMapper###initRowPredict:###numericalTypeCastMapper=newNumericalTypeCastMapper(getDataSchema(),newParams().set(NumericalTypeCastParams.SELECTED_COLS,ArrayUtils.removeElements(treeModel.meta.get(HasFeatureCols.FEATURE_COLS),categoricalColNames)).set(NumericalTypeCastParams.TARGET_TYPE,NumericalTypeCastParams.TargetType.valueOf("DOUBLE")));###numericalTypeCastMapperParams###newParams().set(NumericalTypeCastParams.SELECTED_COLS,ArrayUtils.removeElements(treeModel.meta.get(HasFeatureCols.FEATURE_COLS),categoricalColNames)).set(NumericalTypeCastParams.TARGET_TYPE,NumericalTypeCastParams.TargetType.valueOf("DOUBLE"))###68:3:75:5
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/clustering/lda/OnlineLogLikelihood.java###/OnlineLogLikelihood.java###com.alibaba.alink.operator.common.clustering.lda.OnlineLogLikelihood###calc:ComContext ###if(context.getStepNo()==numIter)###stepNo###context.getStepNo()###105:3:124:4
fcc1564099f8214cb02c246344d7fbe3196fcc01###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/dl/ProcessPythonRunnerV2.java###/ProcessPythonRunnerV2.java###com.alibaba.alink.common.dl.ProcessPythonRunnerV2###runScript:###mlContext.putEnvProperty("PATH",System.getenv("PATH"));###pathEnv###System.getenv("PATH")###95:13:95:69
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/classification/NaiveBayesTextModelMapper.java###/NaiveBayesTextModelMapper.java###com.alibaba.alink.operator.common.classification.NaiveBayesTextModelMapper###bernoulliCalculation:Vector ###BLAS.gemv(1,modelData.minMat,false,(SparseVector)vec,0,prob);###sparseVec###(SparseVector)vec###88:13:88:80
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/test/java/com/alibaba/alink/common/linalg/BLASTest.java###/BLASTest.java###com.alibaba.alink.common.linalg.BLASTest###testAxpy:###BLAS.axpy(1.0,dv1,v);###v1###dv1###49:9:49:32
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/source/MemSourceBatchOp.java###/MemSourceBatchOp.java###com.alibaba.alink.operator.batch.source.MemSourceBatchOp###initializeDataSource:###DataSet<Row>dataSet=MLEnvironmentFactory.get(getMLEnvironmentId()).getExecutionEnvironment().fromCollection(rows,newRowTypeInfo(colTypes));###mlEnvironmentId###getMLEnvironmentId()###96:3:98:54
fcc1564099f8214cb02c246344d7fbe3196fcc01###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/pyrunner/bridge/BasePythonBridge.java###/BasePythonBridge.java###com.alibaba.alink.common.pyrunner.bridge.BasePythonBridge###startProcess:String ###ProcessBuilderpb=newProcessBuilder(cmd,"-c","fromalink.py4j_gatewayimportmain;main()","-j",Integer.toString(jvmPort),"-p",Integer.toString(pythonPort));###pyStmt###"fromalink.py4j_gatewayimportmain;main()"###81:9:87:11
91611cca32d22929f418aab94730526931c48e39###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/io/catalog/HiveCatalog.java###/HiveCatalog.java###com.alibaba.alink.common.io.catalog.HiveCatalog###createNewTableDesc:ObjectPath TableSchema Params ###returnnewCatalogTableImpl(schema,Arrays.asList(partitionCols),newHashMap<>(),objectPath.getFullName());###properties###newHashMap<>()###687:3:687:113
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/clustering/LdaTrainBatchOp.java###/LdaTrainBatchOp.java###com.alibaba.alink.operator.batch.clustering.LdaTrainBatchOp###linkFrom:BatchOperator<?>[] ###BatchOperatortrainData=newTableSourceBatchOp(DataSetConversionUtil.toTable(getMLEnvironmentId(),resRow,in.getColNames(),types)).setMLEnvironmentId(getMLEnvironmentId());###mlEnvId###getMLEnvironmentId()###85:9:87:55
f734d3958d03d67b8eaf4269a1a4a1e8c96145b2###/alibaba_Alink/connectors/connector-hive/hive-bridge/src/main/java/org/apache/flink/connectors/hive/HiveBatchAndStreamTableSink.java###/HiveBatchAndStreamTableSink.java###org.apache.flink.connectors.hive.HiveBatchAndStreamTableSink###getOutputFormat:###Tabletable=client.getTable(identifier.getDatabaseName(),identifier.getObjectName());###dbName###identifier.getDatabaseName()###134:4:134:92
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/clustering/LdaModelMapper.java###/LdaModelMapper.java###com.alibaba.alink.operator.common.clustering.LdaModelMapper###predictResultDetail:Row ###SparseVectorsv=DocCountVectorizerModelMapper.predictSparseVector((String)row.getField(documentColIdx),minTF,wordIdWeight,featureType,featureNum);###doc###(String)row.getField(documentColIdx)###149:9:150:98
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/clustering/lda/EmLogLikelihood.java###/EmLogLikelihood.java###com.alibaba.alink.operator.common.clustering.lda.EmLogLikelihood###calc:ComContext ###if(context.getStepNo()==numIter)###stepNo###context.getStepNo()###40:3:71:4
eb8a1ac78d5da78d8976b82e17ea9176e934f9e4###/alibaba_Alink/connectors/connector-hive/hive-bridge/src/main/java/org/apache/flink/connectors/hive/HiveBatchAndStreamTableSink.java###/HiveBatchAndStreamTableSink.java###org.apache.flink.connectors.hive.HiveBatchAndStreamTableSink###consumeDataStream:DataStream ###builder=StreamingFileSink.forBulkFormat(neworg.apache.flink.core.fs.Path(sd.getLocation()),newFileSystemTableSink.ProjectionBulkFactory(bulkFactory.get(),partComputer)).withBucketAssigner(assigner).withRollingPolicy(rollingPolicy).withOutputFileConfig(outputFileConfig);###path###neworg.apache.flink.core.fs.Path(sd.getLocation())###265:6:270:48
e66969506d54142cf73d83796e7ee1204e5ed27c###/alibaba_Alink/core/src/test/java/com/alibaba/alink/operator/batch/clustering/LdaTrainBatchOpTest.java###/LdaTrainBatchOpTest.java###com.alibaba.alink.operator.batch.clustering.LdaTrainBatchOpTest###testTrainAndPredict:###model.getModelInfoBatchOp().lazyPrintModelInfo();###modelInfo###model.getModelInfoBatchOp()###48:9:48:58
ad0a00f026521481ff6c8f7713d772abf7961d57###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/MLEnvironment.java###/MLEnvironment.java###com.alibaba.alink.common.MLEnvironment###getExecutionEnvironment:###env.setParallelism(Runtime.getRuntime().availableProcessors());###core###Runtime.getRuntime().availableProcessors()###114:17:114:80
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/pipeline/Trainer.java###/Trainer.java###com.alibaba.alink.pipeline.Trainer###fit:BatchOperator<?> ###returnpostProcessModel(createModel(trainer));###model###createModel(trainer)###48:3:48:49
50d592686b968415eb1a5d123deb7c4b40a81dab###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/common/dataproc/StringIndexerUtil.java###/StringIndexerUtil.java###com.alibaba.alink.operator.common.dataproc.StringIndexerUtil###indexRandom:DataSet<Row> long boolean ###DataSet<Tuple2<Integer,String>>distinctTokens=flattenTokens(data,ignoreNull).groupBy(0,1).reduce(newReduceFunction<Tuple2<Integer,String>>(){privatestaticfinallongserialVersionUID=3246078624056103227L;@OverridepublicTuple2<Integer,String>reduce(Tuple2<Integer,String>value1,Tuple2<Integer,String>value2)throwsException{returnvalue1;}}).name("distinct_tokens");###flattened###flattenTokens(data,ignoreNull)###67:3:79:29
3466b1b1a53683cca3e15814342d755b6276e814###/alibaba_Alink/core/src/main/java/com/alibaba/alink/operator/batch/feature/OneHotTrainBatchOp.java###/OneHotTrainBatchOp.java###com.alibaba.alink.operator.batch.feature.OneHotTrainBatchOp###linkFrom:BatchOperator<?>[] ###DataSet<Tuple3<Integer,String,Long>>countTokens=StringIndexerUtil.countTokens(inputRows,true).filter(newFilterFunction<Tuple3<Integer,String,Long>>(){privatestaticfinallongserialVersionUID=-8219708805787440332L;@Overridepublicbooleanfilter(Tuple3<Integer,String,Long>value){returnvalue.f2>=thresholdArray[value.f0];}});###countTokens###StringIndexerUtil.countTokens(inputRows,true)###89:3:97:7
fb68c0fde66f4267e6fd156116f93319943d16b3###/alibaba_Alink/core/src/main/java/com/alibaba/alink/common/MLEnvironment.java###/MLEnvironment.java###com.alibaba.alink.common.MLEnvironment###getExecutionEnvironment:###env.setParallelism(Runtime.getRuntime().availableProcessors());###core###Runtime.getRuntime().availableProcessors()###119:5:119:68
