18e9e705264158c2d768eee96dd0daa3c741d7af###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/generator/FixedAndRecurringInvoiceItemGenerator.java###/FixedAndRecurringInvoiceItemGenerator.java###org.killbill.billing.invoice.generator.FixedAndRecurringInvoiceItemGenerator###generateFixedPriceItem:UUID UUID BillingEvent LocalDate Currency InvoiceItemGeneratorLogger InternalCallContext ###finalFixedPriceInvoiceItemfixedPriceInvoiceItem=newFixedPriceInvoiceItem(invoiceId,accountId,thisEvent.getBundleId(),thisEvent.getSubscriptionId(),thisEvent.getPlan().getProduct().getName(),thisEvent.getPlan().getName(),thisEvent.getPlanPhase().getName(),roundedStartDate,fixedPrice,currency);###currentPlan###thisEvent.getPlan()###407:17:410:135
f6e834f719d5528438670bbf4600284c40ec3192###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/usage/RawUsageOptimizer.java###/RawUsageOptimizer.java###org.killbill.billing.invoice.usage.RawUsageOptimizer###getOptimizedRawUsageStartDate:LocalDate LocalDate Iterable<InvoiceItem> Map<String,Usage> InternalCallContext ###finalLocalDatetargetBillingPeriodDate=value!=null?InvoiceDateUtils.recedeByNPeriods(value,e.getKey(),config.getMaxRawUsagePreviousPeriod(internalCallContext)):null;###maxRawUsagePeriods###config.getMaxRawUsagePreviousPeriod(internalCallContext)###118:13:118:189
e65e2acd346250a2ee16109d754b67518071d0b0###/killbill_killbill/invoice/src/test/java/org/killbill/billing/invoice/usage/TestContiguousIntervalConsumableInArrear.java###/TestContiguousIntervalConsumableInArrear.java###org.killbill.billing.invoice.usage.TestContiguousIntervalConsumableInArrear###testMultipleItemsAndTiersWithExistingItemsAllTiers_DETAIL:###finalUsageConsumableInArrearTierUnitAggregateexistingBarUsageTier1=newUsageConsumableInArrearTierUnitAggregate(1,"BAR",newBigDecimal("2.00"),1L,80L,newBigDecimal("160.00"));###existingBarUsageAmount1###80L###912:9:912:194
18e9e705264158c2d768eee96dd0daa3c741d7af###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/generator/FixedAndRecurringInvoiceItemGenerator.java###/FixedAndRecurringInvoiceItemGenerator.java###org.killbill.billing.invoice.generator.FixedAndRecurringInvoiceItemGenerator###processRecurringEvent:UUID UUID BillingEvent BillingEvent LocalDate Currency InvoiceItemGeneratorLogger BillingMode Map<UUID,SubscriptionFutureNotificationDates> InternalCallContext ###finalRecurringInvoiceItemrecurringItem=newRecurringInvoiceItem(invoiceId,accountId,thisEvent.getBundleId(),thisEvent.getSubscriptionId(),thisEvent.getPlan().getProduct().getName(),thisEvent.getPlan().getName(),thisEvent.getPlanPhase().getName(),itemDatum.getStartDate(),itemDatum.getEndDate(),amount,rate,currency);###currentPlan###thisEvent.getPlan()###243:29:252:121
e9d7692479443ace9fc8f717fe69d2f09e9ed0c7###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/usage/RawUsageOptimizer.java###/RawUsageOptimizer.java###org.killbill.billing.invoice.usage.RawUsageOptimizer###getOptimizedRawUsageStartDate:LocalDate LocalDate Iterable<InvoiceItem> Map<String,Usage> InternalCallContext ###finalLocalDatetargetBillingPeriodDate=tmp!=null?InvoiceDateUtils.recedeByNPeriods(tmp,bp,config.getMaxRawUsagePreviousPeriod(internalCallContext)):null;###maxRawUsagePeriods###config.getMaxRawUsagePreviousPeriod(internalCallContext)###141:17:141:181
492c2338c707028247b9ff4a878dbdd2d7d1008f###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/generator/FixedAndRecurringInvoiceItemGenerator.java###/FixedAndRecurringInvoiceItemGenerator.java###org.killbill.billing.invoice.generator.FixedAndRecurringInvoiceItemGenerator###processRecurringEvent:UUID UUID BillingEvent BillingEvent LocalDate Currency InvoiceItemGeneratorLogger Map<UUID,SubscriptionFutureNotificationDates> InternalCallContext ###finalLocalDatemaxEndDate=thisEvent.getPlanPhase().getPhaseType()==PhaseType.FIXEDTERM?thisEvent.getPlanPhase().getDuration().addToLocalDate(internalCallContext.toLocalDate(thisEvent.getEffectiveDate())):null;###thisEventEffectiveDate###internalCallContext.toLocalDate(thisEvent.getEffectiveDate())###231:17:233:51
e65e2acd346250a2ee16109d754b67518071d0b0###/killbill_killbill/invoice/src/test/java/org/killbill/billing/invoice/usage/TestContiguousIntervalConsumableInArrear.java###/TestContiguousIntervalConsumableInArrear.java###org.killbill.billing.invoice.usage.TestContiguousIntervalConsumableInArrear###testMultipleItemsAndTiersWithExistingItemsAllTiers_AGGREGATE:###finalUsageConsumableInArrearTierUnitAggregateexistingFooUsageTier2=newUsageConsumableInArrearTierUnitAggregate(2,"FOO",BigDecimal.TEN,1L,40L,newBigDecimal("400.00"));###existingFooQuantity2###40L###826:9:826:186
e65e2acd346250a2ee16109d754b67518071d0b0###/killbill_killbill/invoice/src/test/java/org/killbill/billing/invoice/usage/TestContiguousIntervalConsumableInArrear.java###/TestContiguousIntervalConsumableInArrear.java###org.killbill.billing.invoice.usage.TestContiguousIntervalConsumableInArrear###testMultipleItemsAndTiersWithExistingItemsAllTiers_AGGREGATE:###finalUsageConsumableInArrearTierUnitAggregateexistingFooUsageTier1=newUsageConsumableInArrearTierUnitAggregate(1,"FOO",BigDecimal.ONE,1L,10L,newBigDecimal("10.00"));###existingFooQuantity1###10L###825:9:825:185
18e9e705264158c2d768eee96dd0daa3c741d7af###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/usage/ContiguousIntervalUsageInArrear.java###/ContiguousIntervalUsageInArrear.java###org.killbill.billing.invoice.usage.ContiguousIntervalUsageInArrear###build:boolean ###finalLocalDatestartDate=internalTenantContext.toLocalDate(billingEvents.get(0).getEffectiveDate());###firstBillingEvent###billingEvents.get(0)###134:9:134:112
18e9e705264158c2d768eee96dd0daa3c741d7af###/killbill_killbill/profiles/killbill/src/test/java/org/killbill/billing/jaxrs/TestUsage.java###/TestUsage.java###org.killbill.billing.jaxrs.TestUsage###testRecordUsageTrackingIdExists:###usage.setTrackingId(UUID.randomUUID().toString());###trackingId###UUID.randomUUID().toString()###207:9:207:59
98f7b92d069e6971fb788d5c2253ee2624e142f2###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/usage/ContiguousIntervalConsumableUsageInArrear.java###/ContiguousIntervalConsumableUsageInArrear.java###org.killbill.billing.invoice.usage.ContiguousIntervalConsumableUsageInArrear###getBilledDetailsForUnitType:Iterable<InvoiceItem> String ###tierDetails.add(newUsageConsumableInArrearTierUnitAggregate(targetTierUnitDetail.getTier(),targetTierUnitDetail.getTierUnit(),bi.getRate(),targetTierUnitDetail.getTierBlockSize(),quantity,bi.getAmount()));###usageUnitAggregate###newUsageConsumableInArrearTierUnitAggregate(targetTierUnitDetail.getTier(),targetTierUnitDetail.getTierUnit(),bi.getRate(),targetTierUnitDetail.getTierBlockSize(),quantity,bi.getAmount())###163:21:163:232
cb1358b57e897e0774408b4097cd9595398c9e9d###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/usage/ContiguousIntervalUsageInArrear.java###/ContiguousIntervalUsageInArrear.java###org.killbill.billing.invoice.usage.ContiguousIntervalUsageInArrear###build:boolean ###finalLocalDateendDate=closedInterval?internalTenantContext.toLocalDate(billingEvents.get(billingEvents.size()-1).getEffectiveDate()):targetDate;###latestBillingEvent###billingEvents.get(billingEvents.size()-1)###179:9:179:163
66744b9dbb6881642de7b1bbe54d993cc79fe281###/killbill_killbill/subscription/src/main/java/org/killbill/billing/subscription/api/SubscriptionApiBase.java###/SubscriptionApiBase.java###org.killbill.billing.subscription.api.SubscriptionApiBase###populateDryRunEvents:UUID DryRunArguments Collection<SubscriptionBaseEvent> Collection<DefaultSubscriptionBase> SubscriptionCatalog AddonUtils TenantContext InternalTenantContext ###finalDateTimestartEffectiveDate=dryRunArguments.getEffectiveDate()!=null?context.toUTCDateTime(dryRunArguments.getEffectiveDate()):utcNow;###dryRunEffDt###dryRunArguments.getEffectiveDate()###152:17:152:165
582156eb28aff7601b97a1af620f47face3061e5###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/usage/RawUsageOptimizer.java###/RawUsageOptimizer.java###org.killbill.billing.invoice.usage.RawUsageOptimizer###getInArrearUsage:LocalDate LocalDate Iterable<InvoiceItem> Map<String,Usage> InternalCallContext ###finalLocalDatetargetStartDate=config.getMaxRawUsagePreviousPeriod(internalCallContext)>=0?getOptimizedRawUsageStartDate(firstEventStartDate,targetDate,existingUsageItems,knownUsage,internalCallContext):firstEventStartDate;###configRawUsagePreviousPeriod###config.getMaxRawUsagePreviousPeriod(internalCallContext)###73:9:73:245
d4f9e3ec131ed0e0d4255a3a1e43313658a307f4###/killbill_killbill/junction/src/main/java/org/killbill/billing/junction/plumbing/billing/DefaultInternalBillingApi.java###/DefaultInternalBillingApi.java###org.killbill.billing.junction.plumbing.billing.DefaultInternalBillingApi###getBillingEventsForAccountAndUpdateAccountBCD:UUID DryRunArguments LocalDate InternalCallContext ###if(blockCalculator.insertBlockingEvents(result,skippedSubscriptions,subscriptionsForAccount,fullCatalog,cutoffDt,context))###afterBlocking###blockCalculator.insertBlockingEvents(result,skippedSubscriptions,subscriptionsForAccount,fullCatalog,cutoffDt,context)###121:9:124:10
18e9e705264158c2d768eee96dd0daa3c741d7af###/killbill_killbill/invoice/src/main/java/org/killbill/billing/invoice/generator/FixedAndRecurringInvoiceItemGenerator.java###/FixedAndRecurringInvoiceItemGenerator.java###org.killbill.billing.invoice.generator.FixedAndRecurringInvoiceItemGenerator###processRecurringEvent:UUID UUID BillingEvent BillingEvent LocalDate Currency InvoiceItemGeneratorLogger BillingMode Map<UUID,SubscriptionFutureNotificationDates> InternalCallContext ###finalLocalDatemaxEndDate=thisEvent.getPlanPhase().getPhaseType()==PhaseType.FIXEDTERM?thisEvent.getPlanPhase().getDuration().addToLocalDate(internalCallContext.toLocalDate(thisEvent.getEffectiveDate())):null;###thisEventEffectiveDate###internalCallContext.toLocalDate(thisEvent.getEffectiveDate())###213:13:215:47
eb765f32ba4d2f6822b2be33e3a0d121fbccfb7c###/killbill_killbill/util/src/main/java/org/killbill/billing/util/customfield/dao/DefaultCustomFieldDao.java###/DefaultCustomFieldDao.java###org.killbill.billing.util.customfield.dao.DefaultCustomFieldDao###getCustomFieldsForAccountType:ObjectType InternalTenantContext ###returngetCustomFieldsForAccount(context).stream().filter(customFieldModelDao->customFieldModelDao.getObjectType()==objectType).collect(Collectors.toList());###allFields###getCustomFieldsForAccount(context)###90:9:92:47
e65e2acd346250a2ee16109d754b67518071d0b0###/killbill_killbill/invoice/src/test/java/org/killbill/billing/invoice/usage/TestContiguousIntervalConsumableInArrear.java###/TestContiguousIntervalConsumableInArrear.java###org.killbill.billing.invoice.usage.TestContiguousIntervalConsumableInArrear###testMultipleItemsAndTiersWithExistingItemsAllTiers_DETAIL:###finalUsageConsumableInArrearTierUnitAggregateexistingFooUsageTier1=newUsageConsumableInArrearTierUnitAggregate(1,"FOO",BigDecimal.ONE,1L,10L,newBigDecimal("10.00"));###existingFooUsageAmount1###10L###906:9:906:185
e65e2acd346250a2ee16109d754b67518071d0b0###/killbill_killbill/invoice/src/test/java/org/killbill/billing/invoice/usage/TestContiguousIntervalConsumableInArrear.java###/TestContiguousIntervalConsumableInArrear.java###org.killbill.billing.invoice.usage.TestContiguousIntervalConsumableInArrear###testMultipleItemsAndTiersWithExistingItemsAllTiers_DETAIL:###finalUsageConsumableInArrearTierUnitAggregateexistingFooUsageTier2=newUsageConsumableInArrearTierUnitAggregate(2,"FOO",BigDecimal.TEN,1L,40L,newBigDecimal("400.00"));###existingFooUsageAmount2###40L###909:9:909:186
4378ebe0523507224167cadf8129500d3a842d09###/killbill_killbill/util/src/main/java/org/killbill/billing/util/security/shiro/realm/KillBillAuth0Realm.java###/KillBillAuth0Realm.java###org.killbill.billing.util.security.shiro.realm.KillBillAuth0Realm###KillBillAuth0Realm:SecurityConfig Clock ###this.jwtParser=Jwts.parserBuilder().requireIssuer(securityConfig.getShiroAuth0Url().endsWith("/")?securityConfig.getShiroAuth0Url():securityConfig.getShiroAuth0Url()+"/").requireAudience(securityConfig.getShiroAuth0APIIdentifier()).setClock(newClock(){@OverridepublicDatenow(){returnclock.getUTCNow().toDate();}}).setAllowedClockSkewSeconds(securityConfig.getShiroAuth0AllowedClockSkew().getMillis()/1000).setSigningKeyResolver(newSigningKeyResolver(){@OverridepublicKeyresolveSigningKey(finalJwsHeaderheader,finalClaimsclaims){returngetKey(header);}@OverridepublicKeyresolveSigningKey(finalJwsHeaderheader,finalStringplaintext){returngetKey(header);}privateKeygetKey(finalJwsHeader<?>header){finalStringkeyId=header.getKeyId();if(keyId==null){thrownewSignatureException("KeyIDisrequired");}finalPublicKeypublicKey;try{publicKey=keys.get(keyId,newCallable<PublicKey>(){@OverridepublicPublicKeycall()throwsException{returnloadPublicKey(keyId);}});}catch(finalExecutionExceptione){thrownewSignatureException("UnknownsigningkeyID");}if(publicKey==null){thrownewSignatureException("UnknownsigningkeyID");}returnpublicKey;}}).build();###jwtParserBuilder###Jwts.parserBuilder()###110:9:156:39
e65e2acd346250a2ee16109d754b67518071d0b0###/killbill_killbill/invoice/src/test/java/org/killbill/billing/invoice/usage/TestContiguousIntervalConsumableInArrear.java###/TestContiguousIntervalConsumableInArrear.java###org.killbill.billing.invoice.usage.TestContiguousIntervalConsumableInArrear###testMultipleItemsAndTiersWithExistingItemsAllTiers_AGGREGATE:###finalUsageConsumableInArrearTierUnitAggregateexistingBarUsageTier1=newUsageConsumableInArrearTierUnitAggregate(1,"BAR",newBigDecimal("2.00"),1L,80L,newBigDecimal("160.00"));###existingBarUsageQty1###80L###828:9:828:194
