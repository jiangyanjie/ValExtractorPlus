6d51543e747e36a2759bdfbd24cee65b41b4a74c###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/StackTrackingMethodVisitor.java###/StackTrackingMethodVisitor.java###com.sun.btrace.runtime.StackTrackingMethodVisitor###visitLdcInsn:Object ###state.push(newConstantItem(o));###ci###newConstantItem(o)###403:9:403:41
9864d043dc35d63a5743062e47b5e9fce1dd3d2d###/btraceio_btrace/src/share/classes/com/sun/btrace/MethodTracker.java###/MethodTracker.java###com.sun.btrace.MethodTracker###hitTimed:int ###if(means[methodId]==0)###mean###means[methodId]###147:9:151:10
8f44320c6446fb23381f87fc966d099487775ae2###/btraceio_btrace/btrace-instr/src/test/java/org/openjdk/btrace/BTraceFunctionalTests.java###/BTraceFunctionalTests.java###org.openjdk.btrace.BTraceFunctionalTests###testJfr:###if(System.getProperty("java.runtime.version","").startsWith("11.0.9"))###rtVersion###System.getProperty("java.runtime.version","")###296:5:300:6
d63057bbe29a6a576ad319ce2fafef409f4b17b4###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Preprocessor.java###/Preprocessor.java###com.sun.btrace.runtime.Preprocessor###getClassifier:MethodNode ###for(an:getAnnotations(mn))###annots###getAnnotations(mn)###678:9:686:10
d5e8a3aafba9217425cbf217ff21dd947dd89fff###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/BTraceProbeFactory.java###/BTraceProbeFactory.java###com.sun.btrace.runtime.BTraceProbeFactory###createProbe:byte[] ###returnbpp;###bp###bpp###65:21:65:32
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new TypeCheckInstrumentor###callAction:int String ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###759:37:759:90
e5acd751d96ad5fca346ac009d10baf92319b11c###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###main:String Instrumentation ###inst.appendToBootstrapClassLoaderSearch(newJarFile(f));###jf###newJarFile(f)###121:25:121:81
0ff31f5f8b535e1b9e6fa0caa3d8bdbed7b43ae6###/btraceio_btrace/src/share/classes/com/sun/btrace/BTraceRuntime.java###/BTraceRuntime.java###com.sun.btrace.BTraceRuntime###loadBTraceLibrary:ClassLoader ###path=path.substring(0,path.indexOf("!"));###archSeparator###path.indexOf("!")###2382:17:2382:61
139c01503c3651fd3972035ce88212d2c1126062###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###main:String Instrumentation ###inst.appendToSystemClassLoaderSearch(newJarFile(newFile(path)));###f###newFile(path)###148:21:148:87
d6d44a01bcabe4dcce45a8e812d27ddb71ff6ffd###/btraceio_btrace/src/share/classes/com/sun/btrace/client/Client.java###/Client.java###com.sun.btrace.client.Client###compile:String String PrintWriter String ###code=newbyte[(int)file.length()];###codeLen###(int)file.length()###194:13:194:50
1d9fa20c45a55787d9c794c009bc9b1ec7b9cab0###/btraceio_btrace/src/share/classes/com/sun/btrace/compiler/VerifierVisitor.java###/VerifierVisitor.java###com.sun.btrace.compiler.VerifierVisitor###visitVariable:VariableTree Void ###if(ve.getAnnotation(Injected.class)==null)###i###ve.getAnnotation(Injected.class)###388:13:390:14
2d832c0ed2b8fb1281524bffae5fe548b1d98f25###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/InstrumentingMethodVisitor.java###/InstrumentingMethodVisitor.java###com.sun.btrace.runtime.InstrumentingMethodVisitor###visitInsn:int ###Typet=Type.getObjectType((String)target);###typeStr###(String)target###745:21:745:65
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new CatchInstrumentor###onCatch:String ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###722:33:722:86
186fd974a468ac765163a598c86db46a12869aeb###/btraceio_btrace/btrace-instr/src/main/java/org/openjdk/btrace/instr/BTraceTransformer.java###/BTraceTransformer.java###org.openjdk.btrace.instr.BTraceTransformer###unregister:BTraceProbe ###cushionMethods.add(newMethodNode(Opcodes.ASM7,Opcodes.ACC_PRIVATE|Opcodes.ACC_STATIC,Instrumentor.getActionMethodName(p,om.getTargetName()),om.getTargetDescriptor(),null,null));###cushionMethod###newMethodNode(Opcodes.ASM7,Opcodes.ACC_PRIVATE|Opcodes.ACC_STATIC,Instrumentor.getActionMethodName(p,om.getTargetName()),om.getTargetDescriptor(),null,null)###95:17:95:203
7c288c8659e8ce4ad70872ed93405dab6e46132c###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###main:String Instrumentation ###inst.appendToBootstrapClassLoaderSearch(newJarFile(f));###jf###newJarFile(f)###107:25:107:81
93835a73ea51bac99532bd40c131fed887dbb8e7###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.mri.new MethodReturnInstrumentor###callAction:int ###retValIndex=storeNewLocal(getReturnType());###probeRetType###getReturnType()###1375:33:1375:78
2d832c0ed2b8fb1281524bffae5fe548b1d98f25###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/InstrumentingMethodVisitor.java###/InstrumentingMethodVisitor.java###com.sun.btrace.runtime.InstrumentingMethodVisitor.SimulatedStack###pop:###returnstack[--stackPtr];###val###stack[--stackPtr]###106:17:106:42
e5acd751d96ad5fca346ac009d10baf92319b11c###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###main:String Instrumentation ###inst.appendToSystemClassLoaderSearch(newJarFile(f));###jf###newJarFile(f)###145:25:145:78
c6631fa9c76fe0012f843b52cedee7b3d4e0d112###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###parseArgs:###loadDefaultArguments(argMap.get("config"));###config###argMap.get("config")###284:9:284:52
bb5ce1944efe536340a4afe43fb5cb97e4cf074c###/btraceio_btrace/src/share/classes/com/sun/btrace/compiler/Compiler.java###/Compiler.java###com.sun.btrace.compiler.Compiler###compile:MemoryJavaFileManager Iterable<? extends JavaFileObject> Writer String String ###result.put(name,cw.toByteArray());###classData###cw.toByteArray()###291:21:291:56
903c2d2ad43ee699bd528b38f61107014d3e9348###/btraceio_btrace/btrace-instr/src/main/java/org/openjdk/btrace/instr/HandlerRepository.java###/HandlerRepository.java###org.openjdk.btrace.instr.HandlerRepository###getProbeHandler:String String String String ###Files.write(Paths.get("/tmp/"+handlerClassName.replace('/','_')+".class"),data,StandardOpenOption.CREATE);###handlerPath###"/tmp/"+handlerClassName.replace('/','_')+".class"###50:13:50:126
cafe5f905a3a97acda3cb67107602bf373916fc4###/btraceio_btrace/src/share/classes/com/sun/btrace/profiling/MethodInvocationRecorder.java###/MethodInvocationRecorder.java###com.sun.btrace.profiling.MethodInvocationRecorder###getRecords:boolean ###recs[i]=measured[i].duplicate();###r###measured[i]###165:17:165:51
139c01503c3651fd3972035ce88212d2c1126062###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###main:String Instrumentation ###inst.appendToBootstrapClassLoaderSearch(newJarFile(newFile(path)));###f###newFile(path)###130:21:130:90
139c01503c3651fd3972035ce88212d2c1126062###/btraceio_btrace/src/share/classes/com/sun/btrace/client/Client.java###/Client.java###com.sun.btrace.client.Client###attach:String String String String ###sysCp=getToolsJarPath(serverVmProps.getProperty("java.class.path"),serverVmProps.getProperty("java.home"));###toolsPath###getToolsJarPath(serverVmProps.getProperty("java.class.path"),serverVmProps.getProperty("java.home"))###299:17:302:19
c6631fa9c76fe0012f843b52cedee7b3d4e0d112###/btraceio_btrace/src/share/classes/com/sun/btrace/compiler/Compiler.java###/Compiler.java###com.sun.btrace.compiler.Compiler###compile:MemoryJavaFileManager Iterable<? extends JavaFileObject> Writer String String ###result.put(name,cw.toByteArray());###classData###cw.toByteArray()###288:21:288:56
1b229f87de40b5b23464f17a7a56efe56ab1a4cc###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Preprocessor.java###/Preprocessor.java###com.sun.btrace.runtime.Preprocessor###visitMethod:int String String String String[] ###returnnewMethodVisitor(Opcodes.ASM4,newLocalVariableHelperImpl(adaptee,access,desc)){privatebooleanisBTraceHandler=false;privatefinalLabelstart=newLabel();privatefinalLabelhandler=newLabel();privateintnextVar=0;privatefinalAssemblerasm=newAssembler(this);privatevoidgenerateExportGet(Stringname,Stringdesc){inttypeCode=desc.charAt(0);switch(typeCode){case'[':asm.loadNull();break;case'L':if(desc.equals(JAVA_LANG_STRING_DESC)){asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFSTRING,BTRACE_RUNTIME_GET_PERFSTRING_DESC);}else{asm.loadNull();}break;case'Z':case'C':case'B':case'S':case'I':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFINT,BTRACE_RUNTIME_GET_PERFINT_DESC);break;case'J':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFLONG,BTRACE_RUNTIME_GET_PERFLONG_DESC);break;case'F':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFFLOAT,BTRACE_RUNTIME_GET_PERFFLOAT_DESC);break;case'D':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFDOUBLE,BTRACE_RUNTIME_GET_PERFDOUBLE_DESC);break;}}privatevoidgenerateExportPut(Stringname,Stringdesc){inttypeCode=desc.charAt(0);switch(typeCode){case'[':asm.pop();break;case'L':if(desc.equals(JAVA_LANG_STRING_DESC)){asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFSTRING,BTRACE_RUNTIME_PUT_PERFSTRING_DESC);}else{asm.pop();}break;case'Z':case'C':case'B':case'S':case'I':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFINT,BTRACE_RUNTIME_PUT_PERFINT_DESC);break;case'J':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFLONG,BTRACE_RUNTIME_PUT_PERFLONG_DESC);break;case'F':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFFLOAT,BTRACE_RUNTIME_PUT_PERFFLOAT_DESC);break;case'D':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFDOUBLE,BTRACE_RUNTIME_PUT_PERFDOUBLE_DESC);break;}}privatevoidgenerateThreadLocalGet(FieldDescriptorfd){if(isClassInitializer){if(fd.initialized){asm.loadLocal(Type.getType(fd.desc),fd.var);}elseif(fd.value!=null){asm.ldc(fd.value);}else{asm.defaultValue(fd.desc);}}else{StringfieldName=BTRACE_FIELD_PREFIX+fd.name;asm.getStatic(className,fieldName,JAVA_LANG_THREAD_LOCAL_DESC).invokeVirtual(JAVA_LANG_THREAD_LOCAL,JAVA_LANG_THREAD_LOCAL_GET,JAVA_LANG_THREAD_LOCAL_GET_DESC).unbox(fd.desc);}}privatevoidgenerateThreadLocalPut(FieldDescriptorfd){if(isClassInitializer){asm.storeLocal(Type.getType(fd.desc),fd.var);fd.initialized=true;}else{StringfieldName=BTRACE_FIELD_PREFIX+fd.name;asm.box(fd.desc).getStatic(className,fieldName,JAVA_LANG_THREAD_LOCAL_DESC).swap().invokeVirtual(JAVA_LANG_THREAD_LOCAL,JAVA_LANG_THREAD_LOCAL_SET,JAVA_LANG_THREAD_LOCAL_SET_DESC);}}@OverridepublicAnnotationVisitorvisitAnnotation(Stringname,booleanbln){if(name.startsWith("Lcom/sun/btrace/annotations/")){isBTraceHandler=true;}else{isBTraceHandler=false;}returnsuper.visitAnnotation(name,bln);}publicvoidvisitCode(){if(isClassInitializer||isBTraceHandler){visitTryCatchBlock(start,handler,handler,JAVA_LANG_THROWABLE);if(isClassInitializer){asm.ldc(classType).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_FOR_CLASS,BTRACE_RUNTIME_FOR_CLASS_DESC).putStatic(className,BTRACE_RUNTIME_FIELD_NAME,BTRACE_RUNTIME_DESC);}asm.getStatic(className,BTRACE_RUNTIME_FIELD_NAME,BTRACE_RUNTIME_DESC).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_ENTER,BTRACE_RUNTIME_ENTER_DESC);if(isClassInitializer){for(FieldDescriptorfd:threadLocalFields.values()){fd.var=nextVar;nextVar+=Type.getType(fd.desc).getSize();}for(FieldDescriptorfd:exportFields.values()){asm.ldc(perfCounterName(fd.name)).ldc(fd.desc);if(fd.value==null){asm.loadNull();}else{asm.ldc(fd.value).box(fd.desc);}asm.invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_NEW_PERFCOUNTER,BTRACE_RUNTIME_NEW_PERFCOUNTER_DESC);}}visitJumpInsn(IFNE,start);super.visitInsn(RETURN);visitLabel(start);}super.visitCode();}publicvoidvisitFieldInsn(intopcode,Stringowner,Stringname,Stringdesc){StringfieldName=name;if(owner.equals(className)){if(exportFields.get(name)!=null){if(opcode==GETSTATIC){generateExportGet(perfCounterName(name),desc);}else{generateExportPut(perfCounterName(name),desc);}return;}if(!name.equals(BTRACE_RUNTIME_FIELD_NAME)){fieldName=BTRACE_FIELD_PREFIX+name;}FieldDescriptorfd=threadLocalFields.get(name);if(fd!=null){if(opcode==GETSTATIC){generateThreadLocalGet(fd);}else{generateThreadLocalPut(fd);}return;}}super.visitFieldInsn(opcode,owner,fieldName,desc);}publicvoidvisitVarInsn(intopcode,intvar){super.visitVarInsn(opcode,var+nextVar);}publicvoidvisitInsn(intopcode){if(opcode==RETURN){if(isClassInitializer){for(FieldDescriptorfd:threadLocalFields.values()){generateThreadLocalGet(fd);asm.box(fd.desc).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_NEW_THREAD_LOCAL,BTRACE_RUNTIME_NEW_THREAD_LOCAL_DESC).putStatic(className,BTRACE_FIELD_PREFIX+fd.name,JAVA_LANG_THREAD_LOCAL_DESC);}asm.invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_START,BTRACE_RUNTIME_START_DESC);}else{if(isBTraceHandler){asm.invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_LEAVE,BTRACE_RUNTIME_LEAVE_DESC);}}}super.visitInsn(opcode);}@OverridepublicvoidvisitMethodInsn(intopcode,Stringowner,Stringname,Stringdesc,booleanitf){if(owner.equals(Type.getInternalName(StringBuilder.class))){if(name.equals("append")){if(desc.equals(Type.getMethodDescriptor(Type.getType(StringBuilder.class),Type.getType(Object.class)))){super.visitMethodInsn(Opcodes.INVOKESTATIC,Type.getInternalName(BTraceRuntime.class),"safeStr",Type.getMethodDescriptor(Type.getType(String.class),Type.getType(Object.class)),false);desc=Type.getMethodDescriptor(Type.getType(StringBuilder.class),Type.getType(String.class));}}}super.visitMethodInsn(opcode,owner,name,desc,itf);}publicvoidvisitMaxs(intmaxStack,intmaxLocals){visitLabel(handler);if(isBTraceHandler){visitMethodInsn(INVOKESTATIC,BTRACE_RUNTIME,BTRACE_RUNTIME_HANDLE_EXCEPTION,BTRACE_RUNTIME_HANDLE_EXCEPTION_DESC);}super.visitInsn(RETURN);super.visitMaxs(maxStack,maxLocals);}};###lvh###newLocalVariableHelperImpl(adaptee,access,desc)###526:13:822:15
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new LineNumberInstrumentor###callOnLine:int ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1262:33:1262:86
c03df7c720cbe739d70f6a167caeab34f1c3f328###/btraceio_btrace/btrace-core/src/main/java/org/openjdk/btrace/core/BTraceRuntime.java###/BTraceRuntime.java###org.openjdk.btrace.core.BTraceRuntime###leave:###getRt().leave();###rt###getRt()###163:5:163:21
c03df7c720cbe739d70f6a167caeab34f1c3f328###/btraceio_btrace/btrace-core/src/main/java/org/openjdk/btrace/core/BTraceRuntime.java###/BTraceRuntime.java###org.openjdk.btrace.core.BTraceRuntime###enter:###returngetRt().enter();###rt###getRt()###155:5:155:28
9864d043dc35d63a5743062e47b5e9fce1dd3d2d###/btraceio_btrace/src/share/classes/com/sun/btrace/MethodTracker.java###/MethodTracker.java###com.sun.btrace.MethodTracker###hit:int ###if(means[methodId]==0)###mean###means[methodId]###126:9:128:10
6361e94b4382a709e91f647e2db383da8aa9ee9d###/btraceio_btrace/btrace-instr/src/main/java/org/openjdk/btrace/instr/BTraceBCPClassLoader.java###/BTraceBCPClassLoader.java###org.openjdk.btrace.instr.BTraceBCPClassLoader###loadClass:String ###returngetParent().loadClass(name);###parent###getParent()###37:5:37:40
0400d56e900dd44bf966b77e635f77e2f31e58cb###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.visitMethod.new MethodVisitor###visitAnnotation:String boolean ###visitor=instrumentorFor(om,visitor,access,name,desc);###mAccess###access###231:37:231:96
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.eri.new ErrorReturnInstrumentor###onErrorReturn:###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###915:33:915:86
eae703e2090a99c70d6770b8a5495a54f27e7966###/btraceio_btrace/src/share/classes/com/sun/btrace/compiler/VerifierVisitor.java###/VerifierVisitor.java###com.sun.btrace.compiler.VerifierVisitor###reportError:String Tree ###verifier.getMessager().printMessage(Diagnostic.Kind.ERROR,msg,getElement(node));###e###getElement(node)###564:13:564:95
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new ObjectAllocInstrumentor###afterObjectNew:String ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1341:41:1341:94
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new ThrowInstrumentor###onThrow:###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1733:33:1733:86
7c288c8659e8ce4ad70872ed93405dab6e46132c###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###main:String Instrumentation ###inst.appendToSystemClassLoaderSearch(newJarFile(f));###jf###newJarFile(f)###131:25:131:78
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new MethodCallInstrumentor###onAfterCallMethod:int String String String ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###676:45:676:98
18dc8fd2d6c30a838c3f62fc53a98770cd4659d2###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/ProbeDescriptorLoader.java###/ProbeDescriptorLoader.java###com.sun.btrace.runtime.ProbeDescriptorLoader###findFile:String ###Filef=newFile(dir.trim(),namespace.trim()+".xml");###desc###namespace.trim()+".xml"###100:13:100:70
1d9fa20c45a55787d9c794c009bc9b1ec7b9cab0###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Preprocessor.java###/Preprocessor.java###com.sun.btrace.runtime.Preprocessor.visitMethod.new MethodVisitor###visitFieldInsn:int String String String ###if(exportFields.get(name)!=null)###fd###exportFields.get(name)###726:25:733:26
e5256361cc509816fdf9352ed8b142cb019e9e69###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Preprocessor.java###/Preprocessor.java###com.sun.btrace.runtime.Preprocessor###getClassifier:MethodNode ###for(an:getAnnotations(mn))###annots###getAnnotations(mn)###671:9:679:10
e5acd751d96ad5fca346ac009d10baf92319b11c###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.mri.new MethodReturnInstrumentor###callAction:int ###retValIndex=storeNewLocal(getReturnType());###probeRetType###getReturnType()###1346:33:1346:78
ca049f0a819fced8f43b4410236a5af4899ac822###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.mri.new MethodReturnInstrumentor###callAction:int ###retValIndex=storeNewLocal(getReturnType());###probeRetType###getReturnType()###1443:33:1443:78
4e285a8f227376f07ca7004bfb73aa36c17b5e3b###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Preprocessor.java###/Preprocessor.java###com.sun.btrace.runtime.Preprocessor###visitMethod:int String String String String[] ###returnnewMethodVisitor(Opcodes.ASM4,newLocalVariableHelperImpl(adaptee,access,desc)){privatebooleanisBTraceHandler=false;privatefinalLabelstart=newLabel();privatefinalLabelhandler=newLabel();privateintnextVar=0;privatefinalAssemblerasm=newAssembler(this);privatevoidgenerateExportGet(Stringname,Stringdesc){inttypeCode=desc.charAt(0);switch(typeCode){case'[':asm.loadNull();break;case'L':if(desc.equals(JAVA_LANG_STRING_DESC)){asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFSTRING,BTRACE_RUNTIME_GET_PERFSTRING_DESC);}else{asm.loadNull();}break;case'Z':case'C':case'B':case'S':case'I':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFINT,BTRACE_RUNTIME_GET_PERFINT_DESC);break;case'J':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFLONG,BTRACE_RUNTIME_GET_PERFLONG_DESC);break;case'F':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFFLOAT,BTRACE_RUNTIME_GET_PERFFLOAT_DESC);break;case'D':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_GET_PERFDOUBLE,BTRACE_RUNTIME_GET_PERFDOUBLE_DESC);break;}}privatevoidgenerateExportPut(Stringname,Stringdesc){inttypeCode=desc.charAt(0);switch(typeCode){case'[':asm.pop();break;case'L':if(desc.equals(JAVA_LANG_STRING_DESC)){asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFSTRING,BTRACE_RUNTIME_PUT_PERFSTRING_DESC);}else{asm.pop();}break;case'Z':case'C':case'B':case'S':case'I':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFINT,BTRACE_RUNTIME_PUT_PERFINT_DESC);break;case'J':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFLONG,BTRACE_RUNTIME_PUT_PERFLONG_DESC);break;case'F':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFFLOAT,BTRACE_RUNTIME_PUT_PERFFLOAT_DESC);break;case'D':asm.ldc(name).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_PUT_PERFDOUBLE,BTRACE_RUNTIME_PUT_PERFDOUBLE_DESC);break;}}privatevoidgenerateThreadLocalGet(FieldDescriptorfd){if(isClassInitializer){if(fd.initialized){asm.loadLocal(Type.getType(fd.desc),fd.var);}elseif(fd.value!=null){asm.ldc(fd.value);}else{asm.defaultValue(fd.desc);}}else{StringfieldName=BTRACE_FIELD_PREFIX+fd.name;asm.getStatic(className,fieldName,JAVA_LANG_THREAD_LOCAL_DESC).invokeVirtual(JAVA_LANG_THREAD_LOCAL,JAVA_LANG_THREAD_LOCAL_GET,JAVA_LANG_THREAD_LOCAL_GET_DESC).unbox(fd.desc);}}privatevoidgenerateThreadLocalPut(FieldDescriptorfd){if(isClassInitializer){asm.storeLocal(Type.getType(fd.desc),fd.var);fd.initialized=true;}else{StringfieldName=BTRACE_FIELD_PREFIX+fd.name;asm.box(fd.desc).getStatic(className,fieldName,JAVA_LANG_THREAD_LOCAL_DESC).swap().invokeVirtual(JAVA_LANG_THREAD_LOCAL,JAVA_LANG_THREAD_LOCAL_SET,JAVA_LANG_THREAD_LOCAL_SET_DESC);}}@OverridepublicAnnotationVisitorvisitAnnotation(Stringname,booleanbln){if(name.startsWith("Lcom/sun/btrace/annotations/")){isBTraceHandler=true;}else{isBTraceHandler=false;}returnsuper.visitAnnotation(name,bln);}publicvoidvisitCode(){if(isClassInitializer||isBTraceHandler){visitTryCatchBlock(start,handler,handler,JAVA_LANG_THROWABLE);if(isClassInitializer){asm.ldc(classType).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_FOR_CLASS,BTRACE_RUNTIME_FOR_CLASS_DESC).putStatic(className,BTRACE_RUNTIME_FIELD_NAME,BTRACE_RUNTIME_DESC);}asm.getStatic(className,BTRACE_RUNTIME_FIELD_NAME,BTRACE_RUNTIME_DESC).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_ENTER,BTRACE_RUNTIME_ENTER_DESC);if(isClassInitializer){for(FieldDescriptorfd:threadLocalFields.values()){fd.var=nextVar;nextVar+=Type.getType(fd.desc).getSize();}for(FieldDescriptorfd:exportFields.values()){asm.ldc(perfCounterName(fd.name)).ldc(fd.desc);if(fd.value==null){asm.loadNull();}else{asm.ldc(fd.value).box(fd.desc);}asm.invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_NEW_PERFCOUNTER,BTRACE_RUNTIME_NEW_PERFCOUNTER_DESC);}}visitJumpInsn(IFNE,start);super.visitInsn(RETURN);visitLabel(start);}super.visitCode();}publicvoidvisitFieldInsn(intopcode,Stringowner,Stringname,Stringdesc){StringfieldName=name;if(owner.equals(className)){if(exportFields.get(name)!=null){if(opcode==GETSTATIC){generateExportGet(perfCounterName(name),desc);}else{generateExportPut(perfCounterName(name),desc);}return;}if(!name.equals(BTRACE_RUNTIME_FIELD_NAME)){fieldName=BTRACE_FIELD_PREFIX+name;}FieldDescriptorfd=threadLocalFields.get(name);if(fd!=null){if(opcode==GETSTATIC){generateThreadLocalGet(fd);}else{generateThreadLocalPut(fd);}return;}}super.visitFieldInsn(opcode,owner,fieldName,desc);}publicvoidvisitVarInsn(intopcode,intvar){super.visitVarInsn(opcode,var+nextVar);}publicvoidvisitInsn(intopcode){if(opcode==RETURN){if(isClassInitializer){for(FieldDescriptorfd:threadLocalFields.values()){generateThreadLocalGet(fd);asm.box(fd.desc).invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_NEW_THREAD_LOCAL,BTRACE_RUNTIME_NEW_THREAD_LOCAL_DESC).putStatic(className,BTRACE_FIELD_PREFIX+fd.name,JAVA_LANG_THREAD_LOCAL_DESC);}asm.invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_START,BTRACE_RUNTIME_START_DESC);}else{if(isBTraceHandler){asm.invokeStatic(BTRACE_RUNTIME,BTRACE_RUNTIME_LEAVE,BTRACE_RUNTIME_LEAVE_DESC);}}}super.visitInsn(opcode);}@OverridepublicvoidvisitMethodInsn(intopcode,Stringowner,Stringname,Stringdesc,booleanitf){if(owner.equals(Type.getInternalName(StringBuilder.class))){if(name.equals("append")){if(desc.equals(Type.getMethodDescriptor(Type.getType(StringBuilder.class),Type.getType(Object.class)))){super.visitMethodInsn(Opcodes.INVOKESTATIC,Type.getInternalName(BTraceRuntime.class),"safeStr",Type.getMethodDescriptor(Type.getType(String.class),Type.getType(Object.class)),false);desc=Type.getMethodDescriptor(Type.getType(StringBuilder.class),Type.getType(String.class));}}}super.visitMethodInsn(opcode,owner,name,desc,itf);}publicvoidvisitMaxs(intmaxStack,intmaxLocals){visitLabel(handler);if(isBTraceHandler){visitMethodInsn(INVOKESTATIC,BTRACE_RUNTIME,BTRACE_RUNTIME_HANDLE_EXCEPTION,BTRACE_RUNTIME_HANDLE_EXCEPTION_DESC);}super.visitInsn(RETURN);super.visitMaxs(maxStack,maxLocals);}};###lvh###newLocalVariableHelperImpl(adaptee,access,desc)###526:13:822:15
7423953220d88da41434436b4928894d977714de###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new MethodCallInstrumentor###onBeforeCallMethod:int String String String ###backupArgsIndices=backupStack(Type.getArgumentTypes(desc),isStaticCall);###argTypes###Type.getArgumentTypes(desc)###471:33:471:108
f6feab5da52dcdebc86845fb7dcddcfcbc092100###/btraceio_btrace/src/share/classes/com/sun/btrace/agent/Main.java###/Main.java###com.sun.btrace.agent.Main###parseArgs:###loadDefaultArguments(argMap.get("config"));###config###argMap.get("config")###285:9:285:52
c738c13d8e81b8dcb44210bb89e8c2f3b737570f###/btraceio_btrace/src/share/classes/com/sun/btrace/util/LocalVariableHelperImpl.java###/LocalVariableHelperImpl.java###com.sun.btrace.util.LocalVariableHelperImpl###remap:int Type ###intkey=2*sVar+type.getSize()-1;###tSize###type.getSize()###319:9:319:49
9bc65961e7cbefde758f36d3131b78ee6f1268d9###/btraceio_btrace/src/share/classes/com/sun/btrace/profiling/MethodInvocationProfiler.java###/MethodInvocationProfiler.java###com.sun.btrace.profiling.MethodInvocationProfiler.MethodInvocationRecorder###compactMeasured:###newIndex=lastIndex++;###lastMeasurePtr###lastIndex###157:25:157:48
d6ecf78da1dbc5fee086d73caef830f1211bc165###/btraceio_btrace/src/test/com/sun/btrace/TestBTraceUtils.java###/TestBTraceUtils.java###com.sun.btrace.TestBTraceUtils###setup:###btraceExtPath=btraceExtPath+File.pathSeparator+elem;###toolsjar###elem###76:17:76:75
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new ObjectAllocInstrumentor###beforeObjectNew:String ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1309:41:1309:94
1b229f87de40b5b23464f17a7a56efe56ab1a4cc###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Preprocessor.java###/Preprocessor.java###com.sun.btrace.runtime.Preprocessor.visitMethod.new MethodVisitor###visitFieldInsn:int String String String ###if(exportFields.get(name)!=null)###fd###exportFields.get(name)###725:25:732:26
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new TypeCheckInstrumentor###callAction:int String ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1203:33:1203:86
d5e1672a1a905441cb763f290ff3ddae76dd79d3###/btraceio_btrace/src/share/classes/com/sun/btrace/profiling/MethodInvocationProfiler.java###/MethodInvocationProfiler.java###com.sun.btrace.profiling.MethodInvocationProfiler.MethodInvocationRecorder###compactMeasured:###newIndex=lastIndex++;###lastMeasurePtr###lastIndex###160:25:160:48
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new ArrayAllocInstrumentor###onAfterArrayNew:String int ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1418:41:1418:94
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.mri.new MethodReturnInstrumentor###onMethodReturn:int ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1510:33:1510:86
9afa65a97992151033a7e63ba120a04b5690da8d###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/ClassFilter.java###/ClassFilter.java###com.sun.btrace.runtime.ClassFilter###isSubTypeOf:String ClassLoader String[] ###for(sCi:ci.getSupertypes(false))###sTypesInfo###ci.getSupertypes(false)###224:9:226:10
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new MethodReturnInstrumentor###onMethodEntry:###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###851:33:851:86
b2ea50896e8609a3eae37508ded4b13159821f2a###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/Instrumentor.java###/Instrumentor.java###com.sun.btrace.runtime.Instrumentor.instrumentorFor.new ArrayAllocInstrumentor###onBeforeArrayNew:String int ###asm.addLevelCheck(btraceClassName,om.getLevel(),l);###level###om.getLevel()###1380:41:1380:94
18dc8fd2d6c30a838c3f62fc53a98770cd4659d2###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/ProbeDescriptorLoader.java###/ProbeDescriptorLoader.java###com.sun.btrace.runtime.ProbeDescriptorLoader###findFile:String ###returnnull;###is###null###108:9:108:21
d5e8a3aafba9217425cbf217ff21dd947dd89fff###/btraceio_btrace/src/share/classes/com/sun/btrace/runtime/BTraceProbeFactory.java###/BTraceProbeFactory.java###com.sun.btrace.runtime.BTraceProbeFactory###createProbe:InputStream ###returnbpp;###bp###bpp###83:17:83:28
