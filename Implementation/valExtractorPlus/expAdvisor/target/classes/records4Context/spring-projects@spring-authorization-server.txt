16e4f5130b90ed1053e616cc68c45063c0eb218c###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/oauth2/server/authorization/oidc/authentication/OidcClientRegistrationAuthenticationProvider.java###/OidcClientRegistrationAuthenticationProvider.java###org.springframework.security.oauth2.server.authorization.oidc.authentication.OidcClientRegistrationAuthenticationProvider###createClient:OidcClientRegistration ###builder.clientSettings(ClientSettings.builder().requireProofKey(true).requireAuthorizationConsent(true).build()).tokenSettings(TokenSettings.builder().idTokenSignatureAlgorithm(SignatureAlgorithm.RS256).build());###clientSettingsBuilder###ClientSettings.builder().requireProofKey(true).requireAuthorizationConsent(true)###365:3:372:17
088d9a8e3419ea96756d53935fcb63c28a758972###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationProvider.java###/OAuth2ClientAuthenticationProvider.java###org.springframework.security.oauth2.server.authorization.authentication.OAuth2ClientAuthenticationProvider###authenticate:Authentication ###authenticatedCredentials=authenticatedCredentials||authenticatePkceIfAvailable(clientAuthentication,registeredClient);###pkceAuthenticated###authenticatePkceIfAvailable(clientAuthentication,registeredClient)###117:3:118:73
32414451f5163235739c045a3ce361bcc2eec599###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/config/annotation/web/configurers/oauth2/server/authorization/OAuth2ConfigurerUtils.java###/OAuth2ConfigurerUtils.java###org.springframework.security.config.annotation.web.configurers.oauth2.server.authorization.OAuth2ConfigurerUtils###getTokenGenerator:B ###JwtGeneratorjwtGenerator=newJwtGenerator(getJwtEncoder(builder));###jwtEncoder###getJwtEncoder(builder)###96:5:96:74
666d569b489c09fa98b7c7898efc49ef0a289adc###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/oauth2/server/authorization/web/OAuth2AuthorizationServerMetadataEndpointFilter.java###/OAuth2AuthorizationServerMetadataEndpointFilter.java###org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter###doFilterInternal:HttpServletRequest HttpServletResponse FilterChain ###OAuth2AuthorizationServerMetadataauthorizationServerMetadata=OAuth2AuthorizationServerMetadata.builder().issuer(this.providerSettings.getIssuer()).authorizationEndpoint(asUrl(this.providerSettings.getIssuer(),this.providerSettings.getAuthorizationEndpoint())).tokenEndpoint(asUrl(this.providerSettings.getIssuer(),this.providerSettings.getTokenEndpoint())).tokenEndpointAuthenticationMethods(clientAuthenticationMethods()).jwkSetUrl(asUrl(this.providerSettings.getIssuer(),this.providerSettings.getJwkSetEndpoint())).responseType(OAuth2AuthorizationResponseType.CODE.getValue()).grantType(AuthorizationGrantType.AUTHORIZATION_CODE.getValue()).grantType(AuthorizationGrantType.CLIENT_CREDENTIALS.getValue()).grantType(AuthorizationGrantType.REFRESH_TOKEN.getValue()).tokenRevocationEndpoint(asUrl(this.providerSettings.getIssuer(),this.providerSettings.getTokenRevocationEndpoint())).tokenRevocationEndpointAuthenticationMethods(clientAuthenticationMethods()).tokenIntrospectionEndpoint(asUrl(this.providerSettings.getIssuer(),this.providerSettings.getTokenIntrospectionEndpoint())).tokenIntrospectionEndpointAuthenticationMethods(clientAuthenticationMethods()).codeChallengeMethod("plain").codeChallengeMethod("S256").build();###issuer###this.providerSettings.getIssuer()###80:3:96:14
c2db8926dfb9fe4c0317bace396b687b342685dd###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/config/annotation/web/configurers/oauth2/server/authorization/OAuth2ClientAuthenticationConfigurer.java###/OAuth2ClientAuthenticationConfigurer.java###org.springframework.security.config.annotation.web.configurers.oauth2.server.authorization.OAuth2ClientAuthenticationConfigurer###createDefaultAuthenticationProviders:B ###OAuth2ClientAuthenticationProviderclientAuthenticationProvider=newOAuth2ClientAuthenticationProvider(OAuth2ConfigurerUtils.getRegisteredClientRepository(builder),OAuth2ConfigurerUtils.getAuthorizationService(builder));###authorizationService###OAuth2ConfigurerUtils.getAuthorizationService(builder)###161:3:164:63
32414451f5163235739c045a3ce361bcc2eec599###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/config/annotation/web/configurers/oauth2/server/authorization/OAuth2AuthorizationServerConfigurer.java###/OAuth2AuthorizationServerConfigurer.java###org.springframework.security.config.annotation.web.configurers.oauth2.server.authorization.OAuth2AuthorizationServerConfigurer###configure:B ###NimbusJwkSetEndpointFilterjwkSetEndpointFilter=newNimbusJwkSetEndpointFilter(OAuth2ConfigurerUtils.getJwkSource(builder),providerSettings.getJwkSetEndpoint());###jwkSource###OAuth2ConfigurerUtils.getJwkSource(builder)###370:3:373:45
c799261a72b5d2f345afbcce920390473651f53d###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/config/annotation/web/configurers/oauth2/server/authorization/OAuth2TokenEndpointConfigurer.java###/OAuth2TokenEndpointConfigurer.java###org.springframework.security.config.annotation.web.configurers.oauth2.server.authorization.OAuth2TokenEndpointConfigurer###createDefaultAuthenticationProviders:B ###OAuth2AuthorizationCodeAuthenticationProviderauthorizationCodeAuthenticationProvider=newOAuth2AuthorizationCodeAuthenticationProvider(OAuth2ConfigurerUtils.getAuthorizationService(builder),jwtEncoder);###authorizationService###OAuth2ConfigurerUtils.getAuthorizationService(builder)###166:3:169:19
385fc37b1daef7af5e470ecee2c267a90a0ea46c###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/oauth2/server/authorization/authentication/OAuth2RefreshTokenAuthenticationProvider.java###/OAuth2RefreshTokenAuthenticationProvider.java###org.springframework.security.oauth2.server.authorization.authentication.OAuth2RefreshTokenAuthenticationProvider###authenticate:Authentication ###authorization=OAuth2Authorization.from(authorization).token(accessToken,(metadata)->metadata.put(OAuth2Authorization.Token.CLAIMS_METADATA_NAME,jwtAccessToken.getClaims())).refreshToken(currentRefreshToken).build();###authorizationBuilder###OAuth2Authorization.from(authorization).token(accessToken,(metadata)->metadata.put(OAuth2Authorization.Token.CLAIMS_METADATA_NAME,jwtAccessToken.getClaims())).refreshToken(currentRefreshToken)###178:3:183:14
32414451f5163235739c045a3ce361bcc2eec599###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/oauth2/server/authorization/client/JdbcRegisteredClientRepository.java###/JdbcRegisteredClientRepository.java###org.springframework.security.oauth2.server.authorization.client.JdbcRegisteredClientRepository.RegisteredClientRowMapper###mapRow:ResultSet int ###builder.tokenSettings(TokenSettings.withSettings(tokenSettingsMap).build());###tokenSettingsBuilder###TokenSettings.withSettings(tokenSettingsMap)###244:4:244:80
4ccdd2baf4d3df8324fdd663144053142e88d70d###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/oauth2/server/authorization/authentication/OAuth2TokenIntrospectionAuthenticationProvider.java###/OAuth2TokenIntrospectionAuthenticationProvider.java###org.springframework.security.oauth2.server.authorization.authentication.OAuth2TokenIntrospectionAuthenticationProvider###withActiveTokenClaims:OAuth2Authorization.Token<AbstractOAuth2Token> RegisteredClient ###tokenClaims.issuer(jwtClaims.getIssuer().toExternalForm());###issuer###jwtClaims.getIssuer()###137:5:137:64
c2db8926dfb9fe4c0317bace396b687b342685dd###/spring-projects_spring-authorization-server/oauth2-authorization-server/src/main/java/org/springframework/security/config/annotation/web/configurers/oauth2/server/authorization/OAuth2ClientAuthenticationConfigurer.java###/OAuth2ClientAuthenticationConfigurer.java###org.springframework.security.config.annotation.web.configurers.oauth2.server.authorization.OAuth2ClientAuthenticationConfigurer###createDefaultAuthenticationProviders:B ###OAuth2ClientAuthenticationProviderclientAuthenticationProvider=newOAuth2ClientAuthenticationProvider(OAuth2ConfigurerUtils.getRegisteredClientRepository(builder),OAuth2ConfigurerUtils.getAuthorizationService(builder));###registeredClientRepository###OAuth2ConfigurerUtils.getRegisteredClientRepository(builder)###161:3:164:63
