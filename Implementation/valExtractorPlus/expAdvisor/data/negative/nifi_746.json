{
    "id": 746,
    "expression": "dtoFactory",
    "projectName": "nifi",
    "commitID": "c70a86eac00c149f8d9036db02525d9483bfd809",
    "filePath": "nifi-nar-bundles/nifi-framework-bundle/nifi-framework/nifi-web/nifi-web-api/src/main/java/org/apache/nifi/web/util/SnippetUtils.java",
    "occurrences": 15,
    "isArithmeticExpression": 1,
    "isGetTypeMethod": 1,
    "expressionList": [
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 456,
                "startColumnNumber": 57,
                "endLineNumber": 456,
                "endColumnNumber": 67
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 27,
                        "startLineNumber": 456,
                        "startColumnNumber": 57,
                        "endLineNumber": 456,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "dtoFactory.copy(serviceDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 37,
                        "startLineNumber": 456,
                        "startColumnNumber": 47,
                        "endLineNumber": 456,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "service=dtoFactory.copy(serviceDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 65,
                        "startLineNumber": 456,
                        "startColumnNumber": 20,
                        "endLineNumber": 456,
                        "endColumnNumber": 85
                    },
                    "nodeContext": "final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 979,
                        "startLineNumber": 455,
                        "startColumnNumber": 102,
                        "endLineNumber": 470,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n  service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n  service.setState(ControllerServiceState.DISABLED.name());\n  services.add(service);\n  serviceIdMap.put(serviceDTO.getId(),service.getId());\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 77,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1065,
                        "startLineNumber": 455,
                        "startColumnNumber": 16,
                        "endLineNumber": 470,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n  final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n  service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n  service.setState(ControllerServiceState.DISABLED.name());\n  services.add(service);\n  serviceIdMap.put(serviceDTO.getId(),service.getId());\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 86,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1097,
                        "startLineNumber": 454,
                        "startColumnNumber": 65,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1150,
                        "startLineNumber": 454,
                        "startColumnNumber": 12,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getControllerServices() != null) {\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 93,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 65,
                    "startLineNumber": 456,
                    "startColumnNumber": 20,
                    "endLineNumber": 456,
                    "endColumnNumber": 85
                },
                "nodeContext": "final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 499,
                "startColumnNumber": 43,
                "endLineNumber": 499,
                "endColumnNumber": 53
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 25,
                        "startLineNumber": 499,
                        "startColumnNumber": 43,
                        "endLineNumber": 499,
                        "endColumnNumber": 68
                    },
                    "nodeContext": "dtoFactory.copy(labelDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 33,
                        "startLineNumber": 499,
                        "startColumnNumber": 35,
                        "endLineNumber": 499,
                        "endColumnNumber": 68
                    },
                    "nodeContext": "label=dtoFactory.copy(labelDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 49,
                        "startLineNumber": 499,
                        "startColumnNumber": 20,
                        "endLineNumber": 499,
                        "endColumnNumber": 69
                    },
                    "nodeContext": "final LabelDTO label=dtoFactory.copy(labelDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 707,
                        "startLineNumber": 498,
                        "startColumnNumber": 76,
                        "endLineNumber": 510,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final LabelDTO label=dtoFactory.copy(labelDTO);\n  label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n  label.setParentGroupId(groupId);\n  labels.add(label);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 63,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 767,
                        "startLineNumber": 498,
                        "startColumnNumber": 16,
                        "endLineNumber": 510,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final LabelDTO labelDTO : snippetContents.getLabels()) {\n  final LabelDTO label=dtoFactory.copy(labelDTO);\n  label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n  label.setParentGroupId(groupId);\n  labels.add(label);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 72,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 799,
                        "startLineNumber": 497,
                        "startColumnNumber": 53,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 73,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 840,
                        "startLineNumber": 497,
                        "startColumnNumber": 12,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getLabels() != null) {\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 79,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 49,
                    "startLineNumber": 499,
                    "startColumnNumber": 20,
                    "endLineNumber": 499,
                    "endColumnNumber": 69
                },
                "nodeContext": "final LabelDTO label=dtoFactory.copy(labelDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 526,
                "startColumnNumber": 41,
                "endLineNumber": 526,
                "endColumnNumber": 51
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 26,
                        "startLineNumber": 526,
                        "startColumnNumber": 41,
                        "endLineNumber": 526,
                        "endColumnNumber": 67
                    },
                    "nodeContext": "dtoFactory.copy(funnelDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 31,
                        "startLineNumber": 526,
                        "startColumnNumber": 36,
                        "endLineNumber": 526,
                        "endColumnNumber": 67
                    },
                    "nodeContext": "cp=dtoFactory.copy(funnelDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 48,
                        "startLineNumber": 526,
                        "startColumnNumber": 20,
                        "endLineNumber": 526,
                        "endColumnNumber": 68
                    },
                    "nodeContext": "final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 825,
                        "startLineNumber": 525,
                        "startColumnNumber": 79,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 79,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 888,
                        "startLineNumber": 525,
                        "startColumnNumber": 16,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 88,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 920,
                        "startLineNumber": 524,
                        "startColumnNumber": 54,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 89,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 962,
                        "startLineNumber": 524,
                        "startColumnNumber": 12,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getFunnels() != null) {\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 95,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 48,
                    "startLineNumber": 526,
                    "startColumnNumber": 20,
                    "endLineNumber": 526,
                    "endColumnNumber": 68
                },
                "nodeContext": "final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 531,
                "startColumnNumber": 95,
                "endLineNumber": 531,
                "endColumnNumber": 105
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 35,
                        "startLineNumber": 531,
                        "startColumnNumber": 95,
                        "endLineNumber": 531,
                        "endColumnNumber": 130
                    },
                    "nodeContext": "dtoFactory.createConnectableDto(cp)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 111,
                        "startLineNumber": 531,
                        "startColumnNumber": 20,
                        "endLineNumber": 531,
                        "endColumnNumber": 131
                    },
                    "nodeContext": "connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 15,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 112,
                        "startLineNumber": 531,
                        "startColumnNumber": 20,
                        "endLineNumber": 531,
                        "endColumnNumber": 132
                    },
                    "nodeContext": "connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 16,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 825,
                        "startLineNumber": 525,
                        "startColumnNumber": 79,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 79,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 888,
                        "startLineNumber": 525,
                        "startColumnNumber": 16,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 88,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 920,
                        "startLineNumber": 524,
                        "startColumnNumber": 54,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 89,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 962,
                        "startLineNumber": 524,
                        "startColumnNumber": 12,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getFunnels() != null) {\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 95,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 112,
                    "startLineNumber": 531,
                    "startColumnNumber": 20,
                    "endLineNumber": 531,
                    "endColumnNumber": 132
                },
                "nodeContext": "connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 16,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 546,
                "startColumnNumber": 39,
                "endLineNumber": 546,
                "endColumnNumber": 49
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 24,
                        "startLineNumber": 546,
                        "startColumnNumber": 39,
                        "endLineNumber": 546,
                        "endColumnNumber": 63
                    },
                    "nodeContext": "dtoFactory.copy(portDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 29,
                        "startLineNumber": 546,
                        "startColumnNumber": 34,
                        "endLineNumber": 546,
                        "endColumnNumber": 63
                    },
                    "nodeContext": "cp=dtoFactory.copy(portDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 44,
                        "startLineNumber": 546,
                        "startColumnNumber": 20,
                        "endLineNumber": 546,
                        "endColumnNumber": 64
                    },
                    "nodeContext": "final PortDTO cp=dtoFactory.copy(portDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1193,
                        "startLineNumber": 545,
                        "startColumnNumber": 78,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 545,
                        "startColumnNumber": 16,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getInputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 544,
                        "startColumnNumber": 57,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 544,
                        "startColumnNumber": 12,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getInputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 44,
                    "startLineNumber": 546,
                    "startColumnNumber": 20,
                    "endLineNumber": 546,
                    "endColumnNumber": 64
                },
                "nodeContext": "final PortDTO cp=dtoFactory.copy(portDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 552,
                "startColumnNumber": 59,
                "endLineNumber": 552,
                "endColumnNumber": 69
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 63,
                        "startLineNumber": 552,
                        "startColumnNumber": 59,
                        "endLineNumber": 552,
                        "endColumnNumber": 122
                    },
                    "nodeContext": "dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 81,
                        "startLineNumber": 552,
                        "startColumnNumber": 41,
                        "endLineNumber": 552,
                        "endColumnNumber": 122
                    },
                    "nodeContext": "portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 9,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 103,
                        "startLineNumber": 552,
                        "startColumnNumber": 20,
                        "endLineNumber": 552,
                        "endColumnNumber": 123
                    },
                    "nodeContext": "final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 13,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1193,
                        "startLineNumber": 545,
                        "startColumnNumber": 78,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 545,
                        "startColumnNumber": 16,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getInputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 544,
                        "startColumnNumber": 57,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 544,
                        "startColumnNumber": 12,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getInputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 103,
                    "startLineNumber": 552,
                    "startColumnNumber": 20,
                    "endLineNumber": 552,
                    "endColumnNumber": 123
                },
                "nodeContext": "final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 13,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 571,
                "startColumnNumber": 39,
                "endLineNumber": 571,
                "endColumnNumber": 49
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 24,
                        "startLineNumber": 571,
                        "startColumnNumber": 39,
                        "endLineNumber": 571,
                        "endColumnNumber": 63
                    },
                    "nodeContext": "dtoFactory.copy(portDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 29,
                        "startLineNumber": 571,
                        "startColumnNumber": 34,
                        "endLineNumber": 571,
                        "endColumnNumber": 63
                    },
                    "nodeContext": "cp=dtoFactory.copy(portDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 44,
                        "startLineNumber": 571,
                        "startColumnNumber": 20,
                        "endLineNumber": 571,
                        "endColumnNumber": 64
                    },
                    "nodeContext": "final PortDTO cp=dtoFactory.copy(portDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1197,
                        "startLineNumber": 570,
                        "startColumnNumber": 79,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1260,
                        "startLineNumber": 570,
                        "startColumnNumber": 16,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getOutputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1292,
                        "startLineNumber": 569,
                        "startColumnNumber": 58,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1338,
                        "startLineNumber": 569,
                        "startColumnNumber": 12,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getOutputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 44,
                    "startLineNumber": 571,
                    "startColumnNumber": 20,
                    "endLineNumber": 571,
                    "endColumnNumber": 64
                },
                "nodeContext": "final PortDTO cp=dtoFactory.copy(portDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 577,
                "startColumnNumber": 59,
                "endLineNumber": 577,
                "endColumnNumber": 69
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 64,
                        "startLineNumber": 577,
                        "startColumnNumber": 59,
                        "endLineNumber": 577,
                        "endColumnNumber": 123
                    },
                    "nodeContext": "dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 82,
                        "startLineNumber": 577,
                        "startColumnNumber": 41,
                        "endLineNumber": 577,
                        "endColumnNumber": 123
                    },
                    "nodeContext": "portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 9,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 104,
                        "startLineNumber": 577,
                        "startColumnNumber": 20,
                        "endLineNumber": 577,
                        "endColumnNumber": 124
                    },
                    "nodeContext": "final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 13,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1197,
                        "startLineNumber": 570,
                        "startColumnNumber": 79,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1260,
                        "startLineNumber": 570,
                        "startColumnNumber": 16,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getOutputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1292,
                        "startLineNumber": 569,
                        "startColumnNumber": 58,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1338,
                        "startLineNumber": 569,
                        "startColumnNumber": 12,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getOutputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 104,
                    "startLineNumber": 577,
                    "startColumnNumber": 20,
                    "endLineNumber": 577,
                    "endColumnNumber": 124
                },
                "nodeContext": "final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 13,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 599,
                "startColumnNumber": 44,
                "endLineNumber": 599,
                "endColumnNumber": 54
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 29,
                        "startLineNumber": 599,
                        "startColumnNumber": 44,
                        "endLineNumber": 599,
                        "endColumnNumber": 73
                    },
                    "nodeContext": "dtoFactory.copy(processorDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 34,
                        "startLineNumber": 599,
                        "startColumnNumber": 39,
                        "endLineNumber": 599,
                        "endColumnNumber": 73
                    },
                    "nodeContext": "cp=dtoFactory.copy(processorDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 54,
                        "startLineNumber": 599,
                        "startColumnNumber": 20,
                        "endLineNumber": 599,
                        "endColumnNumber": 74
                    },
                    "nodeContext": "final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1183,
                        "startLineNumber": 598,
                        "startColumnNumber": 88,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 598,
                        "startColumnNumber": 16,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 597,
                        "startColumnNumber": 57,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 597,
                        "startColumnNumber": 12,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessors() != null) {\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 54,
                    "startLineNumber": 599,
                    "startColumnNumber": 20,
                    "endLineNumber": 599,
                    "endColumnNumber": 74
                },
                "nodeContext": "final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 609,
                "startColumnNumber": 101,
                "endLineNumber": 609,
                "endColumnNumber": 111
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 35,
                        "startLineNumber": 609,
                        "startColumnNumber": 101,
                        "endLineNumber": 609,
                        "endColumnNumber": 136
                    },
                    "nodeContext": "dtoFactory.createConnectableDto(cp)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 117,
                        "startLineNumber": 609,
                        "startColumnNumber": 20,
                        "endLineNumber": 609,
                        "endColumnNumber": 137
                    },
                    "nodeContext": "connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 15,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 118,
                        "startLineNumber": 609,
                        "startColumnNumber": 20,
                        "endLineNumber": 609,
                        "endColumnNumber": 138
                    },
                    "nodeContext": "connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 16,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1183,
                        "startLineNumber": 598,
                        "startColumnNumber": 88,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 598,
                        "startColumnNumber": 16,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 597,
                        "startColumnNumber": 57,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 597,
                        "startColumnNumber": 12,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessors() != null) {\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 118,
                    "startLineNumber": 609,
                    "startColumnNumber": 20,
                    "endLineNumber": 609,
                    "endColumnNumber": 138
                },
                "nodeContext": "connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 16,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 631,
                "startColumnNumber": 47,
                "endLineNumber": 631,
                "endColumnNumber": 57
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 32,
                        "startLineNumber": 631,
                        "startColumnNumber": 47,
                        "endLineNumber": 631,
                        "endColumnNumber": 79
                    },
                    "nodeContext": "dtoFactory.copy(groupDTO,false)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 5,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 37,
                        "startLineNumber": 631,
                        "startColumnNumber": 42,
                        "endLineNumber": 631,
                        "endColumnNumber": 79
                    },
                    "nodeContext": "cp=dtoFactory.copy(groupDTO,false)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 60,
                        "startLineNumber": 631,
                        "startColumnNumber": 20,
                        "endLineNumber": 631,
                        "endColumnNumber": 80
                    },
                    "nodeContext": "final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 11,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1061,
                        "startLineNumber": 630,
                        "startColumnNumber": 90,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1135,
                        "startLineNumber": 630,
                        "startColumnNumber": 16,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 96,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1167,
                        "startLineNumber": 629,
                        "startColumnNumber": 60,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 97,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1215,
                        "startLineNumber": 629,
                        "startColumnNumber": 12,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessGroups() != null) {\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 103,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 60,
                    "startLineNumber": 631,
                    "startColumnNumber": 20,
                    "endLineNumber": 631,
                    "endColumnNumber": 80
                },
                "nodeContext": "final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 11,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 653,
                "startColumnNumber": 53,
                "endLineNumber": 653,
                "endColumnNumber": 63
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 31,
                        "startLineNumber": 653,
                        "startColumnNumber": 53,
                        "endLineNumber": 653,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "dtoFactory.copy(remoteGroupDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 36,
                        "startLineNumber": 653,
                        "startColumnNumber": 48,
                        "endLineNumber": 653,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "cp=dtoFactory.copy(remoteGroupDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 65,
                        "startLineNumber": 653,
                        "startColumnNumber": 20,
                        "endLineNumber": 653,
                        "endColumnNumber": 85
                    },
                    "nodeContext": "final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 65,
                    "startLineNumber": 653,
                    "startColumnNumber": 20,
                    "endLineNumber": 653,
                    "endColumnNumber": 85
                },
                "nodeContext": "final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 661,
                "startColumnNumber": 98,
                "endLineNumber": 661,
                "endColumnNumber": 108
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 78,
                        "startLineNumber": 661,
                        "startColumnNumber": 98,
                        "endLineNumber": 661,
                        "endColumnNumber": 176
                    },
                    "nodeContext": "dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 149,
                        "startLineNumber": 661,
                        "startColumnNumber": 28,
                        "endLineNumber": 661,
                        "endColumnNumber": 177
                    },
                    "nodeContext": "connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 18,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 150,
                        "startLineNumber": 661,
                        "startColumnNumber": 28,
                        "endLineNumber": 661,
                        "endColumnNumber": 178
                    },
                    "nodeContext": "connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 19,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 269,
                        "startLineNumber": 659,
                        "startColumnNumber": 100,
                        "endLineNumber": 662,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "{\n  remotePort.setGroupId(cp.getId());\n  connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 27,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 345,
                        "startLineNumber": 659,
                        "startColumnNumber": 24,
                        "endLineNumber": 662,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "for (final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n  remotePort.setGroupId(cp.getId());\n  connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 36,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 393,
                        "startLineNumber": 658,
                        "startColumnNumber": 78,
                        "endLineNumber": 663,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 37,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 451,
                        "startLineNumber": 658,
                        "startColumnNumber": 20,
                        "endLineNumber": 663,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (contents != null && contents.getInputPorts() != null) {\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 47,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 150,
                    "startLineNumber": 661,
                    "startColumnNumber": 28,
                    "endLineNumber": 661,
                    "endColumnNumber": 178
                },
                "nodeContext": "connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 19,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 667,
                "startColumnNumber": 98,
                "endLineNumber": 667,
                "endColumnNumber": 108
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 79,
                        "startLineNumber": 667,
                        "startColumnNumber": 98,
                        "endLineNumber": 667,
                        "endColumnNumber": 177
                    },
                    "nodeContext": "dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 150,
                        "startLineNumber": 667,
                        "startColumnNumber": 28,
                        "endLineNumber": 667,
                        "endColumnNumber": 178
                    },
                    "nodeContext": "connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 18,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 151,
                        "startLineNumber": 667,
                        "startColumnNumber": 28,
                        "endLineNumber": 667,
                        "endColumnNumber": 179
                    },
                    "nodeContext": "connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 19,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 270,
                        "startLineNumber": 665,
                        "startColumnNumber": 101,
                        "endLineNumber": 668,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "{\n  remotePort.setGroupId(cp.getId());\n  connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 27,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 347,
                        "startLineNumber": 665,
                        "startColumnNumber": 24,
                        "endLineNumber": 668,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "for (final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n  remotePort.setGroupId(cp.getId());\n  connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 36,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 395,
                        "startLineNumber": 664,
                        "startColumnNumber": 79,
                        "endLineNumber": 669,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 37,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 454,
                        "startLineNumber": 664,
                        "startColumnNumber": 20,
                        "endLineNumber": 669,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (contents != null && contents.getOutputPorts() != null) {\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 47,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 151,
                    "startLineNumber": 667,
                    "startColumnNumber": 28,
                    "endLineNumber": 667,
                    "endColumnNumber": 179
                },
                "nodeContext": "connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 19,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        },
        {
            "nodeContext": "dtoFactory",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 10,
                "startLineNumber": 686,
                "startColumnNumber": 45,
                "endLineNumber": 686,
                "endColumnNumber": 55
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 30,
                        "startLineNumber": 686,
                        "startColumnNumber": 45,
                        "endLineNumber": 686,
                        "endColumnNumber": 75
                    },
                    "nodeContext": "dtoFactory.copy(connectionDTO)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 4,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 35,
                        "startLineNumber": 686,
                        "startColumnNumber": 40,
                        "endLineNumber": 686,
                        "endColumnNumber": 75
                    },
                    "nodeContext": "cp=dtoFactory.copy(connectionDTO)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 56,
                        "startLineNumber": 686,
                        "startColumnNumber": 20,
                        "endLineNumber": 686,
                        "endColumnNumber": 76
                    },
                    "nodeContext": "final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1098,
                        "startLineNumber": 685,
                        "startColumnNumber": 91,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 98,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1173,
                        "startLineNumber": 685,
                        "startColumnNumber": 16,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 107,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1205,
                        "startLineNumber": 684,
                        "startColumnNumber": 58,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 108,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1251,
                        "startLineNumber": 684,
                        "startColumnNumber": 12,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getConnections() != null) {\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 114,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 56,
                    "startLineNumber": 686,
                    "startColumnNumber": 20,
                    "endLineNumber": 686,
                    "endColumnNumber": 76
                },
                "nodeContext": "final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 10,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "org.apache.nifi.web.api.dto.DtoFactory"
        }
    ],
    "positionList": [
        {
            "charLength": 10,
            "startLineNumber": 456,
            "startColumnNumber": 57,
            "endLineNumber": 456,
            "endColumnNumber": 67
        },
        {
            "charLength": 10,
            "startLineNumber": 499,
            "startColumnNumber": 43,
            "endLineNumber": 499,
            "endColumnNumber": 53
        },
        {
            "charLength": 10,
            "startLineNumber": 526,
            "startColumnNumber": 41,
            "endLineNumber": 526,
            "endColumnNumber": 51
        },
        {
            "charLength": 10,
            "startLineNumber": 531,
            "startColumnNumber": 95,
            "endLineNumber": 531,
            "endColumnNumber": 105
        },
        {
            "charLength": 10,
            "startLineNumber": 546,
            "startColumnNumber": 39,
            "endLineNumber": 546,
            "endColumnNumber": 49
        },
        {
            "charLength": 10,
            "startLineNumber": 552,
            "startColumnNumber": 59,
            "endLineNumber": 552,
            "endColumnNumber": 69
        },
        {
            "charLength": 10,
            "startLineNumber": 571,
            "startColumnNumber": 39,
            "endLineNumber": 571,
            "endColumnNumber": 49
        },
        {
            "charLength": 10,
            "startLineNumber": 577,
            "startColumnNumber": 59,
            "endLineNumber": 577,
            "endColumnNumber": 69
        },
        {
            "charLength": 10,
            "startLineNumber": 599,
            "startColumnNumber": 44,
            "endLineNumber": 599,
            "endColumnNumber": 54
        },
        {
            "charLength": 10,
            "startLineNumber": 609,
            "startColumnNumber": 101,
            "endLineNumber": 609,
            "endColumnNumber": 111
        },
        {
            "charLength": 10,
            "startLineNumber": 631,
            "startColumnNumber": 47,
            "endLineNumber": 631,
            "endColumnNumber": 57
        },
        {
            "charLength": 10,
            "startLineNumber": 653,
            "startColumnNumber": 53,
            "endLineNumber": 653,
            "endColumnNumber": 63
        },
        {
            "charLength": 10,
            "startLineNumber": 661,
            "startColumnNumber": 98,
            "endLineNumber": 661,
            "endColumnNumber": 108
        },
        {
            "charLength": 10,
            "startLineNumber": 667,
            "startColumnNumber": 98,
            "endLineNumber": 667,
            "endColumnNumber": 108
        },
        {
            "charLength": 10,
            "startLineNumber": 686,
            "startColumnNumber": 45,
            "endLineNumber": 686,
            "endColumnNumber": 55
        }
    ],
    "layoutRelationDataList": [
        {
            "firstKey": 0,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 3,
            "layout": 3
        },
        {
            "firstKey": 2,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 2,
            "layout": 3
        },
        {
            "firstKey": 3,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 5,
            "layout": 3
        },
        {
            "firstKey": 4,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 4,
            "layout": 3
        },
        {
            "firstKey": 5,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 7,
            "layout": 3
        },
        {
            "firstKey": 6,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 6,
            "layout": 3
        },
        {
            "firstKey": 7,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 9,
            "layout": 3
        },
        {
            "firstKey": 8,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 8,
            "layout": 3
        },
        {
            "firstKey": 9,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 12,
            "layout": 3
        },
        {
            "firstKey": 11,
            "secondKey": 13,
            "layout": 3
        },
        {
            "firstKey": 11,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 0,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 1,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 2,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 3,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 4,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 5,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 6,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 7,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 8,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 9,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 10,
            "layout": 11
        },
        {
            "firstKey": 12,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 14,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 0,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 1,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 2,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 3,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 4,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 5,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 6,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 7,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 8,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 9,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 10,
            "layout": 11
        },
        {
            "firstKey": 13,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 14,
            "layout": 11
        },
        {
            "firstKey": 14,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 13,
            "layout": 7
        }
    ]
}