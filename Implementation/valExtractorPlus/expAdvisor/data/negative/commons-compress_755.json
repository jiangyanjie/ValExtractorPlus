{
    "id": 755,
    "expression": "\"archive contains unparseable zip64 extra field\"",
    "projectName": "commons-compress",
    "commitID": "e3ea7b6607e7c96b9e2b6813c05bfba887c8e226",
    "filePath": "src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java",
    "occurrences": 1,
    "isArithmeticExpression": 1,
    "isGetTypeMethod": 1,
    "expressionList": [
        {
            "nodeContext": "\"archive contains unparseable zip64 extra field\"",
            "nodeType": "StringLiteral",
            "nodePosition": {
                "charLength": 48,
                "startLineNumber": 843,
                "startColumnNumber": 35,
                "endLineNumber": 843,
                "endColumnNumber": 83
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ThrowStatement,expression]",
                    "nodePosition": {
                        "charLength": 66,
                        "startLineNumber": 843,
                        "startColumnNumber": 18,
                        "endLineNumber": 843,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "new ZipException(\"archive contains unparseable zip64 extra field\")",
                    "nodeType": "ClassInstanceCreation",
                    "astNodeNumber": 4,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 73,
                        "startLineNumber": 843,
                        "startColumnNumber": 12,
                        "endLineNumber": 843,
                        "endColumnNumber": 85
                    },
                    "nodeContext": "throw new ZipException(\"archive contains unparseable zip64 extra field\");\n",
                    "nodeType": "ThrowStatement",
                    "astNodeNumber": 5,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 99,
                        "startLineNumber": 842,
                        "startColumnNumber": 85,
                        "endLineNumber": 844,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  throw new ZipException(\"archive contains unparseable zip64 extra field\");\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 6,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 176,
                        "startLineNumber": 842,
                        "startColumnNumber": 8,
                        "endLineNumber": 844,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "if (extra != null && !(extra instanceof Zip64ExtendedInformationExtraField)) {\n  throw new ZipException(\"archive contains unparseable zip64 extra field\");\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 17,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 1860,
                        "startLineNumber": 839,
                        "startColumnNumber": 27,
                        "endLineNumber": 878,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final ZipExtraField extra=ze.getExtraField(Zip64ExtendedInformationExtraField.HEADER_ID);\n  if (extra != null && !(extra instanceof Zip64ExtendedInformationExtraField)) {\n    throw new ZipException(\"archive contains unparseable zip64 extra field\");\n  }\n  final Zip64ExtendedInformationExtraField z64=(Zip64ExtendedInformationExtraField)extra;\n  if (z64 != null) {\n    final boolean hasUncompressedSize=ze.getSize() == ZIP64_MAGIC;\n    final boolean hasCompressedSize=ze.getCompressedSize() == ZIP64_MAGIC;\n    final boolean hasRelativeHeaderOffset=ze.getLocalHeaderOffset() == ZIP64_MAGIC;\n    final boolean hasDiskStart=ze.getDiskNumberStart() == ZIP64_MAGIC_SHORT;\n    z64.reparseCentralDirectoryData(hasUncompressedSize,hasCompressedSize,hasRelativeHeaderOffset,hasDiskStart);\n    if (hasUncompressedSize) {\n      ze.setSize(z64.getSize().getLongValue());\n    }\n else     if (hasCompressedSize) {\n      z64.setSize(new ZipEightByteInteger(ze.getSize()));\n    }\n    if (hasCompressedSize) {\n      ze.setCompressedSize(z64.getCompressedSize().getLongValue());\n    }\n else     if (hasUncompressedSize) {\n      z64.setCompressedSize(new ZipEightByteInteger(ze.getCompressedSize()));\n    }\n    if (hasRelativeHeaderOffset) {\n      ze.setLocalHeaderOffset(z64.getRelativeHeaderOffset().getLongValue());\n    }\n    if (hasDiskStart) {\n      ze.setDiskNumberStart(z64.getDiskStartNumber().getValue());\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 167,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 2509,
                        "startLineNumber": 826,
                        "startColumnNumber": 4,
                        "endLineNumber": 878,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "/** \n * If the entry holds a Zip64 extended information extra field, read sizes from there if the entry's sizes are set to 0xFFFFFFFFF, do the same for the offset of the local file header. <p>Ensures the Zip64 extra either knows both compressed and uncompressed size or neither of both as the internal logic in ExtraFieldUtils forces the field to create local header data even if they are never used - and here a field with only one size would be invalid.</p>\n */\nprivate void setSizesAndOffsetFromZip64Extra(final ZipArchiveEntry ze) throws IOException {\n  final ZipExtraField extra=ze.getExtraField(Zip64ExtendedInformationExtraField.HEADER_ID);\n  if (extra != null && !(extra instanceof Zip64ExtendedInformationExtraField)) {\n    throw new ZipException(\"archive contains unparseable zip64 extra field\");\n  }\n  final Zip64ExtendedInformationExtraField z64=(Zip64ExtendedInformationExtraField)extra;\n  if (z64 != null) {\n    final boolean hasUncompressedSize=ze.getSize() == ZIP64_MAGIC;\n    final boolean hasCompressedSize=ze.getCompressedSize() == ZIP64_MAGIC;\n    final boolean hasRelativeHeaderOffset=ze.getLocalHeaderOffset() == ZIP64_MAGIC;\n    final boolean hasDiskStart=ze.getDiskNumberStart() == ZIP64_MAGIC_SHORT;\n    z64.reparseCentralDirectoryData(hasUncompressedSize,hasCompressedSize,hasRelativeHeaderOffset,hasDiskStart);\n    if (hasUncompressedSize) {\n      ze.setSize(z64.getSize().getLongValue());\n    }\n else     if (hasCompressedSize) {\n      z64.setSize(new ZipEightByteInteger(ze.getSize()));\n    }\n    if (hasCompressedSize) {\n      ze.setCompressedSize(z64.getCompressedSize().getLongValue());\n    }\n else     if (hasUncompressedSize) {\n      z64.setCompressedSize(new ZipEightByteInteger(ze.getCompressedSize()));\n    }\n    if (hasRelativeHeaderOffset) {\n      ze.setLocalHeaderOffset(z64.getRelativeHeaderOffset().getLongValue());\n    }\n    if (hasDiskStart) {\n      ze.setDiskNumberStart(z64.getDiskStartNumber().getValue());\n    }\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 179,
                    "astHeight": 12
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 73,
                    "startLineNumber": 843,
                    "startColumnNumber": 12,
                    "endLineNumber": 843,
                    "endColumnNumber": 85
                },
                "nodeContext": "throw new ZipException(\"archive contains unparseable zip64 extra field\");\n",
                "nodeType": "ThrowStatement",
                "astNodeNumber": 5,
                "astHeight": 4
            },
            "tokenLength": 6,
            "type": "java.lang.String"
        }
    ],
    "positionList": [
        {
            "charLength": 48,
            "startLineNumber": 843,
            "startColumnNumber": 35,
            "endLineNumber": 843,
            "endColumnNumber": 83
        }
    ],
    "layoutRelationDataList": []
}