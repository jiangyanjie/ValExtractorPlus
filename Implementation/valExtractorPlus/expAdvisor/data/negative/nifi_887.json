{
    "id": 887,
    "expression": "null",
    "projectName": "nifi",
    "commitID": "c70a86eac00c149f8d9036db02525d9483bfd809",
    "filePath": "nifi-nar-bundles/nifi-framework-bundle/nifi-framework/nifi-web/nifi-web-api/src/main/java/org/apache/nifi/web/util/SnippetUtils.java",
    "occurrences": 23,
    "isArithmeticExpression": 1,
    "isGetTypeMethod": 1,
    "expressionList": [
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 449,
                "startColumnNumber": 32,
                "endLineNumber": 449,
                "endColumnNumber": 36
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 20,
                        "startLineNumber": 449,
                        "startColumnNumber": 16,
                        "endLineNumber": 449,
                        "endColumnNumber": 36
                    },
                    "nodeContext": "serviceIdMap == null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 89,
                        "startLineNumber": 449,
                        "startColumnNumber": 12,
                        "endLineNumber": 451,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (serviceIdMap == null) {\n  serviceIdMap=new HashMap<>();\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 12,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 20,
                    "startLineNumber": 449,
                    "startColumnNumber": 16,
                    "endLineNumber": 449,
                    "endColumnNumber": 36
                },
                "nodeContext": "serviceIdMap == null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 3,
                "astHeight": 2
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 454,
                "startColumnNumber": 59,
                "endLineNumber": 454,
                "endColumnNumber": 63
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 47,
                        "startLineNumber": 454,
                        "startColumnNumber": 16,
                        "endLineNumber": 454,
                        "endColumnNumber": 63
                    },
                    "nodeContext": "snippetContents.getControllerServices() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1150,
                        "startLineNumber": 454,
                        "startColumnNumber": 12,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getControllerServices() != null) {\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 93,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 47,
                    "startLineNumber": 454,
                    "startColumnNumber": 16,
                    "endLineNumber": 454,
                    "endColumnNumber": 63
                },
                "nodeContext": "snippetContents.getControllerServices() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 477,
                "startColumnNumber": 34,
                "endLineNumber": 477,
                "endColumnNumber": 38
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,leftOperand]",
                    "nodePosition": {
                        "charLength": 18,
                        "startLineNumber": 477,
                        "startColumnNumber": 20,
                        "endLineNumber": 477,
                        "endColumnNumber": 38
                    },
                    "nodeContext": "properties != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 41,
                        "startLineNumber": 477,
                        "startColumnNumber": 20,
                        "endLineNumber": 477,
                        "endColumnNumber": 61
                    },
                    "nodeContext": "properties != null && descriptors != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 690,
                        "startLineNumber": 477,
                        "startColumnNumber": 16,
                        "endLineNumber": 489,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "if (properties != null && descriptors != null) {\n  for (  final PropertyDescriptorDTO descriptor : descriptors.values()) {\n    if (descriptor.getIdentifiesControllerService() != null) {\n      final String currentServiceId=properties.get(descriptor.getName());\n      if (currentServiceId == null) {\n        continue;\n      }\n      final String newServiceId=serviceIdMap.get(currentServiceId);\n      properties.put(descriptor.getName(),newServiceId);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 62,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 905,
                        "startLineNumber": 474,
                        "startColumnNumber": 67,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 91,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 960,
                        "startLineNumber": 474,
                        "startColumnNumber": 12,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : services) {\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 98,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 41,
                    "startLineNumber": 477,
                    "startColumnNumber": 20,
                    "endLineNumber": 477,
                    "endColumnNumber": 61
                },
                "nodeContext": "properties != null && descriptors != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 7,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 477,
                "startColumnNumber": 57,
                "endLineNumber": 477,
                "endColumnNumber": 61
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,rightOperand]",
                    "nodePosition": {
                        "charLength": 19,
                        "startLineNumber": 477,
                        "startColumnNumber": 42,
                        "endLineNumber": 477,
                        "endColumnNumber": 61
                    },
                    "nodeContext": "descriptors != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 41,
                        "startLineNumber": 477,
                        "startColumnNumber": 20,
                        "endLineNumber": 477,
                        "endColumnNumber": 61
                    },
                    "nodeContext": "properties != null && descriptors != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 690,
                        "startLineNumber": 477,
                        "startColumnNumber": 16,
                        "endLineNumber": 489,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "if (properties != null && descriptors != null) {\n  for (  final PropertyDescriptorDTO descriptor : descriptors.values()) {\n    if (descriptor.getIdentifiesControllerService() != null) {\n      final String currentServiceId=properties.get(descriptor.getName());\n      if (currentServiceId == null) {\n        continue;\n      }\n      final String newServiceId=serviceIdMap.get(currentServiceId);\n      properties.put(descriptor.getName(),newServiceId);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 62,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 905,
                        "startLineNumber": 474,
                        "startColumnNumber": 67,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 91,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 960,
                        "startLineNumber": 474,
                        "startColumnNumber": 12,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : services) {\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 98,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 41,
                    "startLineNumber": 477,
                    "startColumnNumber": 20,
                    "endLineNumber": 477,
                    "endColumnNumber": 61
                },
                "nodeContext": "properties != null && descriptors != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 7,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 479,
                "startColumnNumber": 75,
                "endLineNumber": 479,
                "endColumnNumber": 79
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 51,
                        "startLineNumber": 479,
                        "startColumnNumber": 28,
                        "endLineNumber": 479,
                        "endColumnNumber": 79
                    },
                    "nodeContext": "descriptor.getIdentifiesControllerService() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 487,
                        "startLineNumber": 479,
                        "startColumnNumber": 24,
                        "endLineNumber": 487,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "if (descriptor.getIdentifiesControllerService() != null) {\n  final String currentServiceId=properties.get(descriptor.getName());\n  if (currentServiceId == null) {\n    continue;\n  }\n  final String newServiceId=serviceIdMap.get(currentServiceId);\n  properties.put(descriptor.getName(),newServiceId);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 43,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 535,
                        "startLineNumber": 478,
                        "startColumnNumber": 88,
                        "endLineNumber": 488,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  if (descriptor.getIdentifiesControllerService() != null) {\n    final String currentServiceId=properties.get(descriptor.getName());\n    if (currentServiceId == null) {\n      continue;\n    }\n    final String newServiceId=serviceIdMap.get(currentServiceId);\n    properties.put(descriptor.getName(),newServiceId);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 44,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 603,
                        "startLineNumber": 478,
                        "startColumnNumber": 20,
                        "endLineNumber": 488,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "for (final PropertyDescriptorDTO descriptor : descriptors.values()) {\n  if (descriptor.getIdentifiesControllerService() != null) {\n    final String currentServiceId=properties.get(descriptor.getName());\n    if (currentServiceId == null) {\n      continue;\n    }\n    final String newServiceId=serviceIdMap.get(currentServiceId);\n    properties.put(descriptor.getName(),newServiceId);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 53,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 643,
                        "startLineNumber": 477,
                        "startColumnNumber": 63,
                        "endLineNumber": 489,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  for (  final PropertyDescriptorDTO descriptor : descriptors.values()) {\n    if (descriptor.getIdentifiesControllerService() != null) {\n      final String currentServiceId=properties.get(descriptor.getName());\n      if (currentServiceId == null) {\n        continue;\n      }\n      final String newServiceId=serviceIdMap.get(currentServiceId);\n      properties.put(descriptor.getName(),newServiceId);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 54,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 690,
                        "startLineNumber": 477,
                        "startColumnNumber": 16,
                        "endLineNumber": 489,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "if (properties != null && descriptors != null) {\n  for (  final PropertyDescriptorDTO descriptor : descriptors.values()) {\n    if (descriptor.getIdentifiesControllerService() != null) {\n      final String currentServiceId=properties.get(descriptor.getName());\n      if (currentServiceId == null) {\n        continue;\n      }\n      final String newServiceId=serviceIdMap.get(currentServiceId);\n      properties.put(descriptor.getName(),newServiceId);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 62,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 905,
                        "startLineNumber": 474,
                        "startColumnNumber": 67,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 91,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 960,
                        "startLineNumber": 474,
                        "startColumnNumber": 12,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : services) {\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 98,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 51,
                    "startLineNumber": 479,
                    "startColumnNumber": 28,
                    "endLineNumber": 479,
                    "endColumnNumber": 79
                },
                "nodeContext": "descriptor.getIdentifiesControllerService() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 481,
                "startColumnNumber": 52,
                "endLineNumber": 481,
                "endColumnNumber": 56
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 24,
                        "startLineNumber": 481,
                        "startColumnNumber": 32,
                        "endLineNumber": 481,
                        "endColumnNumber": 56
                    },
                    "nodeContext": "currentServiceId == null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 103,
                        "startLineNumber": 481,
                        "startColumnNumber": 28,
                        "endLineNumber": 483,
                        "endColumnNumber": 29
                    },
                    "nodeContext": "if (currentServiceId == null) {\n  continue;\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 6,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 430,
                        "startLineNumber": 479,
                        "startColumnNumber": 81,
                        "endLineNumber": 487,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "{\n  final String currentServiceId=properties.get(descriptor.getName());\n  if (currentServiceId == null) {\n    continue;\n  }\n  final String newServiceId=serviceIdMap.get(currentServiceId);\n  properties.put(descriptor.getName(),newServiceId);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 37,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 487,
                        "startLineNumber": 479,
                        "startColumnNumber": 24,
                        "endLineNumber": 487,
                        "endColumnNumber": 25
                    },
                    "nodeContext": "if (descriptor.getIdentifiesControllerService() != null) {\n  final String currentServiceId=properties.get(descriptor.getName());\n  if (currentServiceId == null) {\n    continue;\n  }\n  final String newServiceId=serviceIdMap.get(currentServiceId);\n  properties.put(descriptor.getName(),newServiceId);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 43,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 535,
                        "startLineNumber": 478,
                        "startColumnNumber": 88,
                        "endLineNumber": 488,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  if (descriptor.getIdentifiesControllerService() != null) {\n    final String currentServiceId=properties.get(descriptor.getName());\n    if (currentServiceId == null) {\n      continue;\n    }\n    final String newServiceId=serviceIdMap.get(currentServiceId);\n    properties.put(descriptor.getName(),newServiceId);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 44,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 603,
                        "startLineNumber": 478,
                        "startColumnNumber": 20,
                        "endLineNumber": 488,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "for (final PropertyDescriptorDTO descriptor : descriptors.values()) {\n  if (descriptor.getIdentifiesControllerService() != null) {\n    final String currentServiceId=properties.get(descriptor.getName());\n    if (currentServiceId == null) {\n      continue;\n    }\n    final String newServiceId=serviceIdMap.get(currentServiceId);\n    properties.put(descriptor.getName(),newServiceId);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 53,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 643,
                        "startLineNumber": 477,
                        "startColumnNumber": 63,
                        "endLineNumber": 489,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  for (  final PropertyDescriptorDTO descriptor : descriptors.values()) {\n    if (descriptor.getIdentifiesControllerService() != null) {\n      final String currentServiceId=properties.get(descriptor.getName());\n      if (currentServiceId == null) {\n        continue;\n      }\n      final String newServiceId=serviceIdMap.get(currentServiceId);\n      properties.put(descriptor.getName(),newServiceId);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 54,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 690,
                        "startLineNumber": 477,
                        "startColumnNumber": 16,
                        "endLineNumber": 489,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "if (properties != null && descriptors != null) {\n  for (  final PropertyDescriptorDTO descriptor : descriptors.values()) {\n    if (descriptor.getIdentifiesControllerService() != null) {\n      final String currentServiceId=properties.get(descriptor.getName());\n      if (currentServiceId == null) {\n        continue;\n      }\n      final String newServiceId=serviceIdMap.get(currentServiceId);\n      properties.put(descriptor.getName(),newServiceId);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 62,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 905,
                        "startLineNumber": 474,
                        "startColumnNumber": 67,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 91,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 960,
                        "startLineNumber": 474,
                        "startColumnNumber": 12,
                        "endLineNumber": 490,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : services) {\n  final Map<String,String> properties=serviceDTO.getProperties();\n  final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n  if (properties != null && descriptors != null) {\n    for (    final PropertyDescriptorDTO descriptor : descriptors.values()) {\n      if (descriptor.getIdentifiesControllerService() != null) {\n        final String currentServiceId=properties.get(descriptor.getName());\n        if (currentServiceId == null) {\n          continue;\n        }\n        final String newServiceId=serviceIdMap.get(currentServiceId);\n        properties.put(descriptor.getName(),newServiceId);\n      }\n    }\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 98,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 24,
                    "startLineNumber": 481,
                    "startColumnNumber": 32,
                    "endLineNumber": 481,
                    "endColumnNumber": 56
                },
                "nodeContext": "currentServiceId == null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 3,
                "astHeight": 2
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 497,
                "startColumnNumber": 47,
                "endLineNumber": 497,
                "endColumnNumber": 51
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 35,
                        "startLineNumber": 497,
                        "startColumnNumber": 16,
                        "endLineNumber": 497,
                        "endColumnNumber": 51
                    },
                    "nodeContext": "snippetContents.getLabels() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 840,
                        "startLineNumber": 497,
                        "startColumnNumber": 12,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getLabels() != null) {\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 79,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 35,
                    "startLineNumber": 497,
                    "startColumnNumber": 16,
                    "endLineNumber": 497,
                    "endColumnNumber": 51
                },
                "nodeContext": "snippetContents.getLabels() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 524,
                "startColumnNumber": 48,
                "endLineNumber": 524,
                "endColumnNumber": 52
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 36,
                        "startLineNumber": 524,
                        "startColumnNumber": 16,
                        "endLineNumber": 524,
                        "endColumnNumber": 52
                    },
                    "nodeContext": "snippetContents.getFunnels() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 962,
                        "startLineNumber": 524,
                        "startColumnNumber": 12,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getFunnels() != null) {\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 95,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 36,
                    "startLineNumber": 524,
                    "startColumnNumber": 16,
                    "endLineNumber": 524,
                    "endColumnNumber": 52
                },
                "nodeContext": "snippetContents.getFunnels() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 544,
                "startColumnNumber": 51,
                "endLineNumber": 544,
                "endColumnNumber": 55
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 39,
                        "startLineNumber": 544,
                        "startColumnNumber": 16,
                        "endLineNumber": 544,
                        "endColumnNumber": 55
                    },
                    "nodeContext": "snippetContents.getInputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 544,
                        "startColumnNumber": 12,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getInputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 39,
                    "startLineNumber": 544,
                    "startColumnNumber": 16,
                    "endLineNumber": 544,
                    "endColumnNumber": 55
                },
                "nodeContext": "snippetContents.getInputPorts() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 554,
                "startColumnNumber": 48,
                "endLineNumber": 554,
                "endColumnNumber": 52
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 28,
                        "startLineNumber": 554,
                        "startColumnNumber": 24,
                        "endLineNumber": 554,
                        "endColumnNumber": 52
                    },
                    "nodeContext": "parentConnectableMap != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 176,
                        "startLineNumber": 554,
                        "startColumnNumber": 20,
                        "endLineNumber": 556,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (parentConnectableMap != null) {\n  parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 18,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1193,
                        "startLineNumber": 545,
                        "startColumnNumber": 78,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 545,
                        "startColumnNumber": 16,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getInputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 544,
                        "startColumnNumber": 57,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 544,
                        "startColumnNumber": 12,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getInputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 28,
                    "startLineNumber": 554,
                    "startColumnNumber": 24,
                    "endLineNumber": 554,
                    "endColumnNumber": 52
                },
                "nodeContext": "parentConnectableMap != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 3,
                "astHeight": 2
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 569,
                "startColumnNumber": 52,
                "endLineNumber": 569,
                "endColumnNumber": 56
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 40,
                        "startLineNumber": 569,
                        "startColumnNumber": 16,
                        "endLineNumber": 569,
                        "endColumnNumber": 56
                    },
                    "nodeContext": "snippetContents.getOutputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1338,
                        "startLineNumber": 569,
                        "startColumnNumber": 12,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getOutputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 40,
                    "startLineNumber": 569,
                    "startColumnNumber": 16,
                    "endLineNumber": 569,
                    "endColumnNumber": 56
                },
                "nodeContext": "snippetContents.getOutputPorts() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 579,
                "startColumnNumber": 48,
                "endLineNumber": 579,
                "endColumnNumber": 52
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 28,
                        "startLineNumber": 579,
                        "startColumnNumber": 24,
                        "endLineNumber": 579,
                        "endColumnNumber": 52
                    },
                    "nodeContext": "parentConnectableMap != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 176,
                        "startLineNumber": 579,
                        "startColumnNumber": 20,
                        "endLineNumber": 581,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (parentConnectableMap != null) {\n  parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 18,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1197,
                        "startLineNumber": 570,
                        "startColumnNumber": 79,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1260,
                        "startLineNumber": 570,
                        "startColumnNumber": 16,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getOutputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1292,
                        "startLineNumber": 569,
                        "startColumnNumber": 58,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1338,
                        "startLineNumber": 569,
                        "startColumnNumber": 12,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getOutputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 28,
                    "startLineNumber": 579,
                    "startColumnNumber": 24,
                    "endLineNumber": 579,
                    "endColumnNumber": 52
                },
                "nodeContext": "parentConnectableMap != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 3,
                "astHeight": 2
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 597,
                "startColumnNumber": 51,
                "endLineNumber": 597,
                "endColumnNumber": 55
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 39,
                        "startLineNumber": 597,
                        "startColumnNumber": 16,
                        "endLineNumber": 597,
                        "endColumnNumber": 55
                    },
                    "nodeContext": "snippetContents.getProcessors() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 597,
                        "startColumnNumber": 12,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessors() != null) {\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 39,
                    "startLineNumber": 597,
                    "startColumnNumber": 16,
                    "endLineNumber": 597,
                    "endColumnNumber": 55
                },
                "nodeContext": "snippetContents.getProcessors() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 602,
                "startColumnNumber": 50,
                "endLineNumber": 602,
                "endColumnNumber": 54
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,leftOperand]",
                    "nodePosition": {
                        "charLength": 31,
                        "startLineNumber": 602,
                        "startColumnNumber": 23,
                        "endLineNumber": 602,
                        "endColumnNumber": 54
                    },
                    "nodeContext": "processorDTO.getState() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 101,
                        "startLineNumber": 602,
                        "startColumnNumber": 23,
                        "endLineNumber": 602,
                        "endColumnNumber": 124
                    },
                    "nodeContext": "processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 16,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 303,
                        "startLineNumber": 602,
                        "startColumnNumber": 20,
                        "endLineNumber": 606,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n  cp.setState(ScheduledState.DISABLED.toString());\n}\n else {\n  cp.setState(ScheduledState.STOPPED.toString());\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 37,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1183,
                        "startLineNumber": 598,
                        "startColumnNumber": 88,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 598,
                        "startColumnNumber": 16,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 597,
                        "startColumnNumber": 57,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 597,
                        "startColumnNumber": 12,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessors() != null) {\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 101,
                    "startLineNumber": 602,
                    "startColumnNumber": 23,
                    "endLineNumber": 602,
                    "endColumnNumber": 124
                },
                "nodeContext": "processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())",
                "nodeType": "InfixExpression",
                "astNodeNumber": 16,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 629,
                "startColumnNumber": 54,
                "endLineNumber": 629,
                "endColumnNumber": 58
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 42,
                        "startLineNumber": 629,
                        "startColumnNumber": 16,
                        "endLineNumber": 629,
                        "endColumnNumber": 58
                    },
                    "nodeContext": "snippetContents.getProcessGroups() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1215,
                        "startLineNumber": 629,
                        "startColumnNumber": 12,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessGroups() != null) {\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 103,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 42,
                    "startLineNumber": 629,
                    "startColumnNumber": 16,
                    "endLineNumber": 629,
                    "endColumnNumber": 58
                },
                "nodeContext": "snippetContents.getProcessGroups() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 651,
                "startColumnNumber": 60,
                "endLineNumber": 651,
                "endColumnNumber": 64
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 48,
                        "startLineNumber": 651,
                        "startColumnNumber": 16,
                        "endLineNumber": 651,
                        "endColumnNumber": 64
                    },
                    "nodeContext": "snippetContents.getRemoteProcessGroups() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 48,
                    "startLineNumber": 651,
                    "startColumnNumber": 16,
                    "endLineNumber": 651,
                    "endColumnNumber": 64
                },
                "nodeContext": "snippetContents.getRemoteProcessGroups() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 658,
                "startColumnNumber": 36,
                "endLineNumber": 658,
                "endColumnNumber": 40
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,leftOperand]",
                    "nodePosition": {
                        "charLength": 16,
                        "startLineNumber": 658,
                        "startColumnNumber": 24,
                        "endLineNumber": 658,
                        "endColumnNumber": 40
                    },
                    "nodeContext": "contents != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 52,
                        "startLineNumber": 658,
                        "startColumnNumber": 24,
                        "endLineNumber": 658,
                        "endColumnNumber": 76
                    },
                    "nodeContext": "contents != null && contents.getInputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 9,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 451,
                        "startLineNumber": 658,
                        "startColumnNumber": 20,
                        "endLineNumber": 663,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (contents != null && contents.getInputPorts() != null) {\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 47,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 52,
                    "startLineNumber": 658,
                    "startColumnNumber": 24,
                    "endLineNumber": 658,
                    "endColumnNumber": 76
                },
                "nodeContext": "contents != null && contents.getInputPorts() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 9,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 658,
                "startColumnNumber": 72,
                "endLineNumber": 658,
                "endColumnNumber": 76
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,rightOperand]",
                    "nodePosition": {
                        "charLength": 32,
                        "startLineNumber": 658,
                        "startColumnNumber": 44,
                        "endLineNumber": 658,
                        "endColumnNumber": 76
                    },
                    "nodeContext": "contents.getInputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 52,
                        "startLineNumber": 658,
                        "startColumnNumber": 24,
                        "endLineNumber": 658,
                        "endColumnNumber": 76
                    },
                    "nodeContext": "contents != null && contents.getInputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 9,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 451,
                        "startLineNumber": 658,
                        "startColumnNumber": 20,
                        "endLineNumber": 663,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (contents != null && contents.getInputPorts() != null) {\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 47,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 52,
                    "startLineNumber": 658,
                    "startColumnNumber": 24,
                    "endLineNumber": 658,
                    "endColumnNumber": 76
                },
                "nodeContext": "contents != null && contents.getInputPorts() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 9,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 664,
                "startColumnNumber": 36,
                "endLineNumber": 664,
                "endColumnNumber": 40
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,leftOperand]",
                    "nodePosition": {
                        "charLength": 16,
                        "startLineNumber": 664,
                        "startColumnNumber": 24,
                        "endLineNumber": 664,
                        "endColumnNumber": 40
                    },
                    "nodeContext": "contents != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 53,
                        "startLineNumber": 664,
                        "startColumnNumber": 24,
                        "endLineNumber": 664,
                        "endColumnNumber": 77
                    },
                    "nodeContext": "contents != null && contents.getOutputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 9,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 454,
                        "startLineNumber": 664,
                        "startColumnNumber": 20,
                        "endLineNumber": 669,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (contents != null && contents.getOutputPorts() != null) {\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 47,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 53,
                    "startLineNumber": 664,
                    "startColumnNumber": 24,
                    "endLineNumber": 664,
                    "endColumnNumber": 77
                },
                "nodeContext": "contents != null && contents.getOutputPorts() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 9,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 664,
                "startColumnNumber": 73,
                "endLineNumber": 664,
                "endColumnNumber": 77
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,rightOperand]",
                    "nodePosition": {
                        "charLength": 33,
                        "startLineNumber": 664,
                        "startColumnNumber": 44,
                        "endLineNumber": 664,
                        "endColumnNumber": 77
                    },
                    "nodeContext": "contents.getOutputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 53,
                        "startLineNumber": 664,
                        "startColumnNumber": 24,
                        "endLineNumber": 664,
                        "endColumnNumber": 77
                    },
                    "nodeContext": "contents != null && contents.getOutputPorts() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 9,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 454,
                        "startLineNumber": 664,
                        "startColumnNumber": 20,
                        "endLineNumber": 669,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (contents != null && contents.getOutputPorts() != null) {\n  for (  final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n    remotePort.setGroupId(cp.getId());\n    connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 47,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 53,
                    "startLineNumber": 664,
                    "startColumnNumber": 24,
                    "endLineNumber": 664,
                    "endColumnNumber": 77
                },
                "nodeContext": "contents != null && contents.getOutputPorts() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 9,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 684,
                "startColumnNumber": 52,
                "endLineNumber": 684,
                "endColumnNumber": 56
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 40,
                        "startLineNumber": 684,
                        "startColumnNumber": 16,
                        "endLineNumber": 684,
                        "endColumnNumber": 56
                    },
                    "nodeContext": "snippetContents.getConnections() != null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 5,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1251,
                        "startLineNumber": 684,
                        "startColumnNumber": 12,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getConnections() != null) {\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 114,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 40,
                    "startLineNumber": 684,
                    "startColumnNumber": 16,
                    "endLineNumber": 684,
                    "endColumnNumber": 56
                },
                "nodeContext": "snippetContents.getConnections() != null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 5,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 692,
                "startColumnNumber": 34,
                "endLineNumber": 692,
                "endColumnNumber": 38
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,leftOperand]",
                    "nodePosition": {
                        "charLength": 14,
                        "startLineNumber": 692,
                        "startColumnNumber": 24,
                        "endLineNumber": 692,
                        "endColumnNumber": 38
                    },
                    "nodeContext": "source == null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 37,
                        "startLineNumber": 692,
                        "startColumnNumber": 24,
                        "endLineNumber": 692,
                        "endColumnNumber": 61
                    },
                    "nodeContext": "source == null || destination == null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 218,
                        "startLineNumber": 692,
                        "startColumnNumber": 20,
                        "endLineNumber": 694,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (source == null || destination == null) {\n  throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 14,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1098,
                        "startLineNumber": 685,
                        "startColumnNumber": 91,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 98,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1173,
                        "startLineNumber": 685,
                        "startColumnNumber": 16,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 107,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1205,
                        "startLineNumber": 684,
                        "startColumnNumber": 58,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 108,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1251,
                        "startLineNumber": 684,
                        "startColumnNumber": 12,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getConnections() != null) {\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 114,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 37,
                    "startLineNumber": 692,
                    "startColumnNumber": 24,
                    "endLineNumber": 692,
                    "endColumnNumber": 61
                },
                "nodeContext": "source == null || destination == null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 7,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        },
        {
            "nodeContext": "null",
            "nodeType": "NullLiteral",
            "nodePosition": {
                "charLength": 4,
                "startLineNumber": 692,
                "startColumnNumber": 57,
                "endLineNumber": 692,
                "endColumnNumber": 61
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.InfixExpression,rightOperand]",
                    "nodePosition": {
                        "charLength": 19,
                        "startLineNumber": 692,
                        "startColumnNumber": 42,
                        "endLineNumber": 692,
                        "endColumnNumber": 61
                    },
                    "nodeContext": "destination == null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 3,
                    "astHeight": 2
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                    "nodePosition": {
                        "charLength": 37,
                        "startLineNumber": 692,
                        "startColumnNumber": 24,
                        "endLineNumber": 692,
                        "endColumnNumber": 61
                    },
                    "nodeContext": "source == null || destination == null",
                    "nodeType": "InfixExpression",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 218,
                        "startLineNumber": 692,
                        "startColumnNumber": 20,
                        "endLineNumber": 694,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (source == null || destination == null) {\n  throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 14,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1098,
                        "startLineNumber": 685,
                        "startColumnNumber": 91,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 98,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1173,
                        "startLineNumber": 685,
                        "startColumnNumber": 16,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 107,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1205,
                        "startLineNumber": 684,
                        "startColumnNumber": 58,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 108,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1251,
                        "startLineNumber": 684,
                        "startColumnNumber": 12,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getConnections() != null) {\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 114,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,expression]",
                "nodePosition": {
                    "charLength": 37,
                    "startLineNumber": 692,
                    "startColumnNumber": 24,
                    "endLineNumber": 692,
                    "endColumnNumber": 61
                },
                "nodeContext": "source == null || destination == null",
                "nodeType": "InfixExpression",
                "astNodeNumber": 7,
                "astHeight": 3
            },
            "tokenLength": 1,
            "type": "null"
        }
    ],
    "positionList": [
        {
            "charLength": 4,
            "startLineNumber": 449,
            "startColumnNumber": 32,
            "endLineNumber": 449,
            "endColumnNumber": 36
        },
        {
            "charLength": 4,
            "startLineNumber": 454,
            "startColumnNumber": 59,
            "endLineNumber": 454,
            "endColumnNumber": 63
        },
        {
            "charLength": 4,
            "startLineNumber": 477,
            "startColumnNumber": 34,
            "endLineNumber": 477,
            "endColumnNumber": 38
        },
        {
            "charLength": 4,
            "startLineNumber": 477,
            "startColumnNumber": 57,
            "endLineNumber": 477,
            "endColumnNumber": 61
        },
        {
            "charLength": 4,
            "startLineNumber": 479,
            "startColumnNumber": 75,
            "endLineNumber": 479,
            "endColumnNumber": 79
        },
        {
            "charLength": 4,
            "startLineNumber": 481,
            "startColumnNumber": 52,
            "endLineNumber": 481,
            "endColumnNumber": 56
        },
        {
            "charLength": 4,
            "startLineNumber": 497,
            "startColumnNumber": 47,
            "endLineNumber": 497,
            "endColumnNumber": 51
        },
        {
            "charLength": 4,
            "startLineNumber": 524,
            "startColumnNumber": 48,
            "endLineNumber": 524,
            "endColumnNumber": 52
        },
        {
            "charLength": 4,
            "startLineNumber": 544,
            "startColumnNumber": 51,
            "endLineNumber": 544,
            "endColumnNumber": 55
        },
        {
            "charLength": 4,
            "startLineNumber": 554,
            "startColumnNumber": 48,
            "endLineNumber": 554,
            "endColumnNumber": 52
        },
        {
            "charLength": 4,
            "startLineNumber": 569,
            "startColumnNumber": 52,
            "endLineNumber": 569,
            "endColumnNumber": 56
        },
        {
            "charLength": 4,
            "startLineNumber": 579,
            "startColumnNumber": 48,
            "endLineNumber": 579,
            "endColumnNumber": 52
        },
        {
            "charLength": 4,
            "startLineNumber": 597,
            "startColumnNumber": 51,
            "endLineNumber": 597,
            "endColumnNumber": 55
        },
        {
            "charLength": 4,
            "startLineNumber": 602,
            "startColumnNumber": 50,
            "endLineNumber": 602,
            "endColumnNumber": 54
        },
        {
            "charLength": 4,
            "startLineNumber": 629,
            "startColumnNumber": 54,
            "endLineNumber": 629,
            "endColumnNumber": 58
        },
        {
            "charLength": 4,
            "startLineNumber": 651,
            "startColumnNumber": 60,
            "endLineNumber": 651,
            "endColumnNumber": 64
        },
        {
            "charLength": 4,
            "startLineNumber": 658,
            "startColumnNumber": 36,
            "endLineNumber": 658,
            "endColumnNumber": 40
        },
        {
            "charLength": 4,
            "startLineNumber": 658,
            "startColumnNumber": 72,
            "endLineNumber": 658,
            "endColumnNumber": 76
        },
        {
            "charLength": 4,
            "startLineNumber": 664,
            "startColumnNumber": 36,
            "endLineNumber": 664,
            "endColumnNumber": 40
        },
        {
            "charLength": 4,
            "startLineNumber": 664,
            "startColumnNumber": 73,
            "endLineNumber": 664,
            "endColumnNumber": 77
        },
        {
            "charLength": 4,
            "startLineNumber": 684,
            "startColumnNumber": 52,
            "endLineNumber": 684,
            "endColumnNumber": 56
        },
        {
            "charLength": 4,
            "startLineNumber": 692,
            "startColumnNumber": 34,
            "endLineNumber": 692,
            "endColumnNumber": 38
        },
        {
            "charLength": 4,
            "startLineNumber": 692,
            "startColumnNumber": 57,
            "endLineNumber": 692,
            "endColumnNumber": 61
        }
    ],
    "layoutRelationDataList": [
        {
            "firstKey": 0,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 0,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 1,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 2,
            "secondKey": 0,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 1,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 3,
            "layout": 1
        },
        {
            "firstKey": 2,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 2,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 2,
            "secondKey": 6,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 7,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 8,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 9,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 10,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 11,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 12,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 13,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 14,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 15,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 16,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 17,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 18,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 19,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 20,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 21,
            "layout": 5
        },
        {
            "firstKey": 2,
            "secondKey": 22,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 0,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 1,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 2,
            "layout": 1
        },
        {
            "firstKey": 3,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 3,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 3,
            "secondKey": 6,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 7,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 8,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 9,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 10,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 11,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 12,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 13,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 14,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 15,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 16,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 17,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 18,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 19,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 20,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 21,
            "layout": 5
        },
        {
            "firstKey": 3,
            "secondKey": 22,
            "layout": 5
        },
        {
            "firstKey": 4,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 2,
            "layout": 5
        },
        {
            "firstKey": 4,
            "secondKey": 3,
            "layout": 5
        },
        {
            "firstKey": 4,
            "secondKey": 5,
            "layout": 1
        },
        {
            "firstKey": 4,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 18,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 19,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 20,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 21,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 22,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 0,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 1,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 4,
            "layout": 3
        },
        {
            "firstKey": 5,
            "secondKey": 6,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 7,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 8,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 9,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 10,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 11,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 12,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 13,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 14,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 15,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 16,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 17,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 18,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 19,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 20,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 21,
            "layout": 10
        },
        {
            "firstKey": 5,
            "secondKey": 22,
            "layout": 10
        },
        {
            "firstKey": 6,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 6,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 7,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 9,
            "layout": 1
        },
        {
            "firstKey": 8,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 8,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 9,
            "secondKey": 0,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 1,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 2,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 3,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 4,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 5,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 6,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 7,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 8,
            "layout": 5
        },
        {
            "firstKey": 9,
            "secondKey": 10,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 11,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 12,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 13,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 14,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 15,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 16,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 17,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 18,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 19,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 20,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 21,
            "layout": 6
        },
        {
            "firstKey": 9,
            "secondKey": 22,
            "layout": 6
        },
        {
            "firstKey": 10,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 11,
            "layout": 1
        },
        {
            "firstKey": 10,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 10,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 11,
            "secondKey": 0,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 1,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 2,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 3,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 4,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 5,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 6,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 7,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 8,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 9,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 10,
            "layout": 5
        },
        {
            "firstKey": 11,
            "secondKey": 12,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 13,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 14,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 15,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 16,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 17,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 18,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 19,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 20,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 21,
            "layout": 6
        },
        {
            "firstKey": 11,
            "secondKey": 22,
            "layout": 6
        },
        {
            "firstKey": 12,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 13,
            "layout": 1
        },
        {
            "firstKey": 12,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 12,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 13,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 12,
            "layout": 6
        },
        {
            "firstKey": 13,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 18,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 19,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 20,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 21,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 22,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 14,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 16,
            "layout": 1
        },
        {
            "firstKey": 15,
            "secondKey": 17,
            "layout": 1
        },
        {
            "firstKey": 15,
            "secondKey": 18,
            "layout": 1
        },
        {
            "firstKey": 15,
            "secondKey": 19,
            "layout": 1
        },
        {
            "firstKey": 15,
            "secondKey": 20,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 21,
            "layout": 2
        },
        {
            "firstKey": 15,
            "secondKey": 22,
            "layout": 2
        },
        {
            "firstKey": 16,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 15,
            "layout": 6
        },
        {
            "firstKey": 16,
            "secondKey": 17,
            "layout": 1
        },
        {
            "firstKey": 16,
            "secondKey": 18,
            "layout": 3
        },
        {
            "firstKey": 16,
            "secondKey": 19,
            "layout": 3
        },
        {
            "firstKey": 16,
            "secondKey": 20,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 21,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 22,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 15,
            "layout": 6
        },
        {
            "firstKey": 17,
            "secondKey": 16,
            "layout": 1
        },
        {
            "firstKey": 17,
            "secondKey": 18,
            "layout": 3
        },
        {
            "firstKey": 17,
            "secondKey": 19,
            "layout": 3
        },
        {
            "firstKey": 17,
            "secondKey": 20,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 21,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 22,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 15,
            "layout": 6
        },
        {
            "firstKey": 18,
            "secondKey": 16,
            "layout": 3
        },
        {
            "firstKey": 18,
            "secondKey": 17,
            "layout": 3
        },
        {
            "firstKey": 18,
            "secondKey": 19,
            "layout": 1
        },
        {
            "firstKey": 18,
            "secondKey": 20,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 21,
            "layout": 7
        },
        {
            "firstKey": 18,
            "secondKey": 22,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 15,
            "layout": 6
        },
        {
            "firstKey": 19,
            "secondKey": 16,
            "layout": 3
        },
        {
            "firstKey": 19,
            "secondKey": 17,
            "layout": 3
        },
        {
            "firstKey": 19,
            "secondKey": 18,
            "layout": 1
        },
        {
            "firstKey": 19,
            "secondKey": 20,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 21,
            "layout": 7
        },
        {
            "firstKey": 19,
            "secondKey": 22,
            "layout": 7
        },
        {
            "firstKey": 20,
            "secondKey": 0,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 1,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 2,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 3,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 4,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 5,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 6,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 7,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 8,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 9,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 10,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 11,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 12,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 13,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 14,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 15,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 16,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 17,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 18,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 19,
            "layout": 2
        },
        {
            "firstKey": 20,
            "secondKey": 21,
            "layout": 1
        },
        {
            "firstKey": 20,
            "secondKey": 22,
            "layout": 1
        },
        {
            "firstKey": 21,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 18,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 19,
            "layout": 7
        },
        {
            "firstKey": 21,
            "secondKey": 20,
            "layout": 6
        },
        {
            "firstKey": 21,
            "secondKey": 22,
            "layout": 1
        },
        {
            "firstKey": 22,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 18,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 19,
            "layout": 7
        },
        {
            "firstKey": 22,
            "secondKey": 20,
            "layout": 6
        },
        {
            "firstKey": 22,
            "secondKey": 21,
            "layout": 1
        }
    ]
}