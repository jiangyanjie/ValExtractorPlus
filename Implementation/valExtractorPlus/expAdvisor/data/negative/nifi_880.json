{
    "id": 880,
    "expression": "idGenerationSeed",
    "projectName": "nifi",
    "commitID": "c70a86eac00c149f8d9036db02525d9483bfd809",
    "filePath": "nifi-nar-bundles/nifi-framework-bundle/nifi-framework/nifi-web/nifi-web-api/src/main/java/org/apache/nifi/web/util/SnippetUtils.java",
    "occurrences": 18,
    "isArithmeticExpression": 1,
    "isGetTypeMethod": 1,
    "expressionList": [
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 457,
                "startColumnNumber": 65,
                "endLineNumber": 457,
                "endColumnNumber": 81
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 56,
                        "startLineNumber": 457,
                        "startColumnNumber": 34,
                        "endLineNumber": 457,
                        "endColumnNumber": 90
                    },
                    "nodeContext": "generateId(serviceDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 71,
                        "startLineNumber": 457,
                        "startColumnNumber": 20,
                        "endLineNumber": 457,
                        "endColumnNumber": 91
                    },
                    "nodeContext": "service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 72,
                        "startLineNumber": 457,
                        "startColumnNumber": 20,
                        "endLineNumber": 457,
                        "endColumnNumber": 92
                    },
                    "nodeContext": "service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 979,
                        "startLineNumber": 455,
                        "startColumnNumber": 102,
                        "endLineNumber": 470,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n  service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n  service.setState(ControllerServiceState.DISABLED.name());\n  services.add(service);\n  serviceIdMap.put(serviceDTO.getId(),service.getId());\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 77,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1065,
                        "startLineNumber": 455,
                        "startColumnNumber": 16,
                        "endLineNumber": 470,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n  final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n  service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n  service.setState(ControllerServiceState.DISABLED.name());\n  services.add(service);\n  serviceIdMap.put(serviceDTO.getId(),service.getId());\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 86,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1097,
                        "startLineNumber": 454,
                        "startColumnNumber": 65,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1150,
                        "startLineNumber": 454,
                        "startColumnNumber": 12,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getControllerServices() != null) {\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 93,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 72,
                    "startLineNumber": 457,
                    "startColumnNumber": 20,
                    "endLineNumber": 457,
                    "endColumnNumber": 92
                },
                "nodeContext": "service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 468,
                "startColumnNumber": 138,
                "endLineNumber": 468,
                "endColumnNumber": 154
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 331,
                        "startLineNumber": 466,
                        "startColumnNumber": 24,
                        "endLineNumber": 468,
                        "endColumnNumber": 155
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 332,
                        "startLineNumber": 466,
                        "startColumnNumber": 24,
                        "endLineNumber": 468,
                        "endColumnNumber": 156
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 380,
                        "startLineNumber": 465,
                        "startColumnNumber": 32,
                        "endLineNumber": 469,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 392,
                        "startLineNumber": 465,
                        "startColumnNumber": 20,
                        "endLineNumber": 469,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 979,
                        "startLineNumber": 455,
                        "startColumnNumber": 102,
                        "endLineNumber": 470,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n  service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n  service.setState(ControllerServiceState.DISABLED.name());\n  services.add(service);\n  serviceIdMap.put(serviceDTO.getId(),service.getId());\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 77,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1065,
                        "startLineNumber": 455,
                        "startColumnNumber": 16,
                        "endLineNumber": 470,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n  final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n  service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n  service.setState(ControllerServiceState.DISABLED.name());\n  services.add(service);\n  serviceIdMap.put(serviceDTO.getId(),service.getId());\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 86,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1097,
                        "startLineNumber": 454,
                        "startColumnNumber": 65,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1150,
                        "startLineNumber": 454,
                        "startColumnNumber": 12,
                        "endLineNumber": 471,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getControllerServices() != null) {\n  for (  final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n    final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n    service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n    service.setState(ControllerServiceState.DISABLED.name());\n    services.add(service);\n    serviceIdMap.put(serviceDTO.getId(),service.getId());\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 93,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 331,
                    "startLineNumber": 466,
                    "startColumnNumber": 24,
                    "endLineNumber": 468,
                    "endColumnNumber": 155
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 500,
                "startColumnNumber": 61,
                "endLineNumber": 500,
                "endColumnNumber": 77
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 54,
                        "startLineNumber": 500,
                        "startColumnNumber": 32,
                        "endLineNumber": 500,
                        "endColumnNumber": 86
                    },
                    "nodeContext": "generateId(labelDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 67,
                        "startLineNumber": 500,
                        "startColumnNumber": 20,
                        "endLineNumber": 500,
                        "endColumnNumber": 87
                    },
                    "nodeContext": "label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 68,
                        "startLineNumber": 500,
                        "startColumnNumber": 20,
                        "endLineNumber": 500,
                        "endColumnNumber": 88
                    },
                    "nodeContext": "label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 707,
                        "startLineNumber": 498,
                        "startColumnNumber": 76,
                        "endLineNumber": 510,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final LabelDTO label=dtoFactory.copy(labelDTO);\n  label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n  label.setParentGroupId(groupId);\n  labels.add(label);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 63,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 767,
                        "startLineNumber": 498,
                        "startColumnNumber": 16,
                        "endLineNumber": 510,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final LabelDTO labelDTO : snippetContents.getLabels()) {\n  final LabelDTO label=dtoFactory.copy(labelDTO);\n  label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n  label.setParentGroupId(groupId);\n  labels.add(label);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 72,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 799,
                        "startLineNumber": 497,
                        "startColumnNumber": 53,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 73,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 840,
                        "startLineNumber": 497,
                        "startColumnNumber": 12,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getLabels() != null) {\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 79,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 68,
                    "startLineNumber": 500,
                    "startColumnNumber": 20,
                    "endLineNumber": 500,
                    "endColumnNumber": 88
                },
                "nodeContext": "label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 508,
                "startColumnNumber": 123,
                "endLineNumber": 508,
                "endColumnNumber": 139
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 301,
                        "startLineNumber": 506,
                        "startColumnNumber": 24,
                        "endLineNumber": 508,
                        "endColumnNumber": 140
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 302,
                        "startLineNumber": 506,
                        "startColumnNumber": 24,
                        "endLineNumber": 508,
                        "endColumnNumber": 141
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 350,
                        "startLineNumber": 505,
                        "startColumnNumber": 32,
                        "endLineNumber": 509,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 362,
                        "startLineNumber": 505,
                        "startColumnNumber": 20,
                        "endLineNumber": 509,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 707,
                        "startLineNumber": 498,
                        "startColumnNumber": 76,
                        "endLineNumber": 510,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final LabelDTO label=dtoFactory.copy(labelDTO);\n  label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n  label.setParentGroupId(groupId);\n  labels.add(label);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 63,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 767,
                        "startLineNumber": 498,
                        "startColumnNumber": 16,
                        "endLineNumber": 510,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final LabelDTO labelDTO : snippetContents.getLabels()) {\n  final LabelDTO label=dtoFactory.copy(labelDTO);\n  label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n  label.setParentGroupId(groupId);\n  labels.add(label);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 72,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 799,
                        "startLineNumber": 497,
                        "startColumnNumber": 53,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 73,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 840,
                        "startLineNumber": 497,
                        "startColumnNumber": 12,
                        "endLineNumber": 511,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getLabels() != null) {\n  for (  final LabelDTO labelDTO : snippetContents.getLabels()) {\n    final LabelDTO label=dtoFactory.copy(labelDTO);\n    label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n    label.setParentGroupId(groupId);\n    labels.add(label);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 79,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 301,
                    "startLineNumber": 506,
                    "startColumnNumber": 24,
                    "endLineNumber": 508,
                    "endColumnNumber": 140
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 527,
                "startColumnNumber": 59,
                "endLineNumber": 527,
                "endColumnNumber": 75
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 55,
                        "startLineNumber": 527,
                        "startColumnNumber": 29,
                        "endLineNumber": 527,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "generateId(funnelDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 65,
                        "startLineNumber": 527,
                        "startColumnNumber": 20,
                        "endLineNumber": 527,
                        "endColumnNumber": 85
                    },
                    "nodeContext": "cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 66,
                        "startLineNumber": 527,
                        "startColumnNumber": 20,
                        "endLineNumber": 527,
                        "endColumnNumber": 86
                    },
                    "nodeContext": "cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 825,
                        "startLineNumber": 525,
                        "startColumnNumber": 79,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 79,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 888,
                        "startLineNumber": 525,
                        "startColumnNumber": 16,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 88,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 920,
                        "startLineNumber": 524,
                        "startColumnNumber": 54,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 89,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 962,
                        "startLineNumber": 524,
                        "startColumnNumber": 12,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getFunnels() != null) {\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 95,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 66,
                    "startLineNumber": 527,
                    "startColumnNumber": 20,
                    "endLineNumber": 527,
                    "endColumnNumber": 86
                },
                "nodeContext": "cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 537,
                "startColumnNumber": 115,
                "endLineNumber": 537,
                "endColumnNumber": 131
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 293,
                        "startLineNumber": 535,
                        "startColumnNumber": 24,
                        "endLineNumber": 537,
                        "endColumnNumber": 132
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 294,
                        "startLineNumber": 535,
                        "startColumnNumber": 24,
                        "endLineNumber": 537,
                        "endColumnNumber": 133
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 342,
                        "startLineNumber": 534,
                        "startColumnNumber": 32,
                        "endLineNumber": 538,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 354,
                        "startLineNumber": 534,
                        "startColumnNumber": 20,
                        "endLineNumber": 538,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 825,
                        "startLineNumber": 525,
                        "startColumnNumber": 79,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 79,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 888,
                        "startLineNumber": 525,
                        "startColumnNumber": 16,
                        "endLineNumber": 539,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n  final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n  cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  funnels.add(cp);\n  connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 88,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 920,
                        "startLineNumber": 524,
                        "startColumnNumber": 54,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 89,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 962,
                        "startLineNumber": 524,
                        "startColumnNumber": 12,
                        "endLineNumber": 540,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getFunnels() != null) {\n  for (  final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n    final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n    cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    funnels.add(cp);\n    connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 95,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 293,
                    "startLineNumber": 535,
                    "startColumnNumber": 24,
                    "endLineNumber": 537,
                    "endColumnNumber": 132
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 547,
                "startColumnNumber": 57,
                "endLineNumber": 547,
                "endColumnNumber": 73
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 53,
                        "startLineNumber": 547,
                        "startColumnNumber": 29,
                        "endLineNumber": 547,
                        "endColumnNumber": 82
                    },
                    "nodeContext": "generateId(portDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 63,
                        "startLineNumber": 547,
                        "startColumnNumber": 20,
                        "endLineNumber": 547,
                        "endColumnNumber": 83
                    },
                    "nodeContext": "cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 64,
                        "startLineNumber": 547,
                        "startColumnNumber": 20,
                        "endLineNumber": 547,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1193,
                        "startLineNumber": 545,
                        "startColumnNumber": 78,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 545,
                        "startColumnNumber": 16,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getInputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 544,
                        "startColumnNumber": 57,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 544,
                        "startColumnNumber": 12,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getInputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 64,
                    "startLineNumber": 547,
                    "startColumnNumber": 20,
                    "endLineNumber": 547,
                    "endColumnNumber": 84
                },
                "nodeContext": "cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 562,
                "startColumnNumber": 120,
                "endLineNumber": 562,
                "endColumnNumber": 136
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 299,
                        "startLineNumber": 560,
                        "startColumnNumber": 24,
                        "endLineNumber": 562,
                        "endColumnNumber": 137
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 300,
                        "startLineNumber": 560,
                        "startColumnNumber": 24,
                        "endLineNumber": 562,
                        "endColumnNumber": 138
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 348,
                        "startLineNumber": 559,
                        "startColumnNumber": 32,
                        "endLineNumber": 563,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 360,
                        "startLineNumber": 559,
                        "startColumnNumber": 20,
                        "endLineNumber": 563,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1193,
                        "startLineNumber": 545,
                        "startColumnNumber": 78,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 545,
                        "startColumnNumber": 16,
                        "endLineNumber": 564,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getInputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  inputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 544,
                        "startColumnNumber": 57,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 544,
                        "startColumnNumber": 12,
                        "endLineNumber": 565,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getInputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getInputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    inputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 299,
                    "startLineNumber": 560,
                    "startColumnNumber": 24,
                    "endLineNumber": 562,
                    "endColumnNumber": 137
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 572,
                "startColumnNumber": 57,
                "endLineNumber": 572,
                "endColumnNumber": 73
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 53,
                        "startLineNumber": 572,
                        "startColumnNumber": 29,
                        "endLineNumber": 572,
                        "endColumnNumber": 82
                    },
                    "nodeContext": "generateId(portDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 63,
                        "startLineNumber": 572,
                        "startColumnNumber": 20,
                        "endLineNumber": 572,
                        "endColumnNumber": 83
                    },
                    "nodeContext": "cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 64,
                        "startLineNumber": 572,
                        "startColumnNumber": 20,
                        "endLineNumber": 572,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1197,
                        "startLineNumber": 570,
                        "startColumnNumber": 79,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1260,
                        "startLineNumber": 570,
                        "startColumnNumber": 16,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getOutputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1292,
                        "startLineNumber": 569,
                        "startColumnNumber": 58,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1338,
                        "startLineNumber": 569,
                        "startColumnNumber": 12,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getOutputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 64,
                    "startLineNumber": 572,
                    "startColumnNumber": 20,
                    "endLineNumber": 572,
                    "endColumnNumber": 84
                },
                "nodeContext": "cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 587,
                "startColumnNumber": 121,
                "endLineNumber": 587,
                "endColumnNumber": 137
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 301,
                        "startLineNumber": 585,
                        "startColumnNumber": 24,
                        "endLineNumber": 587,
                        "endColumnNumber": 138
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 302,
                        "startLineNumber": 585,
                        "startColumnNumber": 24,
                        "endLineNumber": 587,
                        "endColumnNumber": 139
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 350,
                        "startLineNumber": 584,
                        "startColumnNumber": 32,
                        "endLineNumber": 588,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 362,
                        "startLineNumber": 584,
                        "startColumnNumber": 20,
                        "endLineNumber": 588,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1197,
                        "startLineNumber": 570,
                        "startColumnNumber": 79,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1260,
                        "startLineNumber": 570,
                        "startColumnNumber": 16,
                        "endLineNumber": 589,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final PortDTO portDTO : snippetContents.getOutputPorts()) {\n  final PortDTO cp=dtoFactory.copy(portDTO);\n  cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  cp.setState(ScheduledState.STOPPED.toString());\n  outputPorts.add(cp);\n  final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n  connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  if (parentConnectableMap != null) {\n    parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n  }\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1292,
                        "startLineNumber": 569,
                        "startColumnNumber": 58,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1338,
                        "startLineNumber": 569,
                        "startColumnNumber": 12,
                        "endLineNumber": 590,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getOutputPorts() != null) {\n  for (  final PortDTO portDTO : snippetContents.getOutputPorts()) {\n    final PortDTO cp=dtoFactory.copy(portDTO);\n    cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    cp.setState(ScheduledState.STOPPED.toString());\n    outputPorts.add(cp);\n    final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n    connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    if (parentConnectableMap != null) {\n      parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n    }\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 301,
                    "startLineNumber": 585,
                    "startColumnNumber": 24,
                    "endLineNumber": 587,
                    "endColumnNumber": 138
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 600,
                "startColumnNumber": 62,
                "endLineNumber": 600,
                "endColumnNumber": 78
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 58,
                        "startLineNumber": 600,
                        "startColumnNumber": 29,
                        "endLineNumber": 600,
                        "endColumnNumber": 87
                    },
                    "nodeContext": "generateId(processorDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 68,
                        "startLineNumber": 600,
                        "startColumnNumber": 20,
                        "endLineNumber": 600,
                        "endColumnNumber": 88
                    },
                    "nodeContext": "cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 69,
                        "startLineNumber": 600,
                        "startColumnNumber": 20,
                        "endLineNumber": 600,
                        "endColumnNumber": 89
                    },
                    "nodeContext": "cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1183,
                        "startLineNumber": 598,
                        "startColumnNumber": 88,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 598,
                        "startColumnNumber": 16,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 597,
                        "startColumnNumber": 57,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 597,
                        "startColumnNumber": 12,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessors() != null) {\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 69,
                    "startLineNumber": 600,
                    "startColumnNumber": 20,
                    "endLineNumber": 600,
                    "endColumnNumber": 89
                },
                "nodeContext": "cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 615,
                "startColumnNumber": 120,
                "endLineNumber": 615,
                "endColumnNumber": 136
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 309,
                        "startLineNumber": 613,
                        "startColumnNumber": 24,
                        "endLineNumber": 615,
                        "endColumnNumber": 137
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 310,
                        "startLineNumber": 613,
                        "startColumnNumber": 24,
                        "endLineNumber": 615,
                        "endColumnNumber": 138
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 358,
                        "startLineNumber": 612,
                        "startColumnNumber": 32,
                        "endLineNumber": 616,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 370,
                        "startLineNumber": 612,
                        "startColumnNumber": 20,
                        "endLineNumber": 616,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1183,
                        "startLineNumber": 598,
                        "startColumnNumber": 88,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 116,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1255,
                        "startLineNumber": 598,
                        "startColumnNumber": 16,
                        "endLineNumber": 617,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n  final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n  cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n    cp.setState(ScheduledState.DISABLED.toString());\n  }\n else {\n    cp.setState(ScheduledState.STOPPED.toString());\n  }\n  processors.add(cp);\n  connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 125,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1287,
                        "startLineNumber": 597,
                        "startColumnNumber": 57,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 126,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1332,
                        "startLineNumber": 597,
                        "startColumnNumber": 12,
                        "endLineNumber": 618,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessors() != null) {\n  for (  final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n    final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n    cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n      cp.setState(ScheduledState.DISABLED.toString());\n    }\n else {\n      cp.setState(ScheduledState.STOPPED.toString());\n    }\n    processors.add(cp);\n    connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 132,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 309,
                    "startLineNumber": 613,
                    "startColumnNumber": 24,
                    "endLineNumber": 615,
                    "endColumnNumber": 137
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 632,
                "startColumnNumber": 58,
                "endLineNumber": 632,
                "endColumnNumber": 74
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 54,
                        "startLineNumber": 632,
                        "startColumnNumber": 29,
                        "endLineNumber": 632,
                        "endColumnNumber": 83
                    },
                    "nodeContext": "generateId(groupDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 64,
                        "startLineNumber": 632,
                        "startColumnNumber": 20,
                        "endLineNumber": 632,
                        "endColumnNumber": 84
                    },
                    "nodeContext": "cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 65,
                        "startLineNumber": 632,
                        "startColumnNumber": 20,
                        "endLineNumber": 632,
                        "endColumnNumber": 85
                    },
                    "nodeContext": "cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1061,
                        "startLineNumber": 630,
                        "startColumnNumber": 90,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1135,
                        "startLineNumber": 630,
                        "startColumnNumber": 16,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 96,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1167,
                        "startLineNumber": 629,
                        "startColumnNumber": 60,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 97,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1215,
                        "startLineNumber": 629,
                        "startColumnNumber": 12,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessGroups() != null) {\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 103,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 65,
                    "startLineNumber": 632,
                    "startColumnNumber": 20,
                    "endLineNumber": 632,
                    "endColumnNumber": 85
                },
                "nodeContext": "cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 636,
                "startColumnNumber": 143,
                "endLineNumber": 636,
                "endColumnNumber": 159
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
                    "nodePosition": {
                        "charLength": 112,
                        "startLineNumber": 636,
                        "startColumnNumber": 56,
                        "endLineNumber": 636,
                        "endColumnNumber": 168
                    },
                    "nodeContext": "copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 12,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
                    "nodePosition": {
                        "charLength": 127,
                        "startLineNumber": 636,
                        "startColumnNumber": 41,
                        "endLineNumber": 636,
                        "endColumnNumber": 168
                    },
                    "nodeContext": "contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy)",
                    "nodeType": "VariableDeclarationFragment",
                    "astNodeNumber": 14,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 149,
                        "startLineNumber": 636,
                        "startColumnNumber": 20,
                        "endLineNumber": 636,
                        "endColumnNumber": 169
                    },
                    "nodeContext": "final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n",
                    "nodeType": "VariableDeclarationStatement",
                    "astNodeNumber": 18,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1061,
                        "startLineNumber": 630,
                        "startColumnNumber": 90,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1135,
                        "startLineNumber": 630,
                        "startColumnNumber": 16,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 96,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1167,
                        "startLineNumber": 629,
                        "startColumnNumber": 60,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 97,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1215,
                        "startLineNumber": 629,
                        "startColumnNumber": 12,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessGroups() != null) {\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 103,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 149,
                    "startLineNumber": 636,
                    "startColumnNumber": 20,
                    "endLineNumber": 636,
                    "endColumnNumber": 169
                },
                "nodeContext": "final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n",
                "nodeType": "VariableDeclarationStatement",
                "astNodeNumber": 18,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 644,
                "startColumnNumber": 123,
                "endLineNumber": 644,
                "endColumnNumber": 139
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 307,
                        "startLineNumber": 642,
                        "startColumnNumber": 24,
                        "endLineNumber": 644,
                        "endColumnNumber": 140
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 308,
                        "startLineNumber": 642,
                        "startColumnNumber": 24,
                        "endLineNumber": 644,
                        "endColumnNumber": 141
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 356,
                        "startLineNumber": 641,
                        "startColumnNumber": 32,
                        "endLineNumber": 645,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 368,
                        "startLineNumber": 641,
                        "startColumnNumber": 20,
                        "endLineNumber": 645,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1061,
                        "startLineNumber": 630,
                        "startColumnNumber": 90,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 87,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1135,
                        "startLineNumber": 630,
                        "startColumnNumber": 16,
                        "endLineNumber": 646,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n  final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n  cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n  cp.setContents(contentsCopy);\n  groups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 96,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1167,
                        "startLineNumber": 629,
                        "startColumnNumber": 60,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 97,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1215,
                        "startLineNumber": 629,
                        "startColumnNumber": 12,
                        "endLineNumber": 647,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getProcessGroups() != null) {\n  for (  final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n    final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n    cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n    cp.setContents(contentsCopy);\n    groups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 103,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 307,
                    "startLineNumber": 642,
                    "startColumnNumber": 24,
                    "endLineNumber": 644,
                    "endColumnNumber": 140
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 654,
                "startColumnNumber": 64,
                "endLineNumber": 654,
                "endColumnNumber": 80
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 60,
                        "startLineNumber": 654,
                        "startColumnNumber": 29,
                        "endLineNumber": 654,
                        "endColumnNumber": 89
                    },
                    "nodeContext": "generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 70,
                        "startLineNumber": 654,
                        "startColumnNumber": 20,
                        "endLineNumber": 654,
                        "endColumnNumber": 90
                    },
                    "nodeContext": "cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 71,
                        "startLineNumber": 654,
                        "startColumnNumber": 20,
                        "endLineNumber": 654,
                        "endColumnNumber": 91
                    },
                    "nodeContext": "cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 71,
                    "startLineNumber": 654,
                    "startColumnNumber": 20,
                    "endLineNumber": 654,
                    "endColumnNumber": 91
                },
                "nodeContext": "cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 677,
                "startColumnNumber": 129,
                "endLineNumber": 677,
                "endColumnNumber": 145
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 331,
                        "startLineNumber": 675,
                        "startColumnNumber": 24,
                        "endLineNumber": 677,
                        "endColumnNumber": 146
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 27,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 332,
                        "startLineNumber": 675,
                        "startColumnNumber": 24,
                        "endLineNumber": 677,
                        "endColumnNumber": 147
                    },
                    "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 28,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 380,
                        "startLineNumber": 674,
                        "startColumnNumber": 32,
                        "endLineNumber": 678,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "{\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 29,
                    "astHeight": 6
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 392,
                        "startLineNumber": 674,
                        "startColumnNumber": 20,
                        "endLineNumber": 678,
                        "endColumnNumber": 21
                    },
                    "nodeContext": "if (isCopy) {\n  cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 31,
                    "astHeight": 7
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1790,
                        "startLineNumber": 652,
                        "startColumnNumber": 108,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 166,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1882,
                        "startLineNumber": 652,
                        "startColumnNumber": 16,
                        "endLineNumber": 679,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n  final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n  cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n  cp.setParentGroupId(groupId);\n  final RemoteProcessGroupContentsDTO contents=cp.getContents();\n  if (contents != null && contents.getInputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n    }\n  }\n  if (contents != null && contents.getOutputPorts() != null) {\n    for (    final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n      remotePort.setGroupId(cp.getId());\n      connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n    }\n  }\n  remoteGroups.add(cp);\n  if (isCopy) {\n    cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n  }\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 175,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1914,
                        "startLineNumber": 651,
                        "startColumnNumber": 66,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 176,
                    "astHeight": 12
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1968,
                        "startLineNumber": 651,
                        "startColumnNumber": 12,
                        "endLineNumber": 680,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getRemoteProcessGroups() != null) {\n  for (  final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n    final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n    cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n    cp.setParentGroupId(groupId);\n    final RemoteProcessGroupContentsDTO contents=cp.getContents();\n    if (contents != null && contents.getInputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n      }\n    }\n    if (contents != null && contents.getOutputPorts() != null) {\n      for (      final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n        remotePort.setGroupId(cp.getId());\n        connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n      }\n    }\n    remoteGroups.add(cp);\n    if (isCopy) {\n      cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n    }\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 182,
                    "astHeight": 13
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                "nodePosition": {
                    "charLength": 331,
                    "startLineNumber": 675,
                    "startColumnNumber": 24,
                    "endLineNumber": 677,
                    "endColumnNumber": 146
                },
                "nodeContext": "cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed)",
                "nodeType": "MethodInvocation",
                "astNodeNumber": 27,
                "astHeight": 4
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        },
        {
            "nodeContext": "idGenerationSeed",
            "nodeType": "SimpleName",
            "nodePosition": {
                "charLength": 16,
                "startLineNumber": 696,
                "startColumnNumber": 63,
                "endLineNumber": 696,
                "endColumnNumber": 79
            },
            "astNodeNumber": 1,
            "astHeight": 1,
            "parentDataList": [
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
                    "nodePosition": {
                        "charLength": 59,
                        "startLineNumber": 696,
                        "startColumnNumber": 29,
                        "endLineNumber": 696,
                        "endColumnNumber": 88
                    },
                    "nodeContext": "generateId(connectionDTO.getId(),idGenerationSeed,isCopy)",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 7,
                    "astHeight": 3
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
                    "nodePosition": {
                        "charLength": 69,
                        "startLineNumber": 696,
                        "startColumnNumber": 20,
                        "endLineNumber": 696,
                        "endColumnNumber": 89
                    },
                    "nodeContext": "cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy))",
                    "nodeType": "MethodInvocation",
                    "astNodeNumber": 10,
                    "astHeight": 4
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 70,
                        "startLineNumber": 696,
                        "startColumnNumber": 20,
                        "endLineNumber": 696,
                        "endColumnNumber": 90
                    },
                    "nodeContext": "cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n",
                    "nodeType": "ExpressionStatement",
                    "astNodeNumber": 11,
                    "astHeight": 5
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.EnhancedForStatement,body]",
                    "nodePosition": {
                        "charLength": 1098,
                        "startLineNumber": 685,
                        "startColumnNumber": 91,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "{\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 98,
                    "astHeight": 8
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1173,
                        "startLineNumber": 685,
                        "startColumnNumber": 16,
                        "endLineNumber": 703,
                        "endColumnNumber": 17
                    },
                    "nodeContext": "for (final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n  final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n  final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n  final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n  if (source == null || destination == null) {\n    throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n  }\n  cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n  cp.setSource(source);\n  cp.setDestination(destination);\n  cp.setParentGroupId(groupId);\n  connections.add(cp);\n}\n",
                    "nodeType": "EnhancedForStatement",
                    "astNodeNumber": 107,
                    "astHeight": 9
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
                    "nodePosition": {
                        "charLength": 1205,
                        "startLineNumber": 684,
                        "startColumnNumber": 58,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "{\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 108,
                    "astHeight": 10
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 1251,
                        "startLineNumber": 684,
                        "startColumnNumber": 12,
                        "endLineNumber": 704,
                        "endColumnNumber": 13
                    },
                    "nodeContext": "if (snippetContents.getConnections() != null) {\n  for (  final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n    final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n    final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n    final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n    if (source == null || destination == null) {\n      throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n    }\n    cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n    cp.setSource(source);\n    cp.setDestination(destination);\n    cp.setParentGroupId(groupId);\n    connections.add(cp);\n  }\n}\n",
                    "nodeType": "IfStatement",
                    "astNodeNumber": 114,
                    "astHeight": 11
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
                    "nodePosition": {
                        "charLength": 14702,
                        "startLineNumber": 445,
                        "startColumnNumber": 12,
                        "endLineNumber": 708,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "{\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1357,
                    "astHeight": 14
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                    "nodePosition": {
                        "charLength": 14973,
                        "startLineNumber": 445,
                        "startColumnNumber": 8,
                        "endLineNumber": 714,
                        "endColumnNumber": 9
                    },
                    "nodeContext": "try {\n  if (serviceIdMap == null) {\n    serviceIdMap=new HashMap<>();\n  }\n  final Set<ControllerServiceDTO> services=new HashSet<>();\n  if (snippetContents.getControllerServices() != null) {\n    for (    final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n      final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n      service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n      service.setState(ControllerServiceState.DISABLED.name());\n      services.add(service);\n      serviceIdMap.put(serviceDTO.getId(),service.getId());\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n      }\n    }\n  }\n  for (  final ControllerServiceDTO serviceDTO : services) {\n    final Map<String,String> properties=serviceDTO.getProperties();\n    final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n    if (properties != null && descriptors != null) {\n      for (      final PropertyDescriptorDTO descriptor : descriptors.values()) {\n        if (descriptor.getIdentifiesControllerService() != null) {\n          final String currentServiceId=properties.get(descriptor.getName());\n          if (currentServiceId == null) {\n            continue;\n          }\n          final String newServiceId=serviceIdMap.get(currentServiceId);\n          properties.put(descriptor.getName(),newServiceId);\n        }\n      }\n    }\n  }\n  snippetContentsCopy.setControllerServices(services);\n  final Set<LabelDTO> labels=new HashSet<>();\n  if (snippetContents.getLabels() != null) {\n    for (    final LabelDTO labelDTO : snippetContents.getLabels()) {\n      final LabelDTO label=dtoFactory.copy(labelDTO);\n      label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n      label.setParentGroupId(groupId);\n      labels.add(label);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setLabels(labels);\n  final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n  final Set<FunnelDTO> funnels=new HashSet<>();\n  if (snippetContents.getFunnels() != null) {\n    for (    final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n      final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n      cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      funnels.add(cp);\n      connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setFunnels(funnels);\n  final Set<PortDTO> inputPorts=new HashSet<>();\n  if (snippetContents.getInputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getInputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      inputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setInputPorts(inputPorts);\n  final Set<PortDTO> outputPorts=new HashSet<>();\n  if (snippetContents.getOutputPorts() != null) {\n    for (    final PortDTO portDTO : snippetContents.getOutputPorts()) {\n      final PortDTO cp=dtoFactory.copy(portDTO);\n      cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      cp.setState(ScheduledState.STOPPED.toString());\n      outputPorts.add(cp);\n      final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n      connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      if (parentConnectableMap != null) {\n        parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n      }\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setOutputPorts(outputPorts);\n  final Set<ProcessorDTO> processors=new HashSet<>();\n  if (snippetContents.getProcessors() != null) {\n    for (    final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n      final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n      cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n        cp.setState(ScheduledState.DISABLED.toString());\n      }\n else {\n        cp.setState(ScheduledState.STOPPED.toString());\n      }\n      processors.add(cp);\n      connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessors(processors);\n  updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n  final Set<ProcessGroupDTO> groups=new HashSet<>();\n  if (snippetContents.getProcessGroups() != null) {\n    for (    final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n      final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n      cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n      cp.setContents(contentsCopy);\n      groups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setProcessGroups(groups);\n  final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n  if (snippetContents.getRemoteProcessGroups() != null) {\n    for (    final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n      final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n      cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n      cp.setParentGroupId(groupId);\n      final RemoteProcessGroupContentsDTO contents=cp.getContents();\n      if (contents != null && contents.getInputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n        }\n      }\n      if (contents != null && contents.getOutputPorts() != null) {\n        for (        final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n          remotePort.setGroupId(cp.getId());\n          connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n        }\n      }\n      remoteGroups.add(cp);\n      if (isCopy) {\n        cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n      }\n    }\n  }\n  snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n  final Set<ConnectionDTO> connections=new HashSet<>();\n  if (snippetContents.getConnections() != null) {\n    for (    final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n      final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n      final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n      final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n      if (source == null || destination == null) {\n        throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n      }\n      cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n      cp.setSource(source);\n      cp.setDestination(destination);\n      cp.setParentGroupId(groupId);\n      connections.add(cp);\n    }\n  }\n  snippetContentsCopy.setConnections(connections);\n  return snippetContentsCopy;\n}\n catch (Exception e) {\n  rollbackClonedPolicies(snippetContentsCopy);\n  throw e;\n}\n",
                    "nodeType": "TryStatement",
                    "astNodeNumber": 1370,
                    "astHeight": 15
                },
                {
                    "locationInParent": "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
                    "nodePosition": {
                        "charLength": 15063,
                        "startLineNumber": 442,
                        "startColumnNumber": 129,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "{\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "Block",
                    "astNodeNumber": 1380,
                    "astHeight": 16
                },
                {
                    "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
                    "nodePosition": {
                        "charLength": 15352,
                        "startLineNumber": 441,
                        "startColumnNumber": 4,
                        "endLineNumber": 715,
                        "endColumnNumber": 5
                    },
                    "nodeContext": "private FlowSnippetDTO copyContentsForGroup(final FlowSnippetDTO snippetContents,final String groupId,final Map<String,ConnectableDTO> parentConnectableMap,Map<String,String> serviceIdMap,final String idGenerationSeed,boolean isCopy){\n  final FlowSnippetDTO snippetContentsCopy=new FlowSnippetDTO();\n  try {\n    if (serviceIdMap == null) {\n      serviceIdMap=new HashMap<>();\n    }\n    final Set<ControllerServiceDTO> services=new HashSet<>();\n    if (snippetContents.getControllerServices() != null) {\n      for (      final ControllerServiceDTO serviceDTO : snippetContents.getControllerServices()) {\n        final ControllerServiceDTO service=dtoFactory.copy(serviceDTO);\n        service.setId(generateId(serviceDTO.getId(),idGenerationSeed,isCopy));\n        service.setState(ControllerServiceState.DISABLED.name());\n        services.add(service);\n        serviceIdMap.put(serviceDTO.getId(),service.getId());\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ControllerService,serviceDTO.getId(),serviceDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ControllerService,service.getId(),service.getName()),idGenerationSeed);\n        }\n      }\n    }\n    for (    final ControllerServiceDTO serviceDTO : services) {\n      final Map<String,String> properties=serviceDTO.getProperties();\n      final Map<String,PropertyDescriptorDTO> descriptors=serviceDTO.getDescriptors();\n      if (properties != null && descriptors != null) {\n        for (        final PropertyDescriptorDTO descriptor : descriptors.values()) {\n          if (descriptor.getIdentifiesControllerService() != null) {\n            final String currentServiceId=properties.get(descriptor.getName());\n            if (currentServiceId == null) {\n              continue;\n            }\n            final String newServiceId=serviceIdMap.get(currentServiceId);\n            properties.put(descriptor.getName(),newServiceId);\n          }\n        }\n      }\n    }\n    snippetContentsCopy.setControllerServices(services);\n    final Set<LabelDTO> labels=new HashSet<>();\n    if (snippetContents.getLabels() != null) {\n      for (      final LabelDTO labelDTO : snippetContents.getLabels()) {\n        final LabelDTO label=dtoFactory.copy(labelDTO);\n        label.setId(generateId(labelDTO.getId(),idGenerationSeed,isCopy));\n        label.setParentGroupId(groupId);\n        labels.add(label);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Label,labelDTO.getId(),labelDTO.getLabel()),ResourceFactory.getComponentResource(ResourceType.Label,label.getId(),label.getLabel()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setLabels(labels);\n    final Map<String,ConnectableDTO> connectableMap=new HashMap<>();\n    final Set<FunnelDTO> funnels=new HashSet<>();\n    if (snippetContents.getFunnels() != null) {\n      for (      final FunnelDTO funnelDTO : snippetContents.getFunnels()) {\n        final FunnelDTO cp=dtoFactory.copy(funnelDTO);\n        cp.setId(generateId(funnelDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        funnels.add(cp);\n        connectableMap.put(funnelDTO.getParentGroupId() + \"-\" + funnelDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Funnel,funnelDTO.getId(),funnelDTO.getId()),ResourceFactory.getComponentResource(ResourceType.Funnel,cp.getId(),cp.getId()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setFunnels(funnels);\n    final Set<PortDTO> inputPorts=new HashSet<>();\n    if (snippetContents.getInputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getInputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        inputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.INPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.InputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.InputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setInputPorts(inputPorts);\n    final Set<PortDTO> outputPorts=new HashSet<>();\n    if (snippetContents.getOutputPorts() != null) {\n      for (      final PortDTO portDTO : snippetContents.getOutputPorts()) {\n        final PortDTO cp=dtoFactory.copy(portDTO);\n        cp.setId(generateId(portDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        cp.setState(ScheduledState.STOPPED.toString());\n        outputPorts.add(cp);\n        final ConnectableDTO portConnectable=dtoFactory.createConnectableDto(cp,ConnectableType.OUTPUT_PORT);\n        connectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        if (parentConnectableMap != null) {\n          parentConnectableMap.put(portDTO.getParentGroupId() + \"-\" + portDTO.getId(),portConnectable);\n        }\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.OutputPort,portDTO.getId(),portDTO.getName()),ResourceFactory.getComponentResource(ResourceType.OutputPort,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setOutputPorts(outputPorts);\n    final Set<ProcessorDTO> processors=new HashSet<>();\n    if (snippetContents.getProcessors() != null) {\n      for (      final ProcessorDTO processorDTO : snippetContents.getProcessors()) {\n        final ProcessorDTO cp=dtoFactory.copy(processorDTO);\n        cp.setId(generateId(processorDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        if (processorDTO.getState() != null && processorDTO.getState().equals(ScheduledState.DISABLED.toString())) {\n          cp.setState(ScheduledState.DISABLED.toString());\n        }\n else {\n          cp.setState(ScheduledState.STOPPED.toString());\n        }\n        processors.add(cp);\n        connectableMap.put(processorDTO.getParentGroupId() + \"-\" + processorDTO.getId(),dtoFactory.createConnectableDto(cp));\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.Processor,processorDTO.getId(),processorDTO.getName()),ResourceFactory.getComponentResource(ResourceType.Processor,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessors(processors);\n    updateControllerServiceIdentifiers(snippetContentsCopy,serviceIdMap);\n    final Set<ProcessGroupDTO> groups=new HashSet<>();\n    if (snippetContents.getProcessGroups() != null) {\n      for (      final ProcessGroupDTO groupDTO : snippetContents.getProcessGroups()) {\n        final ProcessGroupDTO cp=dtoFactory.copy(groupDTO,false);\n        cp.setId(generateId(groupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final FlowSnippetDTO contentsCopy=copyContentsForGroup(groupDTO.getContents(),cp.getId(),connectableMap,serviceIdMap,idGenerationSeed,isCopy);\n        cp.setContents(contentsCopy);\n        groups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.ProcessGroup,groupDTO.getId(),groupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.ProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setProcessGroups(groups);\n    final Set<RemoteProcessGroupDTO> remoteGroups=new HashSet<>();\n    if (snippetContents.getRemoteProcessGroups() != null) {\n      for (      final RemoteProcessGroupDTO remoteGroupDTO : snippetContents.getRemoteProcessGroups()) {\n        final RemoteProcessGroupDTO cp=dtoFactory.copy(remoteGroupDTO);\n        cp.setId(generateId(remoteGroupDTO.getId(),idGenerationSeed,isCopy));\n        cp.setParentGroupId(groupId);\n        final RemoteProcessGroupContentsDTO contents=cp.getContents();\n        if (contents != null && contents.getInputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getInputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_INPUT_PORT));\n          }\n        }\n        if (contents != null && contents.getOutputPorts() != null) {\n          for (          final RemoteProcessGroupPortDTO remotePort : contents.getOutputPorts()) {\n            remotePort.setGroupId(cp.getId());\n            connectableMap.put(remoteGroupDTO.getId() + \"-\" + remotePort.getId(),dtoFactory.createConnectableDto(remotePort,ConnectableType.REMOTE_OUTPUT_PORT));\n          }\n        }\n        remoteGroups.add(cp);\n        if (isCopy) {\n          cloneComponentSpecificPolicies(ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,remoteGroupDTO.getId(),remoteGroupDTO.getName()),ResourceFactory.getComponentResource(ResourceType.RemoteProcessGroup,cp.getId(),cp.getName()),idGenerationSeed);\n        }\n      }\n    }\n    snippetContentsCopy.setRemoteProcessGroups(remoteGroups);\n    final Set<ConnectionDTO> connections=new HashSet<>();\n    if (snippetContents.getConnections() != null) {\n      for (      final ConnectionDTO connectionDTO : snippetContents.getConnections()) {\n        final ConnectionDTO cp=dtoFactory.copy(connectionDTO);\n        final ConnectableDTO source=connectableMap.get(cp.getSource().getGroupId() + \"-\" + cp.getSource().getId());\n        final ConnectableDTO destination=connectableMap.get(cp.getDestination().getGroupId() + \"-\" + cp.getDestination().getId());\n        if (source == null || destination == null) {\n          throw new IllegalArgumentException(\"The flow snippet contains a Connection that references a component that is not included.\");\n        }\n        cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n        cp.setSource(source);\n        cp.setDestination(destination);\n        cp.setParentGroupId(groupId);\n        connections.add(cp);\n      }\n    }\n    snippetContentsCopy.setConnections(connections);\n    return snippetContentsCopy;\n  }\n catch (  Exception e) {\n    rollbackClonedPolicies(snippetContentsCopy);\n    throw e;\n  }\n}\n",
                    "nodeType": "MethodDeclaration",
                    "astNodeNumber": 1422,
                    "astHeight": 17
                }
            ],
            "currentLineData": {
                "locationInParent": "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
                "nodePosition": {
                    "charLength": 70,
                    "startLineNumber": 696,
                    "startColumnNumber": 20,
                    "endLineNumber": 696,
                    "endColumnNumber": 90
                },
                "nodeContext": "cp.setId(generateId(connectionDTO.getId(),idGenerationSeed,isCopy));\n",
                "nodeType": "ExpressionStatement",
                "astNodeNumber": 11,
                "astHeight": 5
            },
            "tokenLength": 1,
            "type": "java.lang.String"
        }
    ],
    "positionList": [
        {
            "charLength": 16,
            "startLineNumber": 457,
            "startColumnNumber": 65,
            "endLineNumber": 457,
            "endColumnNumber": 81
        },
        {
            "charLength": 16,
            "startLineNumber": 468,
            "startColumnNumber": 138,
            "endLineNumber": 468,
            "endColumnNumber": 154
        },
        {
            "charLength": 16,
            "startLineNumber": 500,
            "startColumnNumber": 61,
            "endLineNumber": 500,
            "endColumnNumber": 77
        },
        {
            "charLength": 16,
            "startLineNumber": 508,
            "startColumnNumber": 123,
            "endLineNumber": 508,
            "endColumnNumber": 139
        },
        {
            "charLength": 16,
            "startLineNumber": 527,
            "startColumnNumber": 59,
            "endLineNumber": 527,
            "endColumnNumber": 75
        },
        {
            "charLength": 16,
            "startLineNumber": 537,
            "startColumnNumber": 115,
            "endLineNumber": 537,
            "endColumnNumber": 131
        },
        {
            "charLength": 16,
            "startLineNumber": 547,
            "startColumnNumber": 57,
            "endLineNumber": 547,
            "endColumnNumber": 73
        },
        {
            "charLength": 16,
            "startLineNumber": 562,
            "startColumnNumber": 120,
            "endLineNumber": 562,
            "endColumnNumber": 136
        },
        {
            "charLength": 16,
            "startLineNumber": 572,
            "startColumnNumber": 57,
            "endLineNumber": 572,
            "endColumnNumber": 73
        },
        {
            "charLength": 16,
            "startLineNumber": 587,
            "startColumnNumber": 121,
            "endLineNumber": 587,
            "endColumnNumber": 137
        },
        {
            "charLength": 16,
            "startLineNumber": 600,
            "startColumnNumber": 62,
            "endLineNumber": 600,
            "endColumnNumber": 78
        },
        {
            "charLength": 16,
            "startLineNumber": 615,
            "startColumnNumber": 120,
            "endLineNumber": 615,
            "endColumnNumber": 136
        },
        {
            "charLength": 16,
            "startLineNumber": 632,
            "startColumnNumber": 58,
            "endLineNumber": 632,
            "endColumnNumber": 74
        },
        {
            "charLength": 16,
            "startLineNumber": 636,
            "startColumnNumber": 143,
            "endLineNumber": 636,
            "endColumnNumber": 159
        },
        {
            "charLength": 16,
            "startLineNumber": 644,
            "startColumnNumber": 123,
            "endLineNumber": 644,
            "endColumnNumber": 139
        },
        {
            "charLength": 16,
            "startLineNumber": 654,
            "startColumnNumber": 64,
            "endLineNumber": 654,
            "endColumnNumber": 80
        },
        {
            "charLength": 16,
            "startLineNumber": 677,
            "startColumnNumber": 129,
            "endLineNumber": 677,
            "endColumnNumber": 145
        },
        {
            "charLength": 16,
            "startLineNumber": 696,
            "startColumnNumber": 63,
            "endLineNumber": 696,
            "endColumnNumber": 79
        }
    ],
    "layoutRelationDataList": [
        {
            "firstKey": 0,
            "secondKey": 1,
            "layout": 3
        },
        {
            "firstKey": 0,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 0,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 1,
            "secondKey": 0,
            "layout": 4
        },
        {
            "firstKey": 1,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 1,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 2,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 3,
            "layout": 3
        },
        {
            "firstKey": 2,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 2,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 3,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 2,
            "layout": 4
        },
        {
            "firstKey": 3,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 3,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 4,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 5,
            "layout": 3
        },
        {
            "firstKey": 4,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 4,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 5,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 4,
            "layout": 4
        },
        {
            "firstKey": 5,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 5,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 6,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 7,
            "layout": 3
        },
        {
            "firstKey": 6,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 6,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 7,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 6,
            "layout": 4
        },
        {
            "firstKey": 7,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 7,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 8,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 9,
            "layout": 3
        },
        {
            "firstKey": 8,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 8,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 9,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 8,
            "layout": 4
        },
        {
            "firstKey": 9,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 9,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 10,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 11,
            "layout": 3
        },
        {
            "firstKey": 10,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 10,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 11,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 10,
            "layout": 4
        },
        {
            "firstKey": 11,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 11,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 12,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 13,
            "layout": 3
        },
        {
            "firstKey": 12,
            "secondKey": 14,
            "layout": 3
        },
        {
            "firstKey": 12,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 12,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 12,
            "layout": 3
        },
        {
            "firstKey": 13,
            "secondKey": 14,
            "layout": 3
        },
        {
            "firstKey": 13,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 16,
            "layout": 7
        },
        {
            "firstKey": 13,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 14,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 12,
            "layout": 4
        },
        {
            "firstKey": 14,
            "secondKey": 13,
            "layout": 4
        },
        {
            "firstKey": 14,
            "secondKey": 15,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 16,
            "layout": 8
        },
        {
            "firstKey": 14,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 15,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 15,
            "secondKey": 16,
            "layout": 3
        },
        {
            "firstKey": 15,
            "secondKey": 17,
            "layout": 7
        },
        {
            "firstKey": 16,
            "secondKey": 0,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 1,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 2,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 3,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 4,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 5,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 6,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 7,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 8,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 9,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 10,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 11,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 12,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 13,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 14,
            "layout": 8
        },
        {
            "firstKey": 16,
            "secondKey": 15,
            "layout": 4
        },
        {
            "firstKey": 16,
            "secondKey": 17,
            "layout": 8
        },
        {
            "firstKey": 17,
            "secondKey": 0,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 1,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 2,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 3,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 4,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 5,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 6,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 7,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 8,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 9,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 10,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 11,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 12,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 13,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 14,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 15,
            "layout": 7
        },
        {
            "firstKey": 17,
            "secondKey": 16,
            "layout": 7
        }
    ]
}